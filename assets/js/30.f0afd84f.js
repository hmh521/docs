(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{391:function(t,v){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAACJIAAABJCAIAAADjIwlwAAAa+UlEQVR4Xu3dv47lthXA4XkkFy7sfZF0bgLMO7h2mWLd+wXSBjC2MNykcxrDwCKAg1kY7pIgzSIIYLiajP5e8pzDQ0lXEkXO74OQeChKV6LOIXnFnd2HZwAAAAAAAAAAAFzAgywAAAAAAAAAAABACSzbAAAAAAAAAAAAXALLNgAAAAAAAAAAAJeQXLb58OHDP/7zOxsb217bS07JNANwPaQqNiBsjkCrokbELcoiAlELYtVB4zSgyYfY5E2djDaET0QIyzZsbCdt9M5AFUhVbEDYHIFWRY2IW5RFBKIWxKqDxmlAkw+xyZs6GW0IH8s2bGxlNnpnoAqkKjYgbI5Aq6JGxC3KIgJRC2LVQeM0oMmH2ORNnYw2hI9lGza2Mhu9M1AFUhUbEDZHoFVRI+IWZRGBqAWx6qBxGtDkQ2zypk5GG8LHsg0bW5mN3hmoAqmKDQibI9CqqBFxi7KIQNSCWHXQOA1o8iE2eVMnow3hY9mGja3MRu8MVIFUxQaEzRFoVdSIuEVZRCBqQaw6aJwGNPkQm7ypk9GG8LFsw8ZWZqN3BqpAqmIDwuYItCpqRNyiLCIQtSBWHTROA5p8iE3e1MloQ/i2LNt899VnDw8Pn3z1d/0m+rb9+Y8vdf7wZ1XOxsbWbzv0zu8eX7Ls8Z0sBrCje1O1z9PP3z7J8hC53Jx7w2arp7efZ+NtSZ1rKtWqwD2Kx61M+dNGpV1OgrtFEchDwYUVjtXzP3GNXYaS/hY7mSEAx9jlIV6NvqkwzMwZyCWy7DpXItpwaDKBjH3dWLZhYyuz6RFutf0Gm1VnWlUZqJ1I1dXxf9oLMlzJDj38Ajpw5LejZXVqcW8yAiWc0xs4ZMqfNirtchLcrfCrcGCxwrF6/ieucf9QsqTvx6Huf4gXZE3Ob2FmzkDCLFMFZyn2wQa9bLMtUa90T9jTlmWbRRvLNmxs7rbDsL1bxzyMpwvPtKoyUL04VdfH/5IvSbvlMq5ihx4+b0k0LqlTjXuTESjhlN5gjdNGpV1OgrsVfhUOLFY4Vs//xDXuHkrueBmMndz9EK/ImJw7YSazrNxkXl5JSTst25RrTByMZRs2tjLbDsP2boPNqi5+VWWgesZkdFX8n/aCDFeyQw+ftyQal9Spxr3JCJRwSm+wxmmj0i4nwd0KvwoHFiscq+d/4hp3DyXbXwZjL3c/xCsyJudOmMksKzeZl1dSEss28G1atrGWZL754mHW/f1pVh02NrZ5E7k39LID0df2Y8oo6sGtwSZZuRd+ynBkVNLTR83Myomv/0Hx/J/hxckLn48Z6TMCRcypasb/WCmK7Ti4l8T/+lzGxelXD5kYmKrZu8cImWLw87fvUtEYxFIyYnPxJnbOXwLCOuJwZwjbkZ+MczPHguKFD4Lsw6629AZuSj6nM84uFym/5BpyvcSivJAnGU8QHmueM5/LqTuFRUfgQQ8FuFPhWJWfOJfJj3heNjXal9U4t2nhfGXmBatZk98QOMqGh2iO3pPhWJUT0xHnDJTpyXl/YSKtgh9VfX0nRvnCdtMhLvda+V7KwmWb8Z7Dix7u6tYcN+MZUs2VCjJc0i7LNn//8tOXgs++/NtY8s0XD5982v37NyzbsLGltjD34jH46e3j3E/He6Z+Odwpp7Opynpcf/cYj+kLu2tVWX7QrXAsm0eF24cPRWpoTl48UEw8TKr4H8pkQlhTSCf+1+UyKqC/mGViYEEUff4i6DTtaJSxtKSOiDA5WMzfBOIhQ9zM/GM4hO0sk4xmpoQ3u+RBkH3Y2+reQIbd0oxLlcuUX3IN4pBteRGdZOxIFp3TPH9wtuSdwqIj8IiHAtyvcKzKOumPWDA12p1uHDUt9C54vMIDLxB5Sx/i7bHFcRU/4TkKzYcc1z1woDQm5+EtibSSWaYm8x03kp12Sx2i0vNl/8sJ9AeXsnDZ5lnep6hqNabZXE/ut05czw7LNt99ZazQDL98w7ING1tqC3JPDl8zvSPqVePdfmWrF5+5OyVdOVEiBk4xFsQH+RcPFGRMRv1kEVUWxP+qXEYV9Bcz+QD9ULIiRJ5BVurJ6MnXsaIrKhtOofv4qUR+5HFyyZgoYTBCUWt7AyvkwjIdpINUudqz4BqsXmJ9XtwOM3oR95x+LutD4dEReMBDAXZQOFbX9HvGNemP3ZVuHHFH/gUvbQQcadlDXDwB6H7qVx+mkuAZ63A4ijE5D+9AXIi8LiNtZBXRLMl2Sx5ifMZ0mlNaKE8v2wi36wxuRrW1daNWc0nWcbiU+5dt+l+1+fRP34m30vI3ctjY2KJNLtsYPaUegOJONdrvV1a9emRVV21UlkXi06KRdhZW8i8eKMmYjDqBOc+05ipO/NvpSzq0QH8xs2NAlc57VkfRQIZPto48ICh1vu2ER6WGsP1lk1EWMRjhAlb2BkYQTqVDjVTGpcrVKZ1rsDsG45IW5cV0nHVlmXPK80e5bJ0PaToCD3gowA4Kx+qafk9+RMc4ZEe6ceI7Mj49vsiFrYADbXiIU6kxRej+e/xrk6OSW0V9rgMYk/PwrsQ9yVvUmSRrPItKy9otOERd0sA4qBi9bKOvdzbdmr4B3Zhmc8WGg9RxuJT7l23+8oeXH774i3wrzbING5u7Bbk3d5Zxl3orlsJBa/xvv7LVhwcyu2Nm5WjY6GsEFfSYIor9iweKMiajMjCHmXFsrpKNf/ED6dAE/cVMP764eEMUWdEoa+bqJL4bhMXJU0T7O/o8+1qajFMZgxGuYF1vkE/JVMalytWHZq9B/LA5L4Z+ov97SOQl5c/p5HL6TmHREXjAQwF2UDhW1/R71hRkuOKjeiXdONGn5y44ObrgREseon5EYXEQeN3xXen0/7eSW8WOPuG+jMl5+JHiNuVdq0zKRrI8Q/YQfUAvUVzEqmWb4IbF5avGfE7dZl8qqEq4DpZt2NjKbHHuRV2nHpZtenKZquzvze2O2ZWDiWo4Y7jtkweE57FPCVyCMRmNgnWeOc1RH0d8Nv6f1+QyKpH5YtYJn/QeUTSQNXN1+v36u0FYnDzF7TBrCDtALhk7DEa4mnW9wYKUTGdcolx8aPYano1eQh+QN2Rj/9ZV3tKCc3q5nLpTWHQEHvNQgHsVjtU1/Z61P/jMA+jGiT7duqBYYnTBiZY8RP2IouL5h+4/4gjvdwUnPGmgNCbn4YeJ25R3rQJXFUjyDNlD9AFecREbl21kJashjNucDr8db1TCpey0bKP+kjTzH7xhY2ObN5F7vXlwvY3BqjsORB2sX9nfa3XxSYnK8wAzzRxu7A8PS+0awBUYk9HM5DKe+tjRHZeuyGXUQX8xU480KF0WRXa3m5mdZ+vIA3Rp8hTylvrCjtyxl0wyBsUMRriOdb3BgpSMyoyMU+Xi4Pw1iEPsA/Kmk4xvCKIzLDink8sjdaew6Ag88qEA2xWO1TX9njUFyRxyJ7NxAtlPn1sExSx6iJkJwPgcu78bbXqaQ4yHf1ta4PCB0pichx8l7kneos6kXCTLM0xFyUPsvfqDC1q1bDPuf6tvy7on3VxGLV0J13L/ss3v33zx8tNnX/4tfCXd/4M3LNuwsaU3a9mmE3ak9iAziztYv7K71+i801KVgxFE7BxmC+LD4wtyLw8oyZiMLphtisyU0S0ifk0uowr6i5l8pOFjXhZFqtvVh+ma+TpWvEU1kqewgtSqvJtMMoblDEa4jHW9gfwpKNPBnkmDqVwcveAaFvQSCwQnGa4nvNAF50znciDVApjpCDz6oQDbFI7VNf2e1fP4R9wr1ThxmfPxY4Mk9+N4mx6irNc/yMfHILB1iWCF626MyXl4B+LyzbuJL81qhIA8w1yWPMTaqzuVklYs2wQNpu7LaEyjuXStvs5V2gKWHZZtxl+4efjjN+OP3ZrNJ5/y2zZsbN4W5N67x6CXjLpWPaC87J5/Er2wX3nsj4OePfhY3Xs7kpWHT9C7pvLbjuEUepRJXjxQjBgmVfzHBWMkBzWWxP+6XEYF9BczNwYWRZEOARWNRs0FdcRsXR4hf+70h4zXnx7C9pZLxgmDEa5kZW8wV0qlZCrjUuUqLZdcgzhkW17EJxk/Vnyof047l9N3CouOwAMeCrCDwrG6pt+zZiD98cm3rfdyGmfkXvC4+7DLwxL5hzhGrQh0I9CsWE286El91E7uW7ax7tCPZHWGjn+I1arDX8Aoz1PI4mWb4T6nnfFPc0F0U0ZzxbWm4LlKW8Cyy7LN79PKzajbZdRhY2O7bXrYHslOOtwX96dGL5yurHdbw+OD/nxDqnJ/en38VJz+9KCeVwEoQAyTVvyHofsSuHFmLon/9bmMi9M9fCYGFkSRPKKjotGoua5OUC/aZ8TnXC28dj0E7GdBMg7iy1PF7oOY6nkVgBXW9wbPfkomM84tv33Ikmsweon1eaFOMp7idm3Zc3q5PNJ7EdMReMhDAe5WOFbVJzofkZ8a7c1vnGiHdcH+y2CcY9lDdCcAneEph4eq9/fP5w2Udy7bJCbz6Ug2zhDsMA9Re7udyfMUoJdtlPmSo9Yd695uQzWmfZthazzKb524nk3LNmxsbHdv6vVT/dQwPeoHAqMcqEGDqYrj6S9m9IH3W5qMDEa4EnqD7VK5jDWW9pwL8VBwGGLVsXPjoIQmH2KTN3Uy2hA+lm3Y2Mps7fXOyWV6XlKgZu2lKk7Ai9ojLExGBiNcCr3BZslcxhoLe86FeCg4DrHq2LdxUESTD7HJmzoZbQgfyzZsbGW21nrn/g802VNjXlKgZq2lKk7Bi9ojLEpGBiNcDL3BRk4uY41FPedCPBQciVh17Nk4KKTJh9jkTZ2MNoSPZRs2tjJbM73z/DdoJmfGvKRAzZpJVZyJF7VH8JORwQjXRG+wVj6XsYbfcy7EQ8EJiFXHLo2Dspp8iE3e1MloQ/hYtmFjK7NduHfuXyoYGpv9AotcOFVxXYTNEWhV1KjpuGXGWIGmIxBNOT5WK+6yjm8cHK7Jh9jkTZ2MNoSPZRs2tjIbvTNQBVIVGxA2R6BVUSPiFmURgagFseqgcRrQ5ENs8qZORhvCx7ING1uZjd4ZqAKpig0ImyPQqqgRcYuyiEDUglh10DgNaPIhNnlTJ6MN4ZPLNh8AAAAAAAAAAABQSLRso38ngN8MAI7w8eNHWQTgekhVbEDYHIFWRY2IW5RFBKIWxKqDxmlAkw+xyZs6GW0In4gQlm2Ak9A7A1UgVbEBYXMEWhU1Im5RFhGIWhCrDhqnAU0+xCZv6mS0IXws2wBl0DsDVSBVsQFhcwRaFTUiblEWEYhaEKsOGqcBTT7EJm/qZLQhfCzbAGXQOwNVIFWxAWFzBFoVNSJuURYRiFoQqw4apwFNPsQmb+pktCF8LNsAZdA7A1UgVbEBYXMEWhU1Im5RFhGIWhCrDhqnAU0+xCZv6mS0IXws2wBl0DsDVSBVsQFhcwRaFTUiblEWEYhaEKsOGqcBTT7EJm/qZLQhfCzbAGXQOwNVIFWxAWFzBFoVNSJuURYRiFoQqw4apwFNPsQmb+pktCF8LNsAB3r6+s3Dw+M7WdxRvXNfdxYe9O4xKpgqvvn66VZH6A+JqowlofgEfQX7nPGljeyqQGtUqgJ5Rtj8719//f6nb9/35cN/f//Tj/+WtV788/3Lrp+f/ifLk/79a3Sq4MfVp7o2o1V74/hmDrbO0ObsAvZjxC29AU5EBKIWxKqDxmmA8RALi94QpefRI3POfL2bGjkv4qKXW1aVbIVQtnK2gtGGZDcCLNsAhwh6Z6tvFrk31A4qvhTcxkVr2ebNmzf2yNmbxle5bBMeMdQRn2KfcvhEcxfQOmMiBeSosPnt6Yefvv3hX/8dfprm399+/+s/43rPGybN6fm3/NzKqVYdzN8ordHWGdqcXcB+VNzSG+BURCBqQaw6aJwGqIdYVPeGR/7BYONP9c511AurwbVuque/iIum/8nb9iqEspWzFZ6NNiS7EZHLNi/0mg3LNsAKt0WOxODWC3IvtypiLts8Pr5JnbqrMOwPTmq8n4ovz6gwyV0g0DA1kQLyZNh0c+JgSt3Pv//6/tfbH6QK7Dr/Hj/r9mPNZKsOhiHyMTGEOUObswvYj4xbegOciwhELYhVB43TAPkQr0W+uTKmyV2RnDhf66ayL+LEizVdkq0Q0rs2nU22IdmNmLFs82Ct3LBsA6yXGC16Qe4ZY2JEdO7TaGSNm52u/PGdXGqxPiSqY1UYyXMBr4icSAELiLDpptThn10a5t+//GZOtc1Cjz//1p9eLSsZp3F2+H89UDlDm7ML2A+9AcoiAlELYtVB4zTAmsdeSPzOyZwlG2sOV70p+0WccQNxWbZCbseWs5Hd8NnLNg9q5YZlG2A9e7QYBLmXets0EX37vIjSlauj+r0vleVSizXyRmVWhZE8F/CKiGFySNfBkJWJ1ImK9VEO44QqB50T9oePorOMPcl0qL5k7CcOm48/9rPtW8E0/x52icmxmH8b0/Hb4b3c/LsvWTOhvyrjm+FtmE2MpEY6TZxdwH7oDVAWEYhaEKsOGqcBxjz2QsS3TWN1QdXpXPWmzBdxxvXHhdkK2fItZyO74Usu2zzEKzcs2wDrmaPFKMy9zGvU1LLN8F/x6eciOSAY76fiKkaFiTwX8IqEqRpnydPXj/1/Dusk1uKJta4zHZVm5KKXrOEJ4z3iwoadb4J/NwuHiWZXevobTqD76XI4O99//t3Xj0rqpL8ZhqPs8N8yvI10mji7gP3QG6AsIhC1IFYdNE4D9Dz2MvQk2pwlG2+FrnpT5os4cy1KfWv3KuSLN5yN7IbPW7Z5CFZuWLYB1jNHi5HIvWnlRg6EHdG1B8OlGjm7qvYuOfKqsVlWCNwu7sa+K6A5QarqWdZAZ3qYf6mjkoxcjPI5eUK9IzpV/0MiybGzsIf/7y8/y39DMp5A9zPsW4X959/6z23VSX0zFKk3hHicG0Y6TZxdwH7oDVAWEYhaEKsOGqcBah5b2jBxHqivlsY0Wb1Aer7gTY3013O77Dn8Bp2tEMpWzlaYkN3wZZZtHqaVG5ZtgPUSXXXPGuFuI2c0GoquPXyBGy/OpPfEo7LxGebIPJHnAl4RuWxjZbRMdb3KYh2VYuTiohPqSWB8YcZ5cZSwh+8m0OLvCBYT6OF33qd/ZPKA+fdvTz8Y/4hldeS4qVJBFbhh7+wC9kNvgLKIQNSCWHXQOA2Q89grGd8VhXNouUgzvU5i2WaQrZytMCG74css2/DbNsAdEl11LznC6QFRdO3xIkqwM6onl1qy76ecCvJcwCsSpOqQ0XF6jnT2zSnrHGUzcjHKwcQJb8XSeCl6kojDrJx/D3+0apw0M/9OEePmMFpGIa2LjHSaOLuA/dAboCwiELUgVh00TgOS73+uwXp1Nb2Z6o3/Qmpc46o3Zd1N4stw6n2aVSFfvOFsZDd83rIN/7YNcB9ztBh5I9z4+nU6UHTtYhFlfvEUV5NLLdn3U04FeS7gFYlTNZq8hkkRJFD3n3G+JI8yGbkoc9A6odff9PQkEYdZO/8ep8j977wz/05xkjEmc8VOOmcXsB96A5RFBKIWxKqDxmmA9/7nCvIT4+7bpqhw1Zsyvxibdxh+zc5WCGUrZyuMyG74kss24ZoNyzbAJuZoMfJHuOj9qnjZKrv68eev/VrmqBFyKshzAa+Ilarz+2KdiMMCqpku1lEWIxftHBQnNI6LiJ4ERwrDJvuXFIvCA+bfjfwlxWGrJsdXkQdOWji7gP3QG6AsIhC1IFYdNE4DrC+VV2J/3wwYqzaXvSn7i4L1bdh78ZYsS+7YcjayGz572Uas2bBsA2xijxYDd4SLDxR9uxpQh9oPRmFQkH0/5VSQ5wJekVSqqvQOFlDtpO+oowy6zlBi5mBY2UnijjFLxFGisOkmxO4EetLP1H/+8X33v3P98Bfhw5IV8+/+4+IZeZWCVtVZMovzwMkKZxewH3oDlEUEohbEqoPGaUDqS+VFZF/5dBNnNfW+6k0lvinor8NdiXxp5lUIZStnK/TIbviMZRu9ZsOyDbBJYrToBbknR0B5mOju9Yg6rtvoMjlmyCEi5FSQ5wJekShVg0TV07ChyCj1j9LEKs2Y4HNB+oRjzXj3/NOiz8Y+otmVnm3rktHwO+/xn5PqK99+X374cdX8W38BqNOtVeUwGRkScdzpDG3OLmA/9AYoiwhELYhVB43TgEutcLzMgsM5sPFnBMNvkemZ96VuKpC64LjcqOVXML+lpyqrIqNCh+yGTy7b6AUblm2ArRIdcy/Ovem97Ch+j5RdthmqxJ8ja2XfT01vnCPDOcXVjez7AhoTpWqYJkY6JdIsc5QlTLqXQ0Q+eyeMMzlMU5ZtThT38P2sOvx7ipPz73H2LKfL05y7217OIw7Pzb+NvyW5TnOrRgszWrjbGdqcXcB+6A1QFhGIWhCrDhqnAVdb4YgnwvIr5bP6Pip39652UxPvRVx442aNdAWxbNNJVx5lK5Dd8LFsA5Rx1REOQGRFqsrFUrxeMmy6OXGhP7jUT9ajP0VVLdmqQA1k3NIb4FxEIGpBrDponAbIh9iEJm/qZLINyW7EWLYBypC9M4BLWp6q/DYLZips+j859X5pLO2opT8zpVoVqICKW3oDnIoIRC2IVQeN0wD1EFvQ5E2dTLUh2Y0IyzZAGap3BnBFS1O1/1UbFm0wMMJm+I31c6fg3eS71B/XOoDRqsDlGXFLb4ATEYGoBbHqoHEaYDzE+jV5Uycz2pDsRoBlG6AMo3cGcD3ZVJ3/2l/WbDDLhg02oFVRI+IWZRGBqAWx6qBxGtDkQ2zypk5GG8LHsg1QBr0zUIVjUtX8x9AfWPppxjFh89rRqqgRcYuyiEDUglh10DgNaPIhNnlTJ6MN4WPZBiiD3hmoAqmKDQibI9CqqBFxi7KIQNSCWHXQOA1o8iE2eVMnow3hY9kGKIPeGagCqYoNCJsj0KqoEXGLsohA1IJYddA4DWjyITZ5UyejDeFj2QYog94ZqAKpig0ImyPQqqgRcYuyiEDUglh10DgNaPIhNnlTJ6MN4ZPLNh/SPgIAAAAAAAAAAOBI0bJN+AMAAAAAAAAAAABKYdkGAAAAAAAAAADgEli2AQAAAAAAAAAAuASWbQAAAAAAAAAAAC6BZRsAAAAAAAAAAIBLYNkGAAAAAAAAAADgEli2AQAAAAAAAAAAuASWbQAAAAAAAAAAAC6BZRsAAAAAAAAAAIBLYNkGAAAAAAAAAADgEv4PD/NP2G4naN0AAAAASUVORK5CYII="},432:function(t,v,s){"use strict";s.r(v);var _=s(14),a=Object(_.a)({},(function(){var t=this,v=t._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h1",{attrs:{id:"mysql"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#mysql"}},[t._v("#")]),t._v(" Mysql")]),t._v(" "),v("h2",{attrs:{id:"如何定位慢查询"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#如何定位慢查询"}},[t._v("#")]),t._v(" 如何定位慢查询")]),t._v(" "),v("div",{staticClass:"custom-block tip"},[v("p",{staticClass:"custom-block-title"},[t._v("产生原因")]),t._v(" "),v("p",[t._v("表象：页面加载过慢、接口响应时间过长（超过1s）")]),t._v(" "),v("ol",[v("li",[t._v("聚合查询 2. 多表查询 3.表数据量过大 4. 深度分页查询")])])]),t._v(" "),v("h3",{attrs:{id:"方案一-开源工具"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#方案一-开源工具"}},[t._v("#")]),t._v(" 方案一：开源工具")]),t._v(" "),v("ul",[v("li",[t._v("调试工具：Arthas（阿里）")]),t._v(" "),v("li",[t._v("运维工具: Prometheus、Skywalking")])]),t._v(" "),v("h3",{attrs:{id:"方案二-mysql自带慢查询日志"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#方案二-mysql自带慢查询日志"}},[t._v("#")]),t._v(" 方案二：Mysql自带慢查询日志")]),t._v(" "),v("ol",[v("li",[t._v("开启慢查询日志 "),v("br"),t._v("\n慢查询日志 查询的是超过指定时间的数据（long_query_time） "),v("br"),t._v("\n在 MySQL 的配置文件（通常是 my.cnf 或 my.ini）中，添加或修改以下配置项：")])]),t._v(" "),v("div",{staticClass:"language-shell extra-class"},[v("pre",{pre:!0,attrs:{class:"language-shell"}},[v("code",[v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("mysqld"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nslow_query_log "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("              "),v("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 开启慢查询日志 1 表示开启慢查询日志，0 表示关闭。")]),t._v("\nslow_query_log_file "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" /path/to/slow_query.log  "),v("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 慢查询日志文件路径")]),t._v("\nlong_query_time "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("             "),v("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置慢查询的阈值（单位为秒，默认10秒）")]),t._v("\nlog_queries_not_using_indexes "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("  "),v("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 记录未使用索引的查询，1 表示记录，0 表示不记录。")]),t._v("\n")])])]),v("h2",{attrs:{id:"如何分析执行速度很慢的sql语句"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#如何分析执行速度很慢的sql语句"}},[t._v("#")]),t._v(" 如何分析执行速度很慢的SQL语句")]),t._v(" "),v("ol",[v("li",[t._v("使用"),v("strong",[t._v("explain")]),t._v("分析SQL语句")])]),t._v(" "),v("div",{staticClass:"language-sql extra-class"},[v("pre",{pre:!0,attrs:{class:"language-sql"}},[v("code",[v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("explain")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" sys_user "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" id "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),v("p",[v("img",{attrs:{src:s(391),alt:"explain"}})]),t._v(" "),v("ul",[v("li",[t._v("possible_keys: 可能使用的索引")]),t._v(" "),v("li",[t._v("key: 实际使用的索引")]),t._v(" "),v("li",[t._v("key_len: 索引占用的大小")]),t._v(" "),v("li",[t._v("Extra: 额外信息")])]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("Extra")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("Using where;Using Index")]),t._v(" "),v("td",[t._v("查找使用了索引，需要的数据都在索引列中能找到，不需要回表查询数据")])]),t._v(" "),v("tr",[v("td",[t._v("Using index condition")]),t._v(" "),v("td",[t._v("查找使用了索引，但需要回表查询数据")])])])]),t._v(" "),v("ul",[v("li",[t._v("type: 查询类型  性能从好到差\n"),v("ul",[v("li",[t._v("system > const > eq_ref > ref > range > index > all")]),t._v(" "),v("li",[t._v("system: 表只有一行记录（等于系统表）")]),t._v(" "),v("li",[t._v("const: 根据主键查询")]),t._v(" "),v("li",[t._v("eq_ref: 主键或唯一索引查询")]),t._v(" "),v("li",[t._v("ref: 普通索引")]),t._v(" "),v("li",[t._v("range: 索引范围扫描")]),t._v(" "),v("li",[t._v("index: "),v("strong",[t._v("索引树扫描")])]),t._v(" "),v("li",[t._v("all: "),v("strong",[t._v("全表扫描")])])])])]),t._v(" "),v("h2",{attrs:{id:"什么是索引"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#什么是索引"}},[t._v("#")]),t._v(" 什么是索引")]),t._v(" "),v("div",{staticClass:"custom-block tip"},[v("p",{staticClass:"custom-block-title"},[t._v("索引")]),t._v(" "),v("p",[t._v("索引是帮助MySQL高效获取数据的数据结构，Innodb特定查找算法B+树，以某种方式指向表中的数据。")])]),t._v(" "),v("h3",{attrs:{id:"简单说一下b树"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#简单说一下b树"}},[t._v("#")]),t._v(" 简单说一下B树")]),t._v(" "),v("ol",[v("li",[t._v("B树：多叉路平衡查找树，每一个节点有多个分支，5阶的B树，每个节点最多有4个子节点，最少有2个子节点。")]),t._v(" "),v("li",[t._v("B+树：B树的变种，非叶子节点只存储索引，叶子节点存储索引和数据，叶子节点之间有指针相连，叶子节点形成一个链表。\nB树和B+树的区别：")])]),t._v(" "),v("ul",[v("li",[t._v("磁盘读写代价B+树更低，因为非叶子节点不存储数据，数据都在叶子节点，叶子节点形成链表，可以顺序读取。")]),t._v(" "),v("li",[t._v("查询效率：B+树查询效率更稳定，因为非叶子节点存储更多的索引，可以减少树的高度，减少磁盘IO次数。")]),t._v(" "),v("li",[t._v("B+树适合范围查询，因为叶子节点之间有指针相连，可以快速找到范围内的数据。（双向链表）")])]),t._v(" "),v("h3",{attrs:{id:"什么是聚簇索引-非聚簇索引"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#什么是聚簇索引-非聚簇索引"}},[t._v("#")]),t._v(" 什么是聚簇索引/非聚簇索引")]),t._v(" "),v("ol",[v("li",[t._v("聚簇索引：数据和索引存储在一起，Innodb的主键索引就是聚簇索引。 只能有一个聚簇索引。")]),t._v(" "),v("li",[t._v("非聚簇索引：数据和索引分开存储，索引只存储索引列的值和指向数据的指针。 可以有多个非聚簇索引。")])]),t._v(" "),v("h4",{attrs:{id:"选取规则"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#选取规则"}},[t._v("#")]),t._v(" 选取规则")]),t._v(" "),v("ul",[v("li",[t._v("如果表中有主键，Innodb会自动选择主键作为聚簇索引。")]),t._v(" "),v("li",[t._v("如果表中没有主键，Innodb会选择第一个非空唯一索引作为聚簇索引。")]),t._v(" "),v("li",[t._v("如果表中没有主键和唯一索引，Innodb会生成一个隐藏的6字节的rowid作为聚簇索引。")])]),t._v(" "),v("h3",{attrs:{id:"什么是回表查询"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#什么是回表查询"}},[t._v("#")]),t._v(" 什么是回表查询")]),t._v(" "),v("div",{staticClass:"custom-block tip"},[v("p",{staticClass:"custom-block-title"},[t._v("回表查询")]),t._v(" "),v("p",[t._v("当通过非聚簇索引查询数据时，需要通过索引找到数据的主键，再通过主键找到数据，这个过程就是回表查询。")])]),t._v(" "),v("div",{staticClass:"language-sql extra-class"},[v("pre",{pre:!0,attrs:{class:"language-sql"}},[v("code",[v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" user_id "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" users "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" username "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token string"}},[t._v("'exampleUser'")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" users "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" user_id "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token number"}},[t._v("123")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),v("ul",[v("li",[t._v("使用索引：数据库首先会利用索引来快速找到匹配的记录。例如，在users表的username字段上创建了索引，数据库可以快速定位到对应的user_id。")]),t._v(" "),v("li",[t._v("回表查询：数据库通过user_id找到对应的记录，然后返回给客户端。")])]),t._v(" "),v("h3",{attrs:{id:"什么是覆盖索引"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#什么是覆盖索引"}},[t._v("#")]),t._v(" 什么是覆盖索引")]),t._v(" "),v("div",{staticClass:"custom-block tip"},[v("p",{staticClass:"custom-block-title"},[t._v("覆盖索引")]),t._v(" "),v("p",[t._v("当查询的列都在索引中时，不需要回表查询，直接从索引中获取数据，这个过程就是覆盖索引。")])]),t._v(" "),v("ul",[v("li",[t._v("使用id查询数据，直接走聚集索引，不需要回表查询，直接查询到数据，性能最高。")]),t._v(" "),v("li",[t._v("避免使用select *，会导致回表查询。聚集索引的叶子节点存储了所有的列，不需要回表查询。")])]),t._v(" "),v("h3",{attrs:{id:"mysql超大分页问题"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#mysql超大分页问题"}},[t._v("#")]),t._v(" MySQL超大分页问题")]),t._v(" "),v("ol",[v("li",[t._v("MySQL的limit分页是先查询出所有的数据，再进行分页，如果数据量很大，会导致性能问题。")])]),t._v(" "),v("h4",{attrs:{id:"优化思路"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#优化思路"}},[t._v("#")]),t._v(" 优化思路")]),t._v(" "),v("ol",[v("li",[t._v("使用覆盖索引查询，只查询需要的列。覆盖索引加子查询提升性能。")])]),t._v(" "),v("div",{staticClass:"language-sql extra-class"},[v("pre",{pre:!0,attrs:{class:"language-sql"}},[v("code",[v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" \n"),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tb_sku t\n"),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" id "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tb_sku "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("limit")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000000")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t1 "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" t"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" t1"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),v("h3",{attrs:{id:"索引的创建原则"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#索引的创建原则"}},[t._v("#")]),t._v(" 索引的创建原则")]),t._v(" "),v("ol",[v("li",[v("font",{staticStyle:{color:"#E8323C"}},[t._v("针对于数量大的表，查询比较频繁的表，单表超过10万行数据，可以考虑创建索引。")])],1),t._v(" "),v("li",[v("font",{staticStyle:{color:"#E8323C"}},[t._v("针对于查询频繁的字段，需要创建索引。where条件中的字段，排序字段，分组字段。")])],1),t._v(" "),v("li",[t._v("尽量选择区分度高的字段作为索引，尽量创建唯一索引。区分度越高，索引效果越好。")]),t._v(" "),v("li",[t._v("如果字符串字段长度较大，可以使用前缀索引，减少索引占用空间。")]),t._v(" "),v("li",[v("font",{staticStyle:{color:"#E8323C"}},[t._v("尽量使用联合索引，因为很多时候可以覆盖索引，减少索引数量，提升查询效率。")])],1),t._v(" "),v("li",[v("font",{staticStyle:{color:"#E8323C"}},[t._v("控制索引的数量，索引越多，维护成本越高，建议不超过5个。")])],1),t._v(" "),v("li",[t._v("索引不能存在空值，否则索引失效。")])]),t._v(" "),v("h3",{attrs:{id:"什么情况下索引会失效"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#什么情况下索引会失效"}},[t._v("#")]),t._v(" 什么情况下索引会失效")]),t._v(" "),v("ol",[v("li",[v("font",{staticStyle:{color:"#E8323C"}},[t._v("违反索引最左前缀原则。")])],1),t._v(" "),v("li",[v("font",{staticStyle:{color:"#E8323C"}},[t._v("范围查询右面的列，不能使用索引。")])],1),t._v(" "),v("li",[v("font",{staticStyle:{color:"#E8323C"}},[t._v("不要在索引列上进行运算操作，会导致索引失效。")])],1),t._v(" "),v("li",[v("font",{staticStyle:{color:"#E8323C"}},[t._v("字符串不加引号，会导致索引失效。")])],1),t._v(" "),v("li",[v("font",{staticStyle:{color:"#E8323C"}},[t._v("以%开头的like查询，会导致索引失效。")])],1),t._v(" "),v("li",[t._v("使用or连接条件，会导致索引失效。")]),t._v(" "),v("li",[t._v("使用函数，会导致索引失效。")]),t._v(" "),v("li",[t._v("使用is null，is not null，会导致索引失效。")]),t._v(" "),v("li",[t._v("使用!=，<>，会导致索引失效。")]),t._v(" "),v("li",[t._v("使用not in，not exists，会导致索引失效。")])]),t._v(" "),v("h2",{attrs:{id:"谈谈sql优化的经验"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#谈谈sql优化的经验"}},[t._v("#")]),t._v(" 谈谈Sql优化的经验")]),t._v(" "),v("h3",{attrs:{id:"表的设计优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#表的设计优化"}},[t._v("#")]),t._v(" 表的设计优化")]),t._v(" "),v("ol",[v("li",[v("font",{staticStyle:{color:"#E8323C"}},[t._v("设置合理的字段类型，尽量使用小的数据类型，减少存储空间。")])],1),t._v(" "),v("li",[v("font",{staticStyle:{color:"#E8323C"}},[t._v("设置合适的字符串类型，char定长字符串效率比较高，varchar效率比较低。")])],1),t._v(" "),v("li",[v("font",{staticStyle:{color:"#E8323C"}},[t._v("设置合理的字段长度，不要设置过长的字段，会浪费存储空间。")])],1),t._v(" "),v("li",[t._v("设置合理的字段默认值，减少空值的存储。")]),t._v(" "),v("li",[t._v("设置合理的字段注释，方便维护。")]),t._v(" "),v("li",[v("font",{staticStyle:{color:"#E8323C"}},[t._v("设置合理的字段约束，减少错误数据的插入。")])],1),t._v(" "),v("li",[t._v("设置合理的字段命名，方便维护。")]),t._v(" "),v("li",[t._v("设置合理的表名，方便维护。")]),t._v(" "),v("li",[t._v("设置合理的表注释，方便维护。")]),t._v(" "),v("li",[v("font",{staticStyle:{color:"#E8323C"}},[t._v("设置合理的表引擎，Innodb支持事务，Myisam不支持事务。")])],1)]),t._v(" "),v("h3",{attrs:{id:"sql语句的优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#sql语句的优化"}},[t._v("#")]),t._v(" SQL语句的优化")]),t._v(" "),v("ol",[v("li",[v("font",{staticStyle:{color:"#E8323C"}},[t._v("尽量减少查询的字段，不要使用select *。")])],1),t._v(" "),v("li",[t._v("SQL语句要避免索引失效的写法。")]),t._v(" "),v("li",[t._v("尽量用union all代替union。因为union all不会去重，效率更高。")]),t._v(" "),v("li",[t._v("避免在where子句中对字段进行表达式操作，会导致索引失效。")]),t._v(" "),v("li",[v("span",{staticStyle:{color:"#E8323C"}},[t._v(" Join 优化，尽量使用inner join，避免使用外连接。如果一定要使用，一定要以小表驱动大表。")])])]),t._v(" "),v("h2",{attrs:{id:"事务的四大特性"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#事务的四大特性"}},[t._v("#")]),t._v(" 事务的四大特性")]),t._v(" "),v("ol",[v("li",[t._v("原子性：事务是一个不可分割的工作单位，要么都成功，要么都失败。")]),t._v(" "),v("li",[t._v("一致性：事务执行前后，数据的完整性保持一致。")]),t._v(" "),v("li",[t._v("隔离性：多个事务之间互不干扰，一个事务的执行不会影响其他事务。")]),t._v(" "),v("li",[t._v("持久性：事务一旦提交，对数据的修改是永久性的。")])]),t._v(" "),v("h3",{attrs:{id:"事务的并发问题"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#事务的并发问题"}},[t._v("#")]),t._v(" 事务的并发问题")]),t._v(" "),v("ol",[v("li",[t._v("脏读：一个事务读取到另一个事务未提交的数据。")]),t._v(" "),v("li",[t._v("不可重复读：一个事务读取到另一个事务已提交的数据。")]),t._v(" "),v("li",[t._v("幻读：一个事务读取到另一个事务插入的数据。")])]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("事务隔离级别")]),t._v(" "),v("th",[t._v("脏读")]),t._v(" "),v("th",[t._v("不可重复读")]),t._v(" "),v("th",[t._v("幻读")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("读未提交")]),t._v(" "),v("td",[t._v("是")]),t._v(" "),v("td",[t._v("是")]),t._v(" "),v("td",[t._v("是")])]),t._v(" "),v("tr",[v("td",[t._v("读已提交")]),t._v(" "),v("td",[t._v("否")]),t._v(" "),v("td",[t._v("是")]),t._v(" "),v("td",[t._v("是")])]),t._v(" "),v("tr",[v("td",[t._v("可重复读")]),t._v(" "),v("td",[t._v("否")]),t._v(" "),v("td",[t._v("否")]),t._v(" "),v("td",[t._v("是")])]),t._v(" "),v("tr",[v("td",[t._v("串行化")]),t._v(" "),v("td",[t._v("否")]),t._v(" "),v("td",[t._v("否")]),t._v(" "),v("td",[t._v("否")])])])]),t._v(" "),v("p",[v("span",{staticStyle:{color:"#E8323C"}},[t._v("Mysql默认的事务隔离级别是可重复读。")])]),t._v(" "),v("h2",{attrs:{id:"undolog和redolog的区别"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#undolog和redolog的区别"}},[t._v("#")]),t._v(" undoLog和redoLog的区别")]),t._v(" "),v("ol",[v("li",[t._v("undoLog是逻辑日志，记录的是数据修改前的内容，用于回滚操作。（一致性和原子性）")]),t._v(" "),v("li",[t._v("redoLog是物理日志，记录的是数据修改后的内容，用于恢复操作。（持久性）")])]),t._v(" "),v("ul",[v("li",[t._v("缓冲池：缓冲池是内存中的一块区域，用于存放数据页，减少磁盘IO。")]),t._v(" "),v("li",[t._v("数据页：数据页是磁盘上的一块区域，用于存放数据。 每个数据页默认大小为16KB。存储的数据是行记录。")])]),t._v(" "),v("blockquote",[v("p",[t._v("在执行更新操作时，会先将数据页中的数据拷贝到undoLog中，然后再将数据页中的数据修改，修改后的数据会记录到redoLog中。如果事务回滚，会先根据undoLog中的数据恢复数据页中的数据，然后再将redoLog中的数据恢复到数据页中。如果数据库宕机，会根据redoLog中的数据恢复数据页中的数据。")])]),t._v(" "),v("p",[v("span",{staticStyle:{color:"#E8323C"}},[t._v("总之，undoLog是用于回滚操作，redoLog是用于恢复操作。")])]),t._v(" "),v("p",[t._v("undoLog还会用于MVCC多版本并发控制，用于读已提交和可重复读隔离级别。")]),t._v(" "),v("h3",{attrs:{id:"隔离性是如何保证的"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#隔离性是如何保证的"}},[t._v("#")]),t._v(" 隔离性是如何保证的")]),t._v(" "),v("ol",[v("li",[t._v("锁机制：排他锁")]),t._v(" "),v("li",[t._v("多版本并发控制：MVCC")])]),t._v(" "),v("h2",{attrs:{id:"解释一下mvcc"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#解释一下mvcc"}},[t._v("#")]),t._v(" 解释一下MVCC")]),t._v(" "),v("blockquote",[v("p",[v("span",{staticStyle:{color:"#E8323C"}},[t._v("MVCC是多版本并发控制，用于解决事务并发问题。")])])]),t._v(" "),v("ul",[v("li",[t._v("维护一个数据的多个版本，使得读写操作没有冲突。\n主要实现方式：")])]),t._v(" "),v("ol",[v("li",[t._v("隐式字段")])]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("隐藏字段")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("DB_TRX_ID")]),t._v(" "),v("td",[t._v("最近修改事务ID，记录插入这条数据的最后一次修改该记录的事务ID")])]),t._v(" "),v("tr",[v("td",[t._v("DB_ROLL_PTR")]),t._v(" "),v("td",[t._v("回滚指针,指向这条记录的上一个版本，用于配合undoLog,指向上一个版本")])]),t._v(" "),v("tr",[v("td",[t._v("DB_ROW_ID")]),t._v(" "),v("td",[t._v("隐藏主键，如果表结构没有指定主键，将会生成该隐藏字段")])])])]),t._v(" "),v("ol",{attrs:{start:"2"}},[v("li",[t._v("undoLog")])]),t._v(" "),v("ul",[v("li",[t._v("当insert一条记录时，会生成一条undoLog，事务提交时，会立即删除undoLog。")]),t._v(" "),v("li",[t._v("当update/delete一条记录时，会生成一条undoLog，事务提交时，不会立即删除undoLog，MVCC需要使用undoLog来获取数据的历史版本。")]),t._v(" "),v("li",[t._v("undoLog 不同事务/相同事务对同一条记录的修改，会生成版本链。头部是最新版本，尾部是最旧版本。")])]),t._v(" "),v("ol",{attrs:{start:"3"}},[v("li",[t._v("readview")])]),t._v(" "),v("blockquote",[v("p",[t._v("readview（读视图），是快照读SQL执行时的一个视图，用于读取数据，记录了事务开始时的活跃事务的事务（未提交）ID。")])]),t._v(" "),v("ul",[v("li",[t._v("当前读：读取数据时，数据不能被其他事务修改，会加锁，保证数据的一致性。")]),t._v(" "),v("li",[t._v("快照读：读取数据时，不加锁，读取的是快照数据，保证数据的一致性。\n"),v("ul",[v("li",[t._v("读已提交：每次读取数据时，会生成一个readview，记录当前活跃事务的ID，只能读取已提交的数据。")]),t._v(" "),v("li",[t._v("可重复读：开启事务时，第一次select会生成一个readview，记录当前活跃事务的ID，事务执行过程中，不会更新readview，只能读取事务开始时的数据。")])])])]),t._v(" "),v("h3",{attrs:{id:"包含4个核心字段"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#包含4个核心字段"}},[t._v("#")]),t._v(" 包含4个核心字段：")]),t._v(" "),v("h4",{attrs:{id:"参数说明"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#参数说明"}},[t._v("#")]),t._v(" 参数说明")]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("trx_ids")]),t._v("：当前活跃事务ID列表。")]),t._v(" "),v("li",[v("strong",[t._v("min_limit_id")]),t._v("：最小事务ID（通常是一个提交过的事务ID）。这个值是所有事务的最小范围。")]),t._v(" "),v("li",[v("strong",[t._v("max_limit_id")]),t._v("：预分配事务ID（当前最大的事务ID + 1）。表示下一个事务ID，它通常是尚未使用的事务ID。")]),t._v(" "),v("li",[v("strong",[t._v("creator_trx_id")]),t._v("：创建当前readview的事务ID。")])]),t._v(" "),v("h4",{attrs:{id:"事务id-读取数据权限规则"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#事务id-读取数据权限规则"}},[t._v("#")]),t._v(" 事务ID 读取数据权限规则")]),t._v(" "),v("ol",[v("li",[v("strong",[v("code",[t._v("trx_id == creator_trx_id")])]),t._v("：")])]),t._v(" "),v("ul",[v("li",[t._v("如果当前事务ID等于创建 "),v("code",[t._v("readview")]),t._v(" 的事务ID，说明当前事务是自己创建了readview，"),v("strong",[t._v("可以读取自己的数据")]),t._v("。")]),t._v(" "),v("li",[t._v("该规则允许事务能够读取自己创建的事务内容。")])]),t._v(" "),v("ol",{attrs:{start:"2"}},[v("li",[v("strong",[v("code",[t._v("trx_id < min_limit_id")])]),t._v("：")])]),t._v(" "),v("ul",[v("li",[t._v("如果当前事务ID小于 "),v("code",[t._v("min_limit_id")]),t._v("，则说明该事务已被提交，并且其状态是已提交的，"),v("strong",[t._v("可以读取数据")]),t._v("。")]),t._v(" "),v("li",[t._v("因为已提交事务的数据是可见的，不会受到隔离。")])]),t._v(" "),v("ol",{attrs:{start:"3"}},[v("li",[v("strong",[v("code",[t._v("trx_id > max_limit_id")])]),t._v("：")])]),t._v(" "),v("ul",[v("li",[t._v("如果当前事务ID大于 "),v("code",[t._v("max_limit_id")]),t._v("，说明该事务尚未开始执行，事务ID是预分配的未来ID，"),v("strong",[t._v("不可以读取数据")]),t._v("。")]),t._v(" "),v("li",[t._v("因为这些事务还未开始，因此其数据不可见。")])]),t._v(" "),v("ol",{attrs:{start:"4"}},[v("li",[v("strong",[v("code",[t._v("min_limit_id <= trx_id <= max_limit_id")])]),t._v("：")])]),t._v(" "),v("ul",[v("li",[t._v("如果当前事务ID在 "),v("code",[t._v("min_limit_id")]),t._v(" 和 "),v("code",[t._v("max_limit_id")]),t._v(" 之间，说明该事务尚未提交，且仍在执行中，"),v("strong",[t._v("不可以读取数据")]),t._v("。")]),t._v(" "),v("li",[t._v("因为该事务处于执行过程中，数据状态尚未确定，读取它的数据可能会导致不一致。")])]),t._v(" "),v("h4",{attrs:{id:"总结"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),v("ul",[v("li",[v("p",[v("strong",[t._v("可以读取数据")]),t._v("：")]),t._v(" "),v("ul",[v("li",[t._v("如果事务ID小于 "),v("code",[t._v("min_limit_id")]),t._v("（已提交）。")]),t._v(" "),v("li",[t._v("如果事务ID等于 "),v("code",[t._v("creator_trx_id")]),t._v("（自己创建的readview）。")])])]),t._v(" "),v("li",[v("p",[v("strong",[t._v("不可以读取数据")]),t._v("：")]),t._v(" "),v("ul",[v("li",[t._v("如果事务ID大于 "),v("code",[t._v("max_limit_id")]),t._v("（尚未开始）。")]),t._v(" "),v("li",[t._v("如果事务ID在 "),v("code",[t._v("min_limit_id")]),t._v(" 和 "),v("code",[t._v("max_limit_id")]),t._v(" 之间（未提交或正在执行）。")])])])]),t._v(" "),v("div",{staticClass:"custom-block tip"},[v("p",{staticClass:"custom-block-title"},[t._v("MVVC的总结")]),t._v(" "),v("ol",[v("li",[t._v("MVCC是通过隐藏字段、undoLog、readview实现的。 维护一个数据的多个版本，使得读写操作没有冲突。")]),t._v(" "),v("li",[t._v("隐藏字段 事务id和回滚指针，用于配合undoLog，指向上一个版本。")]),t._v(" "),v("li",[t._v("undoLog 用于回滚操作，不同事务/相同事务对同一条记录的修改，会生成版本链。")]),t._v(" "),v("li",[t._v("readview 读取数据时，不加锁，读取的是快照数据，保证数据的一致性。 RR/RC RR只会生成一次readview，RC每次select都会生成readview。")]),t._v(" "),v("li",[t._v("事务ID读取数据权限规则：creator_trx_id、min_limit_id、max_limit_id。")])])]),t._v(" "),v("h2",{attrs:{id:"mysql主从复制原理"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#mysql主从复制原理"}},[t._v("#")]),t._v(" mysql主从复制原理")]),t._v(" "),v("p",[t._v("核心原理："),v("strong",[t._v("binlog日志")]),t._v(" ，记录了所有的DDL和DML操作，通过binlog日志实现主从复制。")]),t._v(" "),v("p",[t._v("步骤：")]),t._v(" "),v("ol",[v("li",[t._v("主库执行操作后记录到binlog；")]),t._v(" "),v("li",[t._v("从库通过 IO 线程 拉取 binlog，写入中继日志；")]),t._v(" "),v("li",[t._v("从库通过 SQL 线程 执行中继日志中的 SQL，保持数据同步。")])]),t._v(" "),v("h2",{attrs:{id:"分库分表"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#分库分表"}},[t._v("#")]),t._v(" 分库分表")]),t._v(" "),v("blockquote",[v("p",[t._v("什么情况下需要分库分表？")])]),t._v(" "),v("ol",[v("li",[t._v("数据量大，单表数据量超过1000W或者20G;")]),t._v(" "),v("li",[t._v("优化解决不了性能问题；(主从读写分离，索引)")]),t._v(" "),v("li",[t._v("IO瓶颈（磁盘IO，网络IO），CPU瓶颈（聚合查询，连接数太多）")])]),t._v(" "),v("h3",{attrs:{id:"垂直拆分"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#垂直拆分"}},[t._v("#")]),t._v(" 垂直拆分")]),t._v(" "),v("blockquote",[v("p",[t._v("垂直拆分是指按照业务模块将表拆分到不同的数据库中，每个数据库中的表都是不同的业务模块。")])]),t._v(" "),v("h4",{attrs:{id:"垂直分库"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#垂直分库"}},[t._v("#")]),t._v(" 垂直分库")]),t._v(" "),v("ol",[v("li",[t._v("按照业务模块将表拆分到不同的数据库中；")])]),t._v(" "),v("ul",[v("li",[t._v("特点：实现业务的分级管理，高并发场景下，提高磁盘IO和数据库连接数；")])]),t._v(" "),v("h4",{attrs:{id:"垂直分表"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#垂直分表"}},[t._v("#")]),t._v(" 垂直分表")]),t._v(" "),v("ol",[v("li",[t._v("以字段为依据，将表中的字段拆分到不同的表中；")])]),t._v(" "),v("p",[t._v("拆分规则：冷热数据分离")]),t._v(" "),v("ul",[v("li",[t._v("不常用的字段单独放到一个表中；")]),t._v(" "),v("li",[t._v("把text，blob字段放到附表中；")])]),t._v(" "),v("h3",{attrs:{id:"水平拆分"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#水平拆分"}},[t._v("#")]),t._v(" 水平拆分")]),t._v(" "),v("blockquote",[v("p",[t._v("水平拆分是指按照表的行进行拆分，将表中的数据按照某种规则拆分到不同的数据库中。")])]),t._v(" "),v("h4",{attrs:{id:"水平分库"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#水平分库"}},[t._v("#")]),t._v(" 水平分库")]),t._v(" "),v("ol",[v("li",[t._v("按照某种规则将表中的数据拆分到不同的数据库中；")]),t._v(" "),v("li",[t._v("水平分库的规则：hash取模、范围分片、一致性hash；")])]),t._v(" "),v("ul",[v("li",[t._v("特点：单库性能瓶颈，提高系统的稳定性和可用性；")])]),t._v(" "),v("h4",{attrs:{id:"水平分表"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#水平分表"}},[t._v("#")]),t._v(" 水平分表")]),t._v(" "),v("ol",[v("li",[t._v("将一个表的数据按照某种规则拆分到不同的表中；")])]),t._v(" "),v("ul",[v("li",[t._v("特点：单表性能瓶颈，减少锁表的概率，提高系统的稳定性和可用性；")])]),t._v(" "),v("h3",{attrs:{id:"分库问题"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#分库问题"}},[t._v("#")]),t._v(" 分库问题")]),t._v(" "),v("ol",[v("li",[t._v("分布式事务的一致性问题；")]),t._v(" "),v("li",[t._v("跨节点关联查询问题；")]),t._v(" "),v("li",[t._v("跨节点分页/排序问题；")]),t._v(" "),v("li",[t._v("主键避重问题；")])]),t._v(" "),v("div",{staticClass:"custom-block tip"},[v("p",{staticClass:"custom-block-title"},[t._v("分库分表总结")]),t._v(" "),v("ol",[v("li",[t._v("水平分库：将一个库的数据拆分到多个库中，解决海量数据存储和高并发问题；")]),t._v(" "),v("li",[t._v("水平分表：将一个表的数据拆分到多个表中，解决单表存储和性能的问题；")]),t._v(" "),v("li",[t._v("垂直分库：按照业务进行拆分，提高磁盘IO和数据库连接数；")]),t._v(" "),v("li",[t._v("垂直分表：冷热数据分离，多表互不影响，提高查询性能；")])])])])}),[],!1,null,null,null);v.default=a.exports}}]);
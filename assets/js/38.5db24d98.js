(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{420:function(a,t,s){"use strict";s.r(t);var n=s(14),e=Object(n.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/",target:"_blank",rel:"noopener noreferrer"}},[a._v("mysql8 交流网站"),t("OutboundLink")],1)]),a._v(" "),t("p",[t("a",{attrs:{href:"https://www.cs.usfca.edu/~galles/visualization/about.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("数据结构演示图"),t("OutboundLink")],1)]),a._v(" "),t("p",[t("a",{attrs:{href:"https://db-engines.com/en/ranking",target:"_blank",rel:"noopener noreferrer"}},[a._v("数据库最新排名"),t("OutboundLink")],1)]),a._v(" "),t("h2",{attrs:{id:"为什么要使用数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为什么要使用数据库"}},[a._v("#")]),a._v(" 为什么要使用数据库？")]),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("持久化 ")]),t("font",{staticStyle:{color:"#000000"}},[a._v("将内存中的数据存储到关系型数据库中")])],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"#000000"}},[a._v("一张表可以存储，几千万，上亿条数据。")])],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"#000000"}},[a._v("类型多种多样，图片，大文本")])],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"#000000"}},[a._v("使用成本低，性能卓越，服务稳定，软件体积小，社区活跃")])],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"#000000"}},[a._v("概念：")])],1),a._v(" "),t("ol",[t("li",[t("font",{staticStyle:{color:"#000000"}},[a._v("DB 数据库   实际文件")])],1),a._v(" "),t("li",[t("font",{staticStyle:{color:"#000000"}},[a._v("DBMS 数据库管理系统")])],1),a._v(" "),t("li",[t("font",{staticStyle:{color:"#000000"}},[a._v("SQL 结构化查询语言")])],1)]),a._v(" "),t("p",[a._v("Mysql "),t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("开放源代码的关系型数据库管理系统")])],1),a._v(" "),t("ul",[t("li",[a._v("2008 sun 收购，2009 oracle 收购sun   mariadb  是mysql的分支项目")]),a._v(" "),t("li",[a._v("6.x 后分社区版和商业版")]),a._v(" "),t("li",[a._v("GPL 协议，修改源码来开发自己的mysql系统")]),a._v(" "),t("li",[a._v("mysql 支持上千万条大型数据库")]),a._v(" "),t("li",[a._v("mysql 在32系统下支持表文件4GB的存储，64位系统下支持表文件8TB的存储")]),a._v(" "),t("li",[a._v("标准的SQL 标记语言")]),a._v(" "),t("li",[a._v("mysql5.5 innodb 引擎作为默认存储引擎")]),a._v(" "),t("li",[a._v("mysql5.7 比较多 2015年")]),a._v(" "),t("li",[a._v("2016年 8.0")])]),a._v(" "),t("p",[a._v("oracle 适用于大型跨国企业，性能和安全性要求高，收费")]),a._v(" "),t("p",[a._v("mysql 中小型网站，互联网公司首选")]),a._v(" "),t("h2",{attrs:{id:"rdbms和非rdbms"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rdbms和非rdbms"}},[a._v("#")]),a._v(" RDBMS和非RDBMS")]),a._v(" "),t("ol",[t("li",[a._v("RDBMS 二维关系 行和列 构成表")]),a._v(" "),t("li",[a._v("非RDBMS 阉割版  性能非常高")])]),a._v(" "),t("ul",[t("li",[a._v("redis 键值型  内存缓存")]),a._v(" "),t("li",[a._v("mongodb 文档型  xml json")]),a._v(" "),t("li",[a._v("搜索引擎数据库  ES  solr 数据量大")]),a._v(" "),t("li",[a._v("列式数据库 HBase 降低IO   分布式文件系统")]),a._v(" "),t("li",[a._v("图形数据库 存储实体对象之间的关系")])]),a._v(" "),t("h2",{attrs:{id:"er与表记录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#er与表记录"}},[a._v("#")]),a._v(" ER与表记录")]),a._v(" "),t("p",[a._v("实体集，属性，联系集")]),a._v(" "),t("h3",{attrs:{id:"一对一关联"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一对一关联"}},[a._v("#")]),a._v(" 一对一关联")]),a._v(" "),t("ol",[t("li",[a._v("一对一可以创建成一张表")])]),a._v(" "),t("ul",[t("li",[a._v("外键唯一，外键是主键")])]),a._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[a._v("一对多")])]),a._v(" "),t("ul",[t("li",[a._v("主表的主键是从表的非主键字段")])]),a._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[a._v("多对多")])]),a._v(" "),t("ul",[t("li",[a._v("需要关联关系表")])]),a._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[a._v("自我引用")])]),a._v(" "),t("ul",[t("li",[a._v("自己对应自己，自我引用")])]),a._v(" "),t("h2",{attrs:{id:"mysql卸载"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql卸载"}},[a._v("#")]),a._v(" Mysql卸载")]),a._v(" "),t("div",{staticClass:"language-xml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[a._v("mysql --version  // 数据库版本\nmysql -uroot -p   // 后面接上密码\nshow databases;  // 数据库\nuse atguigudbl // 使用数据库\nshow tables;   // 展示表\nselect version();// 查询版本\nmysql -uroot -pabc123 -hlocalhost -P3307  // 主机端口号\nnet start 服务名 // 启动服务\nnet stop 服务名 // 停止服务\n")])])]),t("ul",[t("li",[a._v("控制面板卸载")]),a._v(" "),t("li",[a._v("msi 卸载")]),a._v(" "),t("li",[a._v("电脑管家或者360卸载")]),a._v(" "),t("li",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1700581511083-e88cd0a7-5a46-4f19-9676-f0e44e82674a.png",alt:""}})]),a._v(" "),t("li",[a._v("清除注册表  regedit")])]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("databases")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\ninformation_schema"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("-- 系统信息，数据库名称，表名称，存储权限")]),a._v("\nmysql   "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("-- 运行时系统信息。文件夹，字符集")]),a._v("\nperformance_schema"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("-- 性能指标")]),a._v("\nsys "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("-- 性能指标，开发人员监控性能")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("create")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("database")]),a._v(" bdtest1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 创建数据库")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" bdtest1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 使用数据库")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("create")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("table")]),a._v(" employees"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("id "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("name "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("varchar")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("15")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 创建表")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("tables")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 展示表")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("from")]),a._v(" employees"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 查看数据")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("insert")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("into")]),a._v(" employees "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("values")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1002")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Tom'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 插入数据")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("create")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("table")]),a._v(" employees"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 查看表信息")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("5.7")]),a._v(" 不能插入中文  数据库默认字符集 latin1 不包含汉字\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" variables "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("like")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'character_%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 显示字符集")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" variables "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("like")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'collation_%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 比较规则")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("drop")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("database")]),a._v(" dbtest1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 删除数据库")]),a._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("5.7")]),a._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("ini\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("default")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("character")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("utf8 "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#默认字符集")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("mysqld"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("character")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("server"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("utf8\ncollation"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("server"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("utf8_general_ci\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8.0")]),a._v(" 默认 utf8mb4 "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),a._v("个字节表示一个字符\n\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("5.7")]),a._v("默认是mysql_native_password\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8.0")]),a._v("默认是caching_sha2_password加密方式，需要更改加密规则\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" mysql；\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("alter")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("user")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'root'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@'localhost'")]),a._v(" IDENTIFIED "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("with")]),a._v(" mysql_native_password "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("by")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'123456'")]),a._v("\n\nflush "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("privileges")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n\nskip"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("grant")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("tables")]),a._v(" 忽略密码金融\n\n")])])]),t("h2",{attrs:{id:"sql分类"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sql分类"}},[a._v("#")]),a._v(" SQL分类")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[a._v("DDL: 数据定义语言  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("create")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("alter")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("drop")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("rename")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("truncate")]),a._v(" \n\nDML: 数据操纵语言  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("insert")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("delete")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("update")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),a._v(" \n\nDCL: 数据控制语言  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("commit")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("rollback")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("savepoint")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("grant")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("revoke")]),a._v(" \n\nwindows 不区分大小写\nlinux 区分大小写\n数据库名，表名，表的别名，变量名 区分大小写\n关键字，函数名，列名，列的字段名忽略大小写\n\n规范\n数据库名，表名，表别名，字段名，字段别名都小写\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("sql")]),a._v("关键字，函数名，绑定变量都大写\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 单行注释")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/*\n 多行注释\n*/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("-- 必需有空格")]),a._v("\n导入数据\nsource 文件的全路径名  cmd导入\n基于图形化工具导入\n\n别名 可以用双引号括起来 解决空格问题\n\n去除重复行\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("distinct")]),a._v(" 关键字 只能整体不重复\n\n空值参与运算\n"),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),a._v(" 和 "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("''")]),a._v(" 是不一样的\n"),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),a._v(" 参与运算的结果都是"),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),a._v("\nIFNULL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("commission_pct"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n着重号 "),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("`")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("`")])]),a._v(" \n解决"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("order")]),a._v(" 是关键字\n\n常数\n每一行都会匹配\n\n显示表结构\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DESCRIBE")]),a._v(" 表名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DESC")]),a._v(" 表名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("sql")]),a._v(" 在windows下是不区分大小写  字符串也不区分 ANSI 标准 是mysql放水了\noracle 字符串区分大小写  \n过滤数据\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("where")]),a._v(" \n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("sql")]),a._v(" 中 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" 没有连接作用。\n和字母相加会当"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("处理\n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v(" 除法是默认浮点型，除法自动保留小数位\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("100")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("div")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" 结果为"),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),a._v("\nmod 模数的符号 和被模数有关  为偶数 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("\n\n比较运算符\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("   字符串存在隐式转换，如果转换不成功，则看做是"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("\n\n两边都是字符串，通过ASNI的比较规则比较\n\n只要有"),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),a._v("参与运算结果就是"),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<=>")]),a._v("  安全等于 没有"),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),a._v(" 参与是一样的  "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),a._v("可以参与运算\n一样为"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" 不一样为"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("is")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),a._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("is")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("not")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),a._v("  isnull函数\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),a._v(" commission_pct\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("from")]),a._v(" employees\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("where")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("not")]),a._v(" commission_pct "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<=>")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" 也可以\n\nLEAST 最小  GREATEST 最大 LENGTH 长度\n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("BETWEEN")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("AND")]),a._v(" 区间 左右都包含 要求条件"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("是下限 条件"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("是上限 \n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("and")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" 且  \n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("in")]),a._v(" 区间   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("not")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("in")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("or")]),a._v(" 或 非零就是"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("  条件要完整\n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("like")]),a._v(" 模糊查询  "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")]),a._v("a"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")]),a._v("不确定个数的字符\n\nlast_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("like")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%a%e%'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("or")]),a._v(" last_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("like")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%e%a%'")]),a._v("\n\n_ 代表一个不确定的字符\n\n转义字符 \\\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ESCAPE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'$'")]),a._v(" 告诉数据库这个是转义字符\n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("REGEXP")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("RLIKE")]),a._v(" 正则\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),a._v(" 开头\n$ 结尾\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v(" 任意一个字符\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("abc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" 有a 或b 或c  "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("代表范围\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" 匹配任意多个字符可以是零个\n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("XOR")]),a._v(" 异或  不同为真，相同为假\n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("and")]),a._v(" 比 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("or")]),a._v(" 的优先级高\n\n\n\n默认存储顺序，先后添加的顺序 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ORDER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BY")]),a._v("\n\n使用 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ORDER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BY")]),a._v(" 默认升序 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ASC")]),a._v("\n\n可以使用列的别名进行排序\n\n列的别名只能在 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ORDER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BY")]),a._v(" 中使用\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("WHERE")]),a._v(" 不可以使用别名\n\n二级排序 逗号分割就可以了 第一列相同\n，再考虑第二列\n\n分页节省资源 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("limit")]),a._v(" 偏移量 显示条目数\n\n第二页  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("limit")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("20")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("20")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n公式 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("pageNo"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v("pageSize"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("pageSize\n\n声名顺序 \n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("where")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2.")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("order")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("by")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3.")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("limit")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("limit")]),a._v(" 位置偏移量为"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" 可以省略这个"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("\n\n偏移量从开始 注意一下\n\nMysql "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8.0")]),a._v(" 新特性\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("OFFSET")]),a._v(" 颠倒一下原来的顺序\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("limit")]),a._v(" 必须在最后！！！ PGSQL，SQLITE，MARIABD\n\n扩展： sqlserver 使用"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("top")]),a._v("\nDB2 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FETCH")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FIRST")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ROWS")]),a._v(" ONLY\noracle rownum 统计 隐藏字段\n前"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("条记录 rownum"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("\n\nlength"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("email"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("desc")]),a._v(" 邮箱字节数降序\n\n\n拆表  解决冗余 IO次数变多，影响效率，粒度小的方面考虑 并发的角度\n\n笛卡尔积：员工和部门都匹配了一遍。交叉连接\n缺少连接条件  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("cross")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("join")]),a._v("  连接条件没写对\n所有可能都出现一遍，元素个数的乘积\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("-- 关联查询")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" employee_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("department_name\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" employees"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("departments\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("where")]),a._v(" employees"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("department_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" departments"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("department_id\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("-- 建议多表查询每个字段前都指明所在的表")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" employee_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("department_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("employees"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("department_id\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" employees"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("departments\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("where")]),a._v(" employees"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("department_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" departments"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("department_id\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("-- 可以给表起别名。在select 和 where 中使用  原名和别名不能混用，用了别名就不能用原名·")]),a._v("\n\nn个表至少要有n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("个连接条件，否则会出现笛卡尔积\n\n\n多表查询的分类\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.")]),a._v(" 等值连接和非等值连接\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2.")]),a._v(" 自连接和非自连接\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3.")]),a._v(" 内连接和外连接\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#非等值连接")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("last_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("salary"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("j"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("grade_level\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" employees e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("job_grades j\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("where")]),a._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("salary "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("between")]),a._v(" j"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("lowest_sal "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("and")]),a._v(" j"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("highest_sal\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#自连接 查询员工id，员工姓名及其管理者的id和姓名")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("employee_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("last_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("employee_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("last_name\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" employees a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("employees b\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("WHERE")]),a._v(" a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("manager_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("employee_id\n\n内连接  合并具有同一列的两个以上的表的行\n\n外连接 合并具有同一列的两个以上的表的行，与另一个表匹配的行\n\n左外 右外  满连接\n\nsql92 sql99 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("sql")]),a._v("经典标准\n\nsql92 外连接  使用"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" 在裤子短的位置\nmysql 不支持sql92   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\nSQL99 是支持的\nmysql 不支持 满外连接  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FULL")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("OUTER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("JOIN")]),a._v(" \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("JOIN")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ON")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INNER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("JOIN")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ON")]),a._v(" 内连接 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INNER")]),a._v(" 可以省略\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("LEFT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("OUTER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("JOIN")]),a._v(" 外连接 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("OUTER")]),a._v(" 可以省略\n\nSQL99 "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("7")]),a._v("种"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("JOIN")]),a._v("实现方式\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("union")]),a._v(" 合并查询结果 去重重复数据  列必须一样\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("union")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("all")]),a._v(" 合并查询结果 不去重   效率高  最好用"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("union")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("all")]),a._v("\n\n使用"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("IS")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("NULL")]),a._v("  去掉对应的中间部分\n\n自然连接\n两个连接条件  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("NATURAL")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("JOIN")]),a._v("  它回自动帮我查询两张连接表中的所有相同字段的，进行等值连接\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("USING")]),a._v("\n替换连接条件  当两张表的名字是一样的 里面是相同的字段名\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("USING")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("department_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n阿里巴巴 规范 禁止超过三个表进行"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("join")]),a._v("操作\n\n")])])]),t("h2",{attrs:{id:"函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#函数"}},[a._v("#")]),a._v(" 函数")]),a._v(" "),t("ol",[t("li",[a._v("将代码进行封装，提高了代码效率，提高了维护性，提高用户对数据库的关联效率")]),a._v(" "),t("li",[a._v("SQL代码移植性比较差。")])]),a._v(" "),t("h3",{attrs:{id:"单行函数-可以嵌套"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#单行函数-可以嵌套"}},[a._v("#")]),a._v(" 单行函数（可以嵌套）")]),a._v(" "),t("p",[a._v("一行出来一行")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[a._v("数值函数\nABS 绝对值\nSIGN 返回符号i\nPI 圆周率\nCEIL 和 CEILING 天花板\nFLOOR 地板\nLEAST 一列最小\nGREATEST 一列最大\nMOD 取余\nRAND 随机值 "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("~")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\nRAND（x） 随机值"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("~")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("  x值会产生相同的随机数\nROUND 四舍五入  后面的参数可以是负数，抹零\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TRUNCATE")]),a._v("（x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("y）  x截取y位小数\nSQRT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" x的平方根\n\n角度和弧度的互换\nRADIANS   角度变弧度\nDEGREES   弧度变角度\nSIN\nASIN\nCOS\nACOS\nTAN\nATAN\nARAN2\nCOT\n\n指数和对数\npow power\nexp  e的x次方  e位常数"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2.718128182859045")]),a._v("\nln log\nlog10  log2\n\n进制转换\nBIN  二进制\nHEX  "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),a._v("进制\nOCT   "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8")]),a._v("进制\nCONV 机制转换  conv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("f1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("f2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n\n字符串函数\nASCII 第一个字符有关系\nCHAR_LENGTH 字符长度\nLENGTH UTF8 汉字三个字节 字节长度\nCONCAT 连接字符串\nCONCAT_WS 指定连接字符\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INSERT")]),a._v(" 字符串的索引是从"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("开始的    替换 从索引位置 替换多少个\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REPLACE")]),a._v(" 替换\nUPPER 大写\nLOWER 小写\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("LEFT")]),a._v(" 最左面的几个字符\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("RIGHT")]),a._v(" 最右面的几个字符 \nLPAD 左补充 一共多少位  以什么补齐\nRPAD 右补充 一共多少位  以什么补齐\nTRIM 去除空格\nLTRIM 左去除\nRTRIM 右去除\nTRIM（s1 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" S）指定去除什么\nTRIM"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("LEADING s1 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" S"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" 去除头部的S1\nTRIM"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("TRAILING s1 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" S"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" 去除尾部的S1\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REPEAT")]),a._v(" 重复n次结果\nSPACE 返回几个空格\nSTRCMP 比较ASCII码\nSUBSTR 截取字符串\nLOCATE 返回首次出现的位置\nELT 返回指定位置的字符串\nFIELD  返回字符串s在字符串列表中首次出现的位置\nFIND_IN_SET 返回字符串s1在字符串s2出现的位置\nREVERSE 反转\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("NULLIF")]),a._v(" 相等返回"),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("NULL")]),a._v("，不想等返回前面的\n\n日期函数\nCURDATE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" 当前时间   年月日\nCURTIME"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" 当前时间   时分秒\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("NOW")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("   当前时间\nUTC_DATE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("  格林威治时间 年月日\nUTC_TIME"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("  格林威治时间 时分秒\n\n日期转时间戳\nUNIX_TIMESTAMP"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("date")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nUNIX_TIMESTAMP"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nFROM_UNIXTIME"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n年，月，日，星期，时分秒的获取\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("YEAR")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("MONTH")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DAY")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("HOUR")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("MINUTE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SECOND")]),a._v("\nMONTHNAME  英文月数\nDAYNAME 英文周几\nWEEKDAY 第几周\nQUARTER 季节\nWEEK 这一年的第几周\nDAYOFYEAR 这一年的多少天\nDAYOFMONTH 这个月的第几天\nDAYOFWEEK 周几\n\n日期的操作函数  提取日期\nEXTRACT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("type")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("from")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("date")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("type")]),a._v(" 可以是对应的类型  \n\n时间和秒数的转换\nTIME_TO_SEC"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nSECT_TO_TIME"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n计算日期和时间的函数\nDATE_ADD"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("dateTIME")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INTERVAL")]),a._v(" expr "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" 新增时间\nDATE_SUB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("dateTIME")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INTERVAL")]),a._v(" expr "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" 减去时间\nADDTIME"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("time1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("time2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("   数字值时是秒\nSUBTIME"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("time1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("time2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("   数字值时是秒\nDATEDIFF"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("date1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("date2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("  间隔多少天\nTIMEDIFF"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("time1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("time2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("  间隔时间\nFROM_DAYS"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("N"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" 从"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0000")]),a._v("年"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("月"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("日。N天以后的日期\nTO_DAYS"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("date")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("  返回日期"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("date")]),a._v("日期距离"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0000")]),a._v("年"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("月"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("日所在天数\nLAST_DAY"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("  所在年份最后一天\nMAKEDATE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("year")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("  根据年和日创建时间\nMAKETIME"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("hour")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("minute")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("second")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" 分解小时，分，秒。计算时间返回\nPERIOD_ADD"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("time")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" 返回"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("time")]),a._v("加上n后的时间\n\n日期的格式化和解析\nDATE_FORMAT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("date")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("fmt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("   \nTIME_FORMAT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("time")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("fmt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nGET_FORMAT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("date_type"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("format_type"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" 获取格式化\nSTR_TO_DATE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("str"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("fmt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" \n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1702226252050-f799ecfe-7574-4a12-819c-30f99f3c0d8c.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1702226310501-cb8c5425-8731-4883-8d42-98abb6c71221.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1702226615440-7deca405-a522-4849-9a31-08e76824711b.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1702227555063-26b4ffb3-9e15-4cb7-98a1-fb4e732ebfe2.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1702227642841-537deee1-8e90-4410-806a-3c3823389a95.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1702227721960-bf59b782-7225-412c-a556-a0c75f2d5762.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1702228133320-34a083aa-1326-4a4f-9149-fd3d8e77f5a0.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1708500299115-0f839a05-0804-47a4-a616-6e256657c722.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"聚合函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#聚合函数"}},[a._v("#")]),a._v(" 聚合函数")]),a._v(" "),t("p",[a._v("一行出来多行")]),a._v(" "),t("h3",{attrs:{id:"流程控制函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#流程控制函数"}},[a._v("#")]),a._v(" 流程控制函数")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1702526490028-9674fe39-59f8-4ebd-8a42-7d312edddbf0.png",alt:""}})]),a._v(" "),t("ul",[t("li",[a._v("第一个有些像三元表达式")]),a._v(" "),t("li",[a._v("第4个 expr  是字段名   when 后面是常量值  起别名要在END 后")])]),a._v(" "),t("h2",{attrs:{id:"加密和解密的操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#加密和解密的操作"}},[a._v("#")]),a._v(" 加密和解密的操作")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1702529156552-04a0c933-62da-47a0-a34d-ae53c2fe99f1.png",alt:""}})]),a._v(" "),t("p",[a._v("password ENCODE  DECODE 8.0 的版本不支持，已弃用。")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1702529516091-5b03d7aa-3260-478d-9b62-4b87704e4060.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1702529652572-943712aa-0443-4f5b-a3d2-6b9a683248c8.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1702529809553-4b40f110-9fd0-423c-8527-e88ed98980dc.png",alt:""}})]),a._v(" "),t("p",[a._v("char_length  字符多少")]),a._v(" "),t("p",[a._v("length 字节多少")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[a._v("AVG 平均值  里面是字符串是没有意义的\nSUM  和   里面是字符串是没有意义的\nMAX 最大  可以是字符串或者日期\nMIN 最小  可以是字符串或者日期\nCOUNT 作用 计算指定字段在查询结果中的作用   记录数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("COUNT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" 把每一行当成"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("COUNT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("  也可以\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("COUNT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("具体字段"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" 不一定对的  不计算空值的\nsum 计算不考虑"),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),a._v("值   avg 计算也不考虑"),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),a._v("值  里面使用ifnull"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("字段值，"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("处理\n\nMyISAM 存储引擎  三者效率相同 O1\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Innodb")]),a._v(" 存储引擎 "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("count")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("count")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("count")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("字段"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("  效率高是因为使用了二级索引 找key_len 小的\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("GROUP")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BY")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" 中出现一下的非组函数的字段必须声明在"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("GROUP")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BY")]),a._v(" 中，反之，"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("GROUP")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("by")]),a._v(" 中声名的字段可以不出现在"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v("中\n\n\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("WITH ROLLUP")]),a._v(" 整体的分组  慎重和"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("order")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("by")]),a._v(" 使用 会报错\n\n如何过滤条件中使用了聚合函数，则必须使用"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("having")]),a._v("来替换"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("where")]),a._v("，否则报错\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("having")]),a._v(" 必须声名在"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("group")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("by")]),a._v(" 的后面\n\n开发中使用的前提是"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("sql")]),a._v("中，使用了"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("group")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("by")]),a._v("，针对分组进行过滤的\n\n当过滤条件中有聚合函数时候，则此过滤条件必须声名在"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("HAVING")]),a._v("中。\n没有聚合函数声名在"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("where")]),a._v("中，"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("where")]),a._v("效率高于"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("having")]),a._v("\n\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1702800945058-dd000dff-5563-4379-923b-6dcabbf78ef0.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"sql执行原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sql执行原理"}},[a._v("#")]),a._v(" SQL执行原理")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1702801660795-99333ba3-a35b-473c-a1e8-75dbe9a383f7.png",alt:""}})]),a._v(" "),t("ol",[t("li",[a._v("FROM 交叉连接")]),a._v(" "),t("li",[a._v("ON 过滤")]),a._v(" "),t("li",[a._v("左外还是右外")]),a._v(" "),t("li",[a._v("WHERE")]),a._v(" "),t("li",[a._v("GROUP BY")]),a._v(" "),t("li",[a._v("HAVING")]),a._v(" "),t("li",[a._v("SELECT 列上的过滤")]),a._v(" "),t("li",[a._v("DISTINCT 去重")]),a._v(" "),t("li",[a._v("ORDER BY")]),a._v(" "),t("li",[a._v("LIMIT")])]),a._v(" "),t("p",[a._v("每一个步骤都会产生一个虚拟表")]),a._v(" "),t("h2",{attrs:{id:"子查询"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#子查询"}},[a._v("#")]),a._v(" 子查询")]),a._v(" "),t("p",[a._v("谁的工资比Abel 高")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1702827864201-b2abe253-ac22-4efd-a2fa-f34b93d74bdd.png",alt:""}})]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" last_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("salary\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" employees\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("WHERE")]),a._v(" salary "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" salary\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" employees\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("WHERE")]),a._v(" last_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Abel'")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n外查询（主查询）  内查询（子查询）\n\n内查询先计算\n子查询在括号内\n放在比较条件的右侧 可读性比较好\n\n单行子查询和多行子查询\n\n")])])]),t("p",[a._v("分类")]),a._v(" "),t("ol",[t("li",[a._v("单行子查询和多行子查询   根据查询出来的条目数去辨别")]),a._v(" "),t("li",[a._v("内查询是否被执行多次，相关子查询和非相关子查询")])]),a._v(" "),t("p",[a._v("相关子查询  子查询的结果是变化的")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1702828841983-f560e4f9-8f11-4364-b733-01e5fc7ab188.png",alt:""}})]),a._v(" "),t("p",[a._v("子查询有空值，不返回任何行")]),a._v(" "),t("p",[a._v("单行子查询  =  !=> < >= <=")]),a._v(" "),t("p",[a._v("多行子查询  in  any  some   all")]),a._v(" "),t("p",[a._v("any 和 some 是同一个    all和 any 经常和单行运算符一起用")]),a._v(" "),t("p",[a._v("聚合函数 不能嵌套   mysql 不可以   oracle 可以")]),a._v(" "),t("p",[a._v("子查询作为表用的时候要有别名")]),a._v(" "),t("p",[a._v("查询平均工资最低的部门id")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1703000365421-344f599a-7ba2-48a8-aa9d-be63f36dab1a.png",alt:""}})]),a._v(" "),t("p",[a._v("内查询有null值，not in 就不会有结果")]),a._v(" "),t("p",[a._v("关联子查询")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1703004015527-5e1fc126-7e3a-4290-ac11-5203e3f959e2.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1703004282580-317a8f20-7e20-4fc3-8c28-7fd0d171b18a.png",alt:""}})]),a._v(" "),t("p",[a._v("结论：在SELECT 除了GROUP BY 和 LIMIT 之外其他位置，都可以声名子查询。")]),a._v(" "),t("p",[a._v("EXISTS 和 NOT EXISTS")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1703005447089-93119a2f-0e54-48ee-bc3d-2edc5f51a045.png",alt:""}})]),a._v(" "),t("p",[a._v("自连接 效率高于子查询")]),a._v(" "),t("p",[a._v("相关子查询 比较简单 从外往里面写")]),a._v(" "),t("h2",{attrs:{id:"标识符命名规则"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#标识符命名规则"}},[a._v("#")]),a._v(" 标识符命名规则")]),a._v(" "),t("ol",[t("li",[a._v("数据库和表名不能超过30个字符，变量名限制为29个")]),a._v(" "),t("li",[a._v("必须只能包含A-Z，a-z，0-9，_")]),a._v(" "),t("li",[a._v("中间不能有空格")]),a._v(" "),t("li",[a._v("数据库中表不能重名，表中字段不能重名")]),a._v(" "),t("li",[a._v("字段没有保留字，如果要用就加上着重号")]),a._v(" "),t("li",[a._v("表和表直接的字段名和类型要保持一致")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1703173994897-fa1d3e65-5597-44cb-869d-4e1a39a78ae8.png",alt:""}})]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("create")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("database")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("not")]),a._v(" exist 数据库名  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("character")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" 字符集\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 查看当前使用的数据库")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DATABASE")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" DUAL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 查看指定数据库下的表")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLES")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 查看数据库的创建信息")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SHOW")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DATABASE")]),a._v(" 数据库名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 修改数据库字符集")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ALTER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DATABASE")]),a._v(" 数据库名 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("character")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" 字符集\n可视化工具 改库名都是创建一个新的库，把数据复制过去，成本比较高\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 删除数据库")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DROP")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DATABASE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("IF")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("EXISTS")]),a._v(" 数据库名\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1703175264471-2451e662-6d4a-4bdf-93f7-7dcf724da73a.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1703175391001-1d82e6b8-0091-4bff-bbf9-152120621fec.png",alt:""}})]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("IF")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("NOT")]),a._v(" EXIST 表名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n字段名  字段类型  字段长度\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("desc")]),a._v(" 表名   "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 查看表结构")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("create")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("table")]),a._v(" 表名 "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 查看表结构")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 数据也会带过来 需要用where 1 =2 过滤数据  别名也可以用就是字段名  也可以关联表")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("create")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("table")]),a._v(" 表名\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("as")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),a._v(" 字段名\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" 表名 \n\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1703175967153-a4279748-6110-451d-a579-b0618927aea6.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1703176149732-a3af5ebf-5520-4819-8819-b1cc6e3ad2da.png",alt:""}})]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 修改表  alter table")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("， 添加字段  默认添加到表的最后一个字段 \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ALTER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" 表名  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ADD")]),a._v(" 字段名 字段类型  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FIRST")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("AFTER")]),a._v(" 字段名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2.")]),a._v(" 修改字段 数据类型 长度\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ALTER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" 表名 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("MODIFY")]),a._v(" 字段名 字段类型 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("default")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'aaa'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3.")]),a._v(" 重命名一个字段 有"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("MODIFY")]),a._v("行为\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ALTER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" 表名 CHANGE  字段名 字段类型 新字段名 字段类型 \n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("4.")]),a._v(" 删除一个字段\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ALTER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" 表名 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DROP")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("COLUMN")]),a._v(" 字段名\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 重命名表")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("RENAME")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" 原数据库名 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TO")]),a._v(" 新数据库名\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ALTER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" 原数据库名 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("RENAME")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TO")]),a._v(" 新数据库名\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 删除表 不能回滚  日志文件 触发器 备份 释放表空间")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DROP")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("IF")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("EXISTS")]),a._v(" 表名\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 清空表 清空数据，表结构还在")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TRUNCATE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" 表名\n")])])]),t("h2",{attrs:{id:"commit和rollback"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#commit和rollback"}},[a._v("#")]),a._v(" COMMIT和ROLLBACK")]),a._v(" "),t("p",[a._v("commit  提交数据  一旦执行，数据永久保存  不可以回滚")]),a._v(" "),t("p",[a._v("rollback  可以实现数据的回滚，回滚到最近一次commit")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 相同点  都是对数据的删除，同时保留表结构")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 不同点")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TRUNCATE")]),a._v(" 数据不可以回滚，表数据全部清除\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DELETE")]),a._v(" 可以全部清除，数据可以回滚\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// DDL 和 DML 的说明")]),a._v("\nDDL 一旦执行，就不可以回滚，自动"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("COMMIT")]),a._v(" 不受我们的"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" autocommit "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),a._v("操作影响\nDML 默认情况下，一旦执行，也不可以回滚，通过修改参数可以回滚，如在执行DML之前\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" autocommit "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),a._v(" 就可以回滚\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// DELETE")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("COMMIT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" autocommit "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DELETE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" 表名\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ROLLBACK")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// TRUNCATE")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("COMMIT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" autocommit "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TRUNCATE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" 表名\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ROLLBACK")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("mysql8.0 的原子性  要么全部成功，要么不成功   区别于5.7   体现在进行DDL 操作的时候，执行成功的效果")]),a._v(" "),t("h2",{attrs:{id:"dml-添加数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dml-添加数据"}},[a._v("#")]),a._v(" DML 添加数据")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INSERT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INTO")]),a._v(" emp1 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("values")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("字段值"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("字段值"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 一定要知道声名字段的先后顺序")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INSERT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INTO")]),a._v(" emp1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("字段名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("VALUES")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("字段值"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 推荐这种  里面的值可以少，但是要一一对应")]),a._v("\n可以使用逗号同时插入记录  插入多条记录  效率高 比单行一条一条添加快\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 将查询结果插入到表中")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INSERT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INTO")]),a._v(" emp1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("字段名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" 查询   查询的字段名要与添加到的字段一一对应  数据范围不一样可能会报错 数据长度不够的风险\n")])])]),t("h3",{attrs:{id:"更新-删除数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更新-删除数据"}},[a._v("#")]),a._v(" 更新/删除数据")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("update")]),a._v(" 表名 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("where")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("\n可以实现批量修改\n\n修改同一数据的多个字段 逗号分割   可能存在不成功的情况 收到约束影响\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DELETE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("WHERE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("  删除也可能存在不成功的情况，表之间存在外键\n\n回滚可以使用"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" autocommit "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("FALSE")]),a._v("\n")])])]),t("h3",{attrs:{id:"mysql-8-0-计算列"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql-8-0-计算列"}},[a._v("#")]),a._v(" MYSQL 8.0 计算列")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" test"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n  a "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  b "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  c "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INT")]),a._v(" GENERATED ALWAYS "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("AS")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("a"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v("b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" VIRTUAL\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("h3",{attrs:{id:"去掉字符串中间的空格"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#去掉字符串中间的空格"}},[a._v("#")]),a._v(" 去掉字符串中间的空格")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("replace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("字段值"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("' '")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("''")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("h3",{attrs:{id:"插入-删除新方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#插入-删除新方法"}},[a._v("#")]),a._v(" 插入/删除新方法")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("insert")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("into")]),a._v("  表名\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),a._v(" 字段值"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("union")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("all")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DELETE")]),a._v(" 表"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("别名，表"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("别名\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" 表"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("JOIN")]),a._v(" 表"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ON")]),a._v(" 条件 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("WHERE")]),a._v(" 过滤条件\n")])])]),t("h2",{attrs:{id:"数据类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据类型"}},[a._v("#")]),a._v(" 数据类型")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1703175264471-2451e662-6d4a-4bdf-93f7-7dcf724da73a.png?x-oss-process=image%2Fresize%2Cw_1125%2Climit_0",alt:""}}),a._v("    1. 创建数据库，表和字段都可以知道字符集 character set 'utf8'")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1703695330489-739ec2d8-eef0-4c08-ba06-bec7e38953d0.png",alt:""}}),a._v("'"),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2023/png/33708367/1703835292378-14715472-906f-44be-b58b-10a9c79491dd.png",alt:""}})]),a._v(" "),t("p",[a._v("ZEROFILL 零填充")]),a._v(" "),t("p",[a._v("INT(5)  显示宽度  配合 ZEROFILL 使用 当显示宽度不足五位用0填充  自动加上unsigned")]),a._v(" "),t("p",[a._v("8.0.17 以后不要使用显示宽度了")]),a._v(" "),t("p",[a._v("TINYINT   设置取值范围的时候")]),a._v(" "),t("p",[a._v("SMALLINT  统计工厂的固定资产库存数量")]),a._v(" "),t("p",[a._v("MEDIUMINT  客流量")]),a._v(" "),t("p",[a._v("INT  商品编号")]),a._v(" "),t("p",[a._v("BIGINT 双十一的交易量，大型门户网站点击量")]),a._v(" "),t("p",[a._v("存储空间和可靠性")]),a._v(" "),t("p",[a._v("确保数据不会超过取值范围")]),a._v(" "),t("h3",{attrs:{id:"浮点类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#浮点类型"}},[a._v("#")]),a._v(" 浮点类型")]),a._v(" "),t("p",[a._v("REAL 默认就是double，可以改成float")]),a._v(" "),t("p",[a._v("REAL_AS_FLOAT")]),a._v(" "),t("p",[a._v("浮点数格式：符号，尾数，阶码")]),a._v(" "),t("p",[a._v("非标准写法 FLOAT（M,D）M是标度，D是精度")]),a._v(" "),t("p",[a._v("UNSIGNED 只有一半的")]),a._v(" "),t("p",[a._v("超过整数，报错")]),a._v(" "),t("p",[a._v("超过小数，四舍五入")]),a._v(" "),t("p",[a._v("建议不要使用等号去判断是否相等。")]),a._v(" "),t("p",[a._v("场景：计算化学，分子建模，流体动力学")]),a._v(" "),t("h3",{attrs:{id:"定点数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#定点数"}},[a._v("#")]),a._v(" 定点数")]),a._v(" "),t("p",[a._v("decimal 最大的取值范围和DOUBLE 一样（注意不是有效取值范围）")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1704850413476-9849076a-5019-431f-a0a8-e5104913511f.png",alt:""}})]),a._v(" "),t("p",[a._v("底层使用字符串方式去存储")]),a._v(" "),t("p",[a._v("默认decimal (10,0)")]),a._v(" "),t("p",[a._v("场景：金额计算")]),a._v(" "),t("h3",{attrs:{id:"位类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#位类型"}},[a._v("#")]),a._v(" 位类型")]),a._v(" "),t("p",[a._v("BIT  2进制  默认是1位")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1704853334879-26b22a4a-44eb-4493-acd1-269dd3f194ab.png",alt:""}})]),a._v(" "),t("p",[a._v("BIN（）  HEX（） 读取方式 2进制16进制")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1704853718732-e3771023-7086-4408-9818-0880bf175229.png",alt:""}})]),a._v(" "),t("p",[a._v("10进制")]),a._v(" "),t("h3",{attrs:{id:"时间类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#时间类型"}},[a._v("#")]),a._v(" 时间类型")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1704855778317-1794b11b-1a81-4fe2-bd53-1c2d257906e9.png",alt:""}})]),a._v(" "),t("p",[a._v("year")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1704856353769-deadcf43-24fe-4d2a-8aa5-8e00526e09d6.png",alt:""}})]),a._v(" "),t("p",[a._v("TIME")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1704861472832-e7779221-d4c5-41c3-861e-c4d8d1c0afdf.png",alt:""}})]),a._v(" "),t("p",[a._v("DATETIME 和 TIMESTAMP 区别")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" time_zone"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'+9:00'")]),a._v("\n")])])]),t("p",[a._v("TIMESTAMP 存储空间小，时间范围小")]),a._v(" "),t("p",[a._v("TIMESTAMP 底层是毫秒值")]),a._v(" "),t("p",[a._v("两个日期比较大小或日期计算时，TIMESTAMP更快")]),a._v(" "),t("p",[a._v("TIMESTAMP和时区有关，用户所处不同时区显示不同结果")]),a._v(" "),t("p",[a._v("DATETIME只能反应插入时候的时区")]),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("DATETIME 使用最多")])],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("注册时间，商品发布时间不建议使用，最好使用时间戳，因为DATETIME不方便计算。"),t("br")])],1),a._v(" "),t("h3",{attrs:{id:"字符串类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#字符串类型"}},[a._v("#")]),a._v(" 字符串类型")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1704936681037-f3e2fe97-1a7e-4a13-8b4f-acff33c8b1d4.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1704936702045-98de466a-72cc-4d70-b1c9-fa3f93dd0afb.png",alt:""}})]),a._v(" "),t("p",[a._v("char 默认1   右侧填充空格")]),a._v(" "),t("p",[a._v("varchar 必须指定 M  长度")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1704937305466-ad17187c-6508-4d27-a21c-a650426985f6.png",alt:""}})]),a._v(" "),t("p",[a._v("存储很短 用char")]),a._v(" "),t("p",[a._v("固定长度 用char")]),a._v(" "),t("p",[a._v("十分频繁的改字段  用char")]),a._v(" "),t("p",[a._v("存储引擎")]),a._v(" "),t("p",[a._v("MYISAM  建议用char 长度固定，静态化，数据检索更快")]),a._v(" "),t("p",[a._v("MEMORY 不管定义什么都是char")]),a._v(" "),t("p",[a._v("INNODB 推荐使用varchar  主要影响因素是数据行存储的总量")]),a._v(" "),t("h3",{attrs:{id:"text-类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#text-类型"}},[a._v("#")]),a._v(" TEXT 类型")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1704937978038-3bf03ec0-ba1d-4fbd-a531-6e7da82d7e69.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1704938471115-94978aff-70ce-428f-b709-ed3b2d1edbc1.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"enum类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#enum类型"}},[a._v("#")]),a._v(" ENUM类型")]),a._v(" "),t("p",[a._v("忽略大小写")]),a._v(" "),t("p",[a._v("可以使用索引进行调用")]),a._v(" "),t("p",[a._v("可以添加null，没有限制非空")]),a._v(" "),t("p",[a._v("只能选一个")]),a._v(" "),t("h3",{attrs:{id:"set类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#set类型"}},[a._v("#")]),a._v(" SET类型")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1704939048530-069b9f32-0366-48d7-bec7-dd2d341447c4.png",alt:""}})]),a._v(" "),t("p",[a._v("可以写多个，不可以写不存在的，多个会去重")]),a._v(" "),t("h3",{attrs:{id:"二进制字符串"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二进制字符串"}},[a._v("#")]),a._v(" 二进制字符串")]),a._v(" "),t("p",[a._v("BINARY 和 VARBINARY 和 char VARCHAR类似   VARBINARY 必须指定长度   BINARY 不指明是1")]),a._v(" "),t("p",[a._v("BIOB 二进制大对象  图片，音频，视频")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1705134934691-dd87cdbd-0037-488c-922d-0a68c1c3590d.png",alt:""}})]),a._v(" "),t("p",[a._v("开发中很少把文件存到数据库，都是存路径")]),a._v(" "),t("p",[a._v("OPTIMIZETABLE 功能对表进行碎片整理，空洞")]),a._v(" "),t("p",[a._v("前缀索引 少去检索大文本")]),a._v(" "),t("p",[a._v("分离单独表去做，减少主表碎片")]),a._v(" "),t("h3",{attrs:{id:"json类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#json类型"}},[a._v("#")]),a._v(" JSON类型")]),a._v(" "),t("p",[a._v("数据交互格式")]),a._v(" "),t("p",[a._v("js  JSON可以将JS对象表示一组数据转换成字符串。 js -> $.字段名")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1705136750679-261ba031-5a37-4f44-a805-c15b330f6d9c.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"空间类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#空间类型"}},[a._v("#")]),a._v(" 空间类型")]),a._v(" "),t("p",[a._v("单值和集合类型 用的比较少  地理特征的生成存储和分析")]),a._v(" "),t("h3",{attrs:{id:"数据类型小结-可靠性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据类型小结-可靠性"}},[a._v("#")]),a._v(" 数据类型小结 可靠性")]),a._v(" "),t("p",[a._v("整数 INT")]),a._v(" "),t("p",[a._v("小数 DECIMAL")]),a._v(" "),t("p",[a._v("日期和时间 DATETIME")]),a._v(" "),t("p",[a._v("非负数 UNSIGNED")]),a._v(" "),t("p",[a._v("小数 超出 分开存储")]),a._v(" "),t("p",[a._v("定长用char")]),a._v(" "),t("p",[a._v("长度不超过5000用VARCHAR，超出就用text")]),a._v(" "),t("h2",{attrs:{id:"为什么需要约束"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为什么需要约束"}},[a._v("#")]),a._v(" 为什么需要约束")]),a._v(" "),t("ol",[t("li",[a._v("保证数据的完整性")])]),a._v(" "),t("h3",{attrs:{id:"考虑方面"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#考虑方面"}},[a._v("#")]),a._v(" 考虑方面")]),a._v(" "),t("ul",[t("li",[a._v("实体完整性")]),a._v(" "),t("li",[a._v("域完整性")]),a._v(" "),t("li",[a._v("引用完整性")]),a._v(" "),t("li",[a._v("用户自定义完整性")])]),a._v(" "),t("h2",{attrs:{id:"约束"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#约束"}},[a._v("#")]),a._v(" 约束")]),a._v(" "),t("p",[a._v("创建表时规定的约束，表创建之后通过语句规定约束   表级的强制规定")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" 添加约束\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ALTER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" 增加约束"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("删除约束\n")])])]),t("h3",{attrs:{id:"约束的分类"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#约束的分类"}},[a._v("#")]),a._v(" 约束的分类")]),a._v(" "),t("ul",[t("li",[a._v("跟进约束数据列的限制")])]),a._v(" "),t("ol",[t("li",[a._v("单列约束: 每个约束只约束一列")]),a._v(" "),t("li",[a._v("多列约束: 每个约束可约束多列数据")])]),a._v(" "),t("ul",[t("li",[a._v("约束的作用")])]),a._v(" "),t("ol",[t("li",[a._v("列级约束： 只能作用一个列跟在列的后面")]),a._v(" "),t("li",[a._v("表级约束：可以作用在多个列上，不与列一起，而是单独定义")])]),a._v(" "),t("h3",{attrs:{id:"约束的种类"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#约束的种类"}},[a._v("#")]),a._v(" 约束的种类")]),a._v(" "),t("ul",[t("li",[a._v("NOT NULL 非空约束")]),a._v(" "),t("li",[a._v("UNIQUE 唯一约束")]),a._v(" "),t("li",[a._v("PRIMARY  主键约束")]),a._v(" "),t("li",[a._v("FOREIGN KEY 外键约束")]),a._v(" "),t("li",[a._v("CHECK 检查约束")]),a._v(" "),t("li",[a._v("DEFAULT 默认值约束")])]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" information_schema"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("table_constraints\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("where")]),a._v(" table_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'employees'")]),a._v("\n")])])]),t("h4",{attrs:{id:"非空约束"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#非空约束"}},[a._v("#")]),a._v(" 非空约束")]),a._v(" "),t("p",[a._v("NOT NULL   默认都可以为NULL  列级约束")]),a._v(" "),t("h4",{attrs:{id:"唯一约束"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#唯一约束"}},[a._v("#")]),a._v(" 唯一约束")]),a._v(" "),t("div",{staticClass:"language-plain extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plain"}},[t("code",[a._v("UNIQUE KEY unique_key (column1, column2) 夹在创建表里面\nUNIQUE key 单个唯一约束\nUNIQUE key(...,...) 复核唯一约束  会自动添加索引\n")])])]),t("h4",{attrs:{id:"删除约束"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除约束"}},[a._v("#")]),a._v(" 删除约束")]),a._v(" "),t("div",{staticClass:"language-plain extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plain"}},[t("code",[a._v("删除唯一索引，删除指定唯一索引名\n单列就是列名，多列可以是第一个字段名\nALTER TABLE USER DROP INDEX uk_name_pwd\n// 查看表索引\nshow index from 表名称\n")])])]),t("h4",{attrs:{id:"主键约束"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#主键约束"}},[a._v("#")]),a._v(" 主键约束")]),a._v(" "),t("div",{staticClass:"language-plain extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plain"}},[t("code",[a._v("primary key 标识表中的一条记录  唯一加非空\n一个表只能有一个主键约束\n主键名 primary\nprimary key  (column1, column2) 要求均不为空NULL\nALTER TABLE 表名\tADD primary key （字段名）\nALTER TABLE 表名 DROP primary key  删除主键\n")])])]),t("h4",{attrs:{id:"自增列-auto-increment"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自增列-auto-increment"}},[a._v("#")]),a._v(" 自增列 AUTO_INCREMENT")]),a._v(" "),t("div",{staticClass:"language-plain extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plain"}},[t("code",[a._v("一个表里面只能有一个自增长列\n必须是整型的\n列必须有主键约束或者唯一约束\n当我们向主键的字段，添加0或者null 会自动往上添加\n\nALTER TABLE 表名 modify 主键名 主键类型 AUTO_INCREMENT\n// 删除\nALTER TABLE 表名 modify 主键名 主键类 \nMYSQL 5.7 \nAUTO_INCREMENT 内存中维护一个值 重启就会重新计算\n\nMYSQL 8.0\n自增主键的持久化到重做日志中，每次计数器变化都会写入重做日志， redo日志读取记录\n")])])]),t("h4",{attrs:{id:"foreign-key-约束"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#foreign-key-约束"}},[a._v("#")]),a._v(" FOREIGN KEY 约束")]),a._v(" "),t("p",[a._v("限制某个表的某个字段的引用完整性")]),a._v(" "),t("div",{staticClass:"language-plain extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plain"}},[t("code",[a._v("关联字段在主表，必须有主键约束或者唯一约束\n默认不是列名，自动生成的\n创建 先主后从\n删除 先从后主\n名可以不一样，数据类型要一样\n外键约束也会建索引，只不过是普通索引\n删除约束，要手动删除索引\n// 表级约束\nCONSTRAINT 约束名 FOREIGN KEY （字段名） REFERENCES 主表（主表字段）\nALTER TABLE 表名 ADD CONSTRAINT 约束名 FOREIGN KEY （字段名） REFERENCES 主表（主表字段）\n")])])]),t("h5",{attrs:{id:"约束等级"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#约束等级"}},[a._v("#")]),a._v(" 约束等级")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1708496049521-8e79cfec-a031-418b-8150-09bf1abe31c2.png",alt:""}})]),a._v(" "),t("div",{staticClass:"language-plain extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plain"}},[t("code",[a._v("ON UPDATE CASCADE ON DELETE SET NULL\n\n// 删除外键约束\nALTER TABLE 从表名 DROP FOREIGN KEY 外键的约束名\n// 删除外键索引\nALTER TABLE 从表名 DROP INDEX 外键的约束名\n")])])]),t("p",[a._v("外键约束有成本，因为外键约束的系统开销而变得非常慢")]),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("阿里开发规范")])],1),a._v(" "),t("p",[a._v("不得使用外键和级联，一切外键必须在应用层面去解决")]),a._v(" "),t("p",[a._v("外键 适合单机，低并发")]),a._v(" "),t("p",[a._v("不适合 分布式和高并发集群 级联更新强阻塞，更新风暴，影响插入速度")]),a._v(" "),t("h4",{attrs:{id:"check-约束-5-7不支持"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#check-约束-5-7不支持"}},[a._v("#")]),a._v(" CHECK 约束  5.7不支持")]),a._v(" "),t("p",[a._v("检查某个字段的值，是符合要求")]),a._v(" "),t("div",{staticClass:"language-plain extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plain"}},[t("code",[a._v("check(salary > 2000)\n")])])]),t("h4",{attrs:{id:"default-约束"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#default-约束"}},[a._v("#")]),a._v(" DEFAULT 约束")]),a._v(" "),t("p",[a._v("默认值")]),a._v(" "),t("h2",{attrs:{id:"面试题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#面试题"}},[a._v("#")]),a._v(" 面试题")]),a._v(" "),t("ol",[t("li",[a._v("not null default  '' 或 default 0  不想让表中出现默认值")]),a._v(" "),t("li",[a._v("效率不高，影响提高索引的效果。")]),a._v(" "),t("li",[a._v("AUTO_INCREMENT跟第一条有关")]),a._v(" "),t("li",[a._v("外键约束不能跨引擎使用")])]),a._v(" "),t("h2",{attrs:{id:"数据库对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据库对象"}},[a._v("#")]),a._v(" 数据库对象")]),a._v(" "),t("ol",[t("li",[a._v("数据字典：系统表，存放数据库信息的表")]),a._v(" "),t("li",[a._v("存储过程，没有返回值")]),a._v(" "),t("li",[a._v("存储函数，有返回值，用户自定义")]),a._v(" "),t("li",[a._v("触发器，事件的监听器，比如数据备份")])]),a._v(" "),t("h2",{attrs:{id:"视图-虚拟表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#视图-虚拟表"}},[a._v("#")]),a._v(" 视图（虚拟表）")]),a._v(" "),t("p",[a._v("更改视图，原表中的数据也会更改，创建视图的根据表叫"),t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("基表")])],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"#000000"}},[a._v("存储起来的select 语句")])],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"#000000"}},[a._v("小型项目 不推荐使用   控制数据访问")])],1),a._v(" "),t("div",{staticClass:"language-plain extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plain"}},[t("code",[a._v("create view 视图名 as select 语句\nshow tables;// 查看表和视图\ndesc 视图名\nshow table status like '视图名'\nshow create view vu_emp1\n// 删除\ndrop view 视图名\n")])])]),t("p",[a._v("可以利用视图对数据进行格式化")]),a._v(" "),t("p",[a._v("不能更新视图里面带聚合函数的字段")]),a._v(" "),t("p",[a._v("只有存在1对1的关系的数据才能更新")]),a._v(" "),t("p",[a._v("看表约束")]),a._v(" "),t("p",[a._v("JOIN 了  不支持delete ，insert")]),a._v(" "),t("p",[a._v("主要是方便查询使用的，不建议更新，有可能会失败")]),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("操作简单")])],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("减少数据冗余")])],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("数据安全")])],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("灵活多变的需求")])],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("分解复杂的查询逻辑")])],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("视图和表息息相关，需要维护，可读性不好")])],1),a._v(" "),t("h2",{attrs:{id:"触发器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#触发器"}},[a._v("#")]),a._v(" 触发器")]),a._v(" "),t("ol",[t("li",[a._v("原子性 创建一个触发器，商品信息插入自动触发插入库存数据插入")]),a._v(" "),t("li",[a._v("5.0 支持触发器  由事件（行为）触发  增删改 触发")])]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TRIGGER")]),a._v(" 触发器名称\n{BEFORE "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("AFTER")]),a._v(" }{"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INSERT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("UPDATE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DELETE")]),a._v(" } "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ON")]),a._v(" 表面\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FOR EACH ROW")]),a._v("\n触发器执行语句柄\n单条"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("多条  都可以  复合语句块"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BEGIN")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("END")]),a._v("\n")])])]),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[a._v("NEW 关键字  新插入的数据\nSIGNAL SQLSTATE "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'HY000'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" MESSAGE_TEXT "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'报错信息'")]),a._v("\nOLD 关键字 老数据\n")])])]),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SHOW")]),a._v(" TRIGGERS"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SHOW")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TRIGGER")]),a._v(" 触发器名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("SELECT * FROM information_schema.TRIGGERS\n")])])]),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("DROP TRIGGER IF EXISTS 触发器名\n")])])]),t("h3",{attrs:{id:"优点-数据完整性-记录日志-数据合法性进行校验"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#优点-数据完整性-记录日志-数据合法性进行校验"}},[a._v("#")]),a._v(" 优点：数据完整性，记录日志，数据合法性进行校验")]),a._v(" "),t("h3",{attrs:{id:"缺点-可读性差-相关数据的变更可能会导致出错"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#缺点-可读性差-相关数据的变更可能会导致出错"}},[a._v("#")]),a._v(" 缺点：可读性差，相关数据的变更可能会导致出错")]),a._v(" "),t("p",[a._v("外键不会触发触发器，比如删除父亲，影响儿子")]),a._v(" "),t("h2",{attrs:{id:"存储过程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#存储过程"}},[a._v("#")]),a._v(" 存储过程")]),a._v(" "),t("ol",[t("li",[a._v("参数类型  IN  参数 OUT  返回  INOUT")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("CREATE PROCEDURE 存储过程名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("IN "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" OUT "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" INOUT 参数名  参数类型"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("characteristics"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" \nBEGIN  一条可以省略\n\n\nEND\n")])])]),t("p",[a._v("characteristics")]),a._v(" "),t("ol",[t("li",[a._v("LANGUAGE SQL   执行体是SQL")]),a._v(" "),t("li",[a._v("NOT  DETRMINISTIC 是否确定执行的结果  随机数")]),a._v(" "),t("li",[a._v("CONTAINS SQL  包含SQL    NO SQL 没有SQL   READS SQL DATA  包含读数据的SQL    MODIFIES  SQL DATA  包含写数据的SQL")]),a._v(" "),t("li",[a._v("SQL SECURITY  {DEFINER | INVOKER}  DEFINER 默认有访问权限的用户可以用  INVOKER 创建者和定义者可以用")]),a._v(" "),t("li",[a._v("COMMENT 'String'    注释信息")])]),a._v(" "),t("p",[a._v("DELIMITER  指定什么什么结束  $")]),a._v(" "),t("p",[a._v("DELIMITER ;  改回去")]),a._v(" "),t("h3",{attrs:{id:"优点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#优点"}},[a._v("#")]),a._v(" 优点")]),a._v(" "),t("ol",[t("li",[a._v("存储过程可以一次编译多次使用")]),a._v(" "),t("li",[a._v("可以减少开发工作量")]),a._v(" "),t("li",[a._v("连接一次即可，良好的封装性")]),a._v(" "),t("li",[a._v("安全性比较强")]),a._v(" "),t("li",[a._v("可以减少网络的数据传输量")])]),a._v(" "),t("h3",{attrs:{id:"缺点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#缺点"}},[a._v("#")]),a._v(" 缺点")]),a._v(" "),t("ol",[t("li",[a._v("可移植性差 不能跨库移植")]),a._v(" "),t("li",[a._v("调试困难")]),a._v(" "),t("li",[a._v("存储过程的版本管理很困难")]),a._v(" "),t("li",[a._v("它不适合高并发的场景")])]),a._v(" "),t("h2",{attrs:{id:"创建存储过程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建存储过程"}},[a._v("#")]),a._v(" 创建存储过程")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v(" CREATE DATABASE dbtest15"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n USE dbtest15"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n CREATE TABLE employees\n AS \n SELECT *\n FROM atguigugb."),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("employees"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n\n  CREATE TABLE departments\n AS \n SELECT *\n FROM atguigugb."),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("departments"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n")])])]),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DELIMITER")]),a._v("  $\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("PROCEDURE")]),a._v(" select_all_data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BEGIN")]),a._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" employees"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("END")]),a._v(" $\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DELIMITER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("调用  CALL select_all_data()")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DELIMITER")]),a._v("  $\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("PROCEDURE")]),a._v(" avg_employee_salary"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BEGIN")]),a._v(" \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("AVG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("salary"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" employees"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("END")]),a._v(" $\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DELIMITER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DELIMITER")]),a._v("  $\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("PROCEDURE")]),a._v(" show_min_salary"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("OUT")]),a._v(" ms   "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DOUBLE")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BEGIN")]),a._v(" \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("MIN")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("salary"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INTO")]),a._v(" ms\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" employees"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("END")]),a._v(" $\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DELIMITER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CALL")]),a._v(" show_min_salary"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@ms")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@ms")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DELIMITER")]),a._v("  $\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("PROCEDURE")]),a._v(" show_someone_salary"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("IN")]),a._v(" empname "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("VARCHAR")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("20")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BEGIN")]),a._v(" \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" salary\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" employees\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("WHERE")]),a._v(" last_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" empname"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("END")]),a._v(" $\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DELIMITER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CALL")]),a._v(" show_someone_salary"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Abel'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@empname")]),a._v(" :"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Abel'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CALL")]),a._v(" show_someone_salary"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@empname")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("@@系统变量       @ 用户自定义变量     :=  赋值符号")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DELIMITER")]),a._v("  $\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("PROCEDURE")]),a._v(" show_someone_salary2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("IN")]),a._v(" empname "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("VARCHAR")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("20")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("OUT")]),a._v(" empsalary "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("decimal")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BEGIN")]),a._v(" \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" salary "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INTO")]),a._v(" empsalary\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" employees\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("WHERE")]),a._v(" last_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" empname"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("END")]),a._v(" $\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DELIMITER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@empname")]),a._v(" :"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Abel'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CALL")]),a._v(" show_someone_salary2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@empname")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@empsalary")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@empsalary")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("INOUT empname VARCHAR(25)   先后改变变量的值")]),a._v(" "),t("p",[a._v("调试非常麻烦，逐步排错。")]),a._v(" "),t("h2",{attrs:{id:"存储函数的使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#存储函数的使用"}},[a._v("#")]),a._v(" 存储函数的使用")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("CREATE FUNCTION 函数名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("参数名 参数类型"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nRETURNS 返回值类型\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("characteristics"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" \nBEGIN\n\n函数体 肯定有return 语句\n\nEND\n\nSEKECT 函数名（参数列表）\n")])])]),t("p",[a._v("只有IN类型 （可省略不写）")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("DELIMITER  $\nCREATE FUNCTION email_by_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nRETURNS VARCHAR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("25")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nDETERMINISTIC\nCONTAINS SQL\nREADS SQL DATA\nBEGIN\n\nRETURN"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("SELECT email FROM employees WHERE last_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Abel'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\nEND $\n\nDELIMITER "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("特性不加会报错")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("SET GLOBAL log_bin_trust_function_creators "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1709613629090-471f8775-591a-4835-aa85-1311c1230134.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"存储过程和函数的查看、修改、删除"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#存储过程和函数的查看、修改、删除"}},[a._v("#")]),a._v(" 存储过程和函数的查看、修改、删除")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("SHOW CREATE PROCEDURE 存储过程名\nSHOW CREATE FUNCTION 函数名\n\n// 查看存储过程/函数的状态  \nSHOW PROCEDURE STATUS "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("LIKE "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'show_max_salary'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\nSHOW FUNCTION STATUS "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("LIKE "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'show_max_salary'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\n// 从information_schema.Routines表中查看存储过程和函数信息\nSELECT * FROM information_schema.Routines\nWHERE ROUTINE_NAME "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'存储过程或者函数名'")]),a._v(" AND ROUTINE_TYPE "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'FUNCTION'")]),a._v(" // FUNCTION 区分大小写\n")])])]),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("ALTER FUNCTION"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("PROCEDURE 存储过程或者函数名 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("characteristics"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])])]),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("DROP FUNCTION IF EXISTS 函数名\nDROP PROCEDURE IF EXISTS 函数名\n")])])]),t("ol",[t("li",[a._v("INTO  后面不要加括号 逗号拼接")]),a._v(" "),t("li",[a._v("date_diff  相隔天数")]),a._v(" "),t("li",[a._v("SET 给变量赋值")])]),a._v(" "),t("h2",{attrs:{id:"变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#变量"}},[a._v("#")]),a._v(" 变量")]),a._v(" "),t("p",[a._v("存储查询或计算的中间结果，或者输出最终的结果数据。")]),a._v(" "),t("p",[a._v("系统变量和用户自定义变量")]),a._v(" "),t("h3",{attrs:{id:"系统变量-重启失效"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#系统变量-重启失效"}},[a._v("#")]),a._v(" 系统变量(重启失效)")]),a._v(" "),t("p",[a._v("服务器，编译MySQL时参数，配置文件")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("查看系统变量"),t("OutboundLink")],1)]),a._v(" "),t("p",[a._v("全局 global   max_connections 最大连接数")]),a._v(" "),t("p",[a._v("会话 session  默认")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1709776572883-a26b7caa-239d-4260-88d1-c12c7125448b.png",alt:""}})]),a._v(" "),t("p",[a._v("character_set_client  设置字符集  变量的作用域只能时会话级别的还是全局级别的")]),a._v(" "),t("p",[a._v("pseudo_thread_id  标记当前会话的Mysql连接id")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("// 查看所有或部分系统变量\nSHOW GLOBAL VARIABLES"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n// 查看会话系统变量\nSHOW "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("SESSION")]),a._v(" VARIABLES"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" 或者 SHOW VARIABLES"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\nSHOW GLOBAL VARIABLES LIKE "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("''")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\nSHOW GLOBAL "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("SESSION")]),a._v(" LIKE "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("''")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n// 查看指定的全局系统变量\nSELECT @@global.max_connections"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n// 查看指定的会话系统变量\nSELECT @@session.max_connections"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n// 修改系统变量  配置文件my.ini   \nSET @@global.max_connections "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("161")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("//重启失效\nSET GLOBAL max_connections "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("171")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n// 会话系统变量\nSET @@session.character_set_client "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'gbk'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nSET "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("SESSION")]),a._v(" character_set_client "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'gbk'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("h3",{attrs:{id:"用户变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用户变量"}},[a._v("#")]),a._v(" 用户变量")]),a._v(" "),t("p",[a._v("会话用户变量和局部变量")]),a._v(" "),t("ul",[t("li",[a._v("会话用户变量  当前连接生效  @ 开头")]),a._v(" "),t("li",[a._v("局部变量        存储过程和函数")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("// 定义和赋值\nSET @用户变量 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" 值"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nSET @用户变量 ："),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" 值"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nSELECT @用户变量 :"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" 表达式"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("FROM 等子句"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\nSELECT 表达式 INTO @用户变量 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("FROM 等子句"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\n// 查看\nSELECT @用户变量"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n// 局部变量 定义 DECLARE 声名 DECLARE 必须在BEGIN 中的首行,顺序往下排\nDECLARE 变量名 类型 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("default值"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" 可以合并\nDECLARE a,b INT DEFAULT "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n// 使用差不多\nSET 变量名 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" 值"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nSET 变量名 ："),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" 值"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n \nSELECT 表达式 INTO 变量名 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("FROM 等子句"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\n// 使用\nSELECT a,b,c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1709880343026-477058ac-f7e1-4af7-bfcd-4aa9efb04443.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"程序出错的处理机制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#程序出错的处理机制"}},[a._v("#")]),a._v(" 程序出错的处理机制")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1710816698802-6d4bc893-d097-4cdc-a26a-e4c683c1a961.png",alt:""}})]),a._v(" "),t("p",[a._v("1048 是MySQL_error_code   数值类型错误码")]),a._v(" "),t("p",[a._v("23000 是sqlstate_value 是长度为5的字符串类型错误代码")]),a._v(" "),t("div",{staticClass:"language-yaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[a._v("DECLARE 错误名称 CONDITION FOR 错误码（错误条件）\nDECLARE Field_Not_Be_NULL CONDITION FOR 1048;\nDECLARE Field_Not_Be_NULL CONDITION FOR SQLSTATE '23000';\n")])])]),t("div",{staticClass:"language-yaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[a._v("DECLARE 处理方式 HANDLER FOR 错误类型 处理语句\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1710817987972-766a231e-23e1-4fc3-ab8f-d96d53aad5de.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"条件判断语句"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#条件判断语句"}},[a._v("#")]),a._v(" 条件判断语句")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("IF 表达式1 THEN 操作1\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("ELSEIF 表达式2 THEN 操作2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("ELSE 操作N"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" 这个可以没有\nEND IF\n")])])]),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("CASE 表达式\nWHEN 值1 THEN 结果1或语句1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("如果是语句需要加分号"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nWHEN 值2 THEN 结果2或语句2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("如果是语句需要加分号"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\nELSE  结果n或语句n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("如果是语句需要加分号"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nEND "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("case"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("如果是放在begin end中需要加上case，如果放在select后面不需要"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("CASE 表达式\nWHEN 条件1 THEN 结果1或语句1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("如果是语句需要加分号"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nWHEN 条件2 THEN 结果2或语句2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("如果是语句需要加分号"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\nELSE  结果n或语句n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("如果是语句需要加分号"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nEND "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("case"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("如果是放在begin end中需要加上case，如果放在select后面不需要"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# LEAVE 跳出循环 [标签名]")]),a._v("\n标签名 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("LOOP")]),a._v(" \n循环执行的语句\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("END")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("LOOP")]),a._v(" 标签名\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("call")]),a._v(" 存储函数名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("@参数名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[a._v("标签名 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("WHILE")]),a._v(" 循环条件 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DO")]),a._v("\n循环执行的语句\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("END")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("WHILE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("标签名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.")]),a._v(" 初始化条件\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2.")]),a._v(" 循环条件\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3.")]),a._v(" 循环体\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("4.")]),a._v(" 迭代条件\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DROP")]),a._v(" 存储过程名 后面没有括号\n\n循环条件 "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("TRUE")]),a._v(" 不做限制\n")])])]),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[a._v("标签名 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REPEAT")]),a._v(" \n循环执行的语句\nUNTIL 结束循环的条件表达式\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("END")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REPEAT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("标签名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\n类似"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("while")]),a._v(" 先执行一次  至少执行一次\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1710949514702-68b95308-0525-437f-9a0e-deaecd93e929.png",alt:""}})]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("LEAVE 标签名  \n相当于break\n")])])]),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("ITERATE 标签名\n相当于continue"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" \n")])])]),t("h2",{attrs:{id:"游标"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#游标"}},[a._v("#")]),a._v(" 游标")]),a._v(" "),t("p",[a._v("随意定位到某一条记录，面向过程的能力，指针，变量声明的后面")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("DECLARE 游标名 CURSOR FOR 查询语句\n")])])]),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("DECLARE 游标名 CURSOR IS 查询语句\n")])])]),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("OPEN 游标名\n")])])]),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("FETCH 游标名 INTO 变量名\n")])])]),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("CLOSE 游标名\n")])])]),t("p",[a._v("会加锁，消耗系统资源。")]),a._v(" "),t("h2",{attrs:{id:"mysql8-0-全局变量的持久化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql8-0-全局变量的持久化"}},[a._v("#")]),a._v(" MySQL8.0 全局变量的持久化")]),a._v(" "),t("p",[a._v("set persist 设置全局变量")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1711444372722-a23033b1-3e33-44a7-97a7-ad25d1630778.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"窗口函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#窗口函数"}},[a._v("#")]),a._v(" 窗口函数")]),a._v(" "),t("ol",[t("li",[a._v("更简单支持NoSQL,不依赖chema")]),a._v(" "),t("li",[a._v("隐藏索引/降序索引")]),a._v(" "),t("li",[a._v("JSON支持更完善 增加了聚合函数")]),a._v(" "),t("li",[a._v("安全和账户管理  sha2 插件")]),a._v(" "),t("li",[a._v("Innodb 优化")]),a._v(" "),t("li",[a._v("事务数据字典")]),a._v(" "),t("li",[a._v("原子数据定义语句")]),a._v(" "),t("li",[a._v("资源管理 分配合理")]),a._v(" "),t("li",[a._v("字符集 utf8mb4 之前是latin1")]),a._v(" "),t("li",[a._v("优化器增强")]),a._v(" "),t("li",[a._v("公用表表达式  替换子查询")]),a._v(" "),t("li",[a._v("窗口函数")]),a._v(" "),t("li",[a._v("正则表达式 优化")]),a._v(" "),t("li",[a._v("内部临时表")]),a._v(" "),t("li",[a._v("日志记录 过滤和写入")]),a._v(" "),t("li",[a._v("备份锁")]),a._v(" "),t("li",[a._v("增强Mysql复制  二进制节省空间")]),a._v(" "),t("li",[a._v("去掉查询缓存  命中率太低了")]),a._v(" "),t("li",[a._v("只保留 AES_ENCRYPT 和 AES_DECRYPT")]),a._v(" "),t("li",[a._v("\\N 不再是NULL")])]),a._v(" "),t("h2",{attrs:{id:"窗口函数-将结果置于每一条数据记录中"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#窗口函数-将结果置于每一条数据记录中"}},[a._v("#")]),a._v(" 窗口函数（将结果置于每一条数据记录中）")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1711696711952-3a779fa4-2348-49ea-91ca-3bd5004a09a1.png",alt:""}})]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TEMPORARY")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" 表名  后面是查询语句\n")])])]),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("分组统计，对每一天记录进行计算。   对分区数据进行统计和分析  不改变原来的数据")])],1),a._v(" "),t("ol",[t("li",[a._v("静态窗口：窗口大小固定，不会随着记录的不同而不同")]),a._v(" "),t("li",[a._v("动态窗口:  窗口大小不固定，随着记录的不同而不同")])]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[a._v("函数 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("OVER")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("PARTITION")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BY")]),a._v(" 字段名 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ORDER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BY")]),a._v(" 字段名 ASE"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DESC")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n函数 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("OVER")]),a._v(" 窗口名 WINDOW 窗口名 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("AS")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("PARTITION")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BY")]),a._v(" 字段名 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ORDER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BY")]),a._v(" 字段名 ASE"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DESC")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("  简洁写法\n")])])]),t("p",[a._v("OVER 窗口范围")]),a._v(" "),t("p",[a._v("PARTITION BY 分组字段 可以省略")]),a._v(" "),t("p",[a._v("ORDER BY  排序字段")]),a._v(" "),t("p",[a._v("FRAME 子句 定义规则，滑动窗口")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1711697480212-21807301-0f7e-41fc-af94-8cb572371013.png",alt:""}})]),a._v(" "),t("ul",[t("li",[a._v("ROW_NUMBER()  行号")]),a._v(" "),t("li",[a._v("RANK() 排序字段一样 行号则一样，跳过重复编号")]),a._v(" "),t("li",[a._v("DENSE_RANK() 排序字段一样 行号则一样，不跳过重复编号")]),a._v(" "),t("li",[a._v("PERCENT_RANK() 等级值百分比  rank-1/rows-1  rank 序号数  rows 总记录数")]),a._v(" "),t("li",[a._v("CUME_DIST()  函数  小于或者等于的比例")]),a._v(" "),t("li",[a._v("LAG（expr，n）前n个值   LAG（price，1）")]),a._v(" "),t("li",[a._v("LEAD（expr，n）后n行值")]),a._v(" "),t("li",[a._v("FIRST_VALUE(expr)  第一个值")]),a._v(" "),t("li",[a._v("lAST_VALUE(expr) 最后一个值")]),a._v(" "),t("li",[a._v("NTH_VALUE(expr)  指定第一个的值")]),a._v(" "),t("li",[a._v("NTILE（n）分几组  尽量均分，均分不了，前面多")])]),a._v(" "),t("h2",{attrs:{id:"公用表表达式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#公用表表达式"}},[a._v("#")]),a._v(" 公用表表达式")]),a._v(" "),t("p",[a._v("可以复用的子查询")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("WITH")]),a._v(" CTE名称\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("AS")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("子查询"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DELETE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("UPDATE")]),a._v(" 语句\n")])])]),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("WITH")]),a._v(" RECURSIVE\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("AS")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("子查询"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DELETE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("UPDATE")]),a._v(" 语句\n")])])]),t("p",[a._v("替代子查询，多次被引用")]),a._v(" "),t("h2",{attrs:{id:"mysql优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql优化"}},[a._v("#")]),a._v(" mysql优化")]),a._v(" "),t("h2",{attrs:{id:"suo-yisuoyi克隆虚拟机"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#suo-yisuoyi克隆虚拟机"}},[a._v("#")]),a._v(" suo'yisuoyi克隆虚拟机")]),a._v(" "),t("ol",[t("li",[a._v("修改mac地址  右键虚拟机，找到mac地址点生成")]),a._v(" "),t("li",[a._v("主机名")])]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[a._v("vim "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("etc"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("hostname\nreboot "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 重启虚拟机")]),a._v("\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[a._v("ip地址  动态ip 不需要修改")])]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[a._v("vim "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("etc"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("sysconfig"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("network"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("scripts"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("ifcfg"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("ens33\nsystemctl restart network\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1711951126435-414b6a4a-791b-4fc6-9e66-ca190ac4a2ed.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[a._v("UUID 调整")])]),a._v(" "),t("h2",{attrs:{id:"centos6-和-centos7-的区别"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#centos6-和-centos7-的区别"}},[a._v("#")]),a._v(" centos6 和 centos7 的区别")]),a._v(" "),t("ol",[t("li",[a._v("6是iptables   7是firewalld")]),a._v(" "),t("li",[a._v("启动服务 6是service   7是systemctl")])]),a._v(" "),t("h2",{attrs:{id:"mysql卸载的一些命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql卸载的一些命令"}},[a._v("#")]),a._v(" mysql卸载的一些命令")]),a._v(" "),t("p",[a._v("rpm安装")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[a._v("rpm "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("qa "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" grep "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("i mysql "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# -i 忽略大小写")]),a._v("\nsytemctl "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("status")]),a._v(" mysqld"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("service "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看运行状态")]),a._v("\nsytemctl stop mysqld"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("service "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 停止运行状态")]),a._v("\nyum remove 查看到的包名\nfind "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("name mysql "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 全局搜索mysql")]),a._v("\n最后删除etc下面的my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("cnf\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712051120057-0b915df7-af5d-4a8b-8a48-6b84bce3be56.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712051341148-6e61578e-3d3e-4f42-9498-cf08a1866a89.png",alt:""}}),a._v("\\")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712051432028-264f670a-485a-4b95-a167-14247236a23c.png",alt:""}}),a._v(" 有依赖顺序")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[a._v("rpm "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("ivh  i 是install  v 是提示信息  h "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("hash")]),a._v(" 进度条\n")])])]),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[a._v("cat "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("var"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("log"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("mysqld"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("log\nsystemctl "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("enable")]),a._v(" mysqld "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 开机自启")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("alter")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("user")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'root'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@'localhost'")]),a._v(" identified "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("by")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'abc123'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#8.0")]),a._v("\n")])])]),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ALTER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("USER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'root'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@'%'")]),a._v(" INDENTIFIED "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("WITH")]),a._v(" mysql_native_password "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("By")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'新密码'")]),a._v("\n")])])]),t("p",[a._v("mysql8.0 校验密码插件")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[a._v("install plugin validate_password "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SONAME")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'validate_password.so'")]),a._v("\n")])])]),t("h2",{attrs:{id:"字符集-charset"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#字符集-charset"}},[a._v("#")]),a._v(" 字符集（CHARSET）")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" variables "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("like")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%character%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\ncharacter_set_server"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("utf8  "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 设置字符集 在my.cnf")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("create")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("table")]),a._v(" 表名\n表的字符集都和数据库保持一致\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("alter")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("database")]),a._v(" dbtest1 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("character")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'utf8'")]),a._v("   数据库字符集修改\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("alter")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("table")]),a._v(" 表名 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("convert")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("to")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("character")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'utf8'")]),a._v("  表字符集修改\n保证数据是可改的\n")])])]),t("ol",[t("li",[a._v("服务器级别")]),a._v(" "),t("li",[a._v("数据库级别")]),a._v(" "),t("li",[a._v("表级别")]),a._v(" "),t("li",[a._v("列级别")])]),a._v(" "),t("p",[a._v("uft8 3个字节   utf8mb4  4个字节")]),a._v(" "),t("h2",{attrs:{id:"比较规则-collate"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#比较规则-collate"}},[a._v("#")]),a._v(" 比较规则（COLLATE）")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SHOW")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CHARSET")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("比较大小，排序操作")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712218783325-2f1f6715-22b5-48dd-890c-718ab0e6ff13.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712218834947-6583fb64-c739-4e95-8e27-8e1ecb2edf0c.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712219064419-051af4b5-da5f-4610-8678-3957c54f4e9e.png",alt:""}})]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("table")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("status")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("from")]),a._v(" 表名 \n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712219307702-55fe04e1-0e8c-4794-be39-99dc52d50b3a.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712219419101-0d1d577b-8b29-450d-b34f-96687310d2a3.png",alt:""}})]),a._v(" "),t("p",[a._v("只要保证发送的和client 一样   返回的和results 一样就行")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" names utf8"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 三个都设置成一样的")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("client"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("default")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("character")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("utf8 "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 配置文件里面")]),a._v("\n")])])]),t("h2",{attrs:{id:"sql大小写规范"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sql大小写规范"}},[a._v("#")]),a._v(" SQL大小写规范")]),a._v(" "),t("p",[a._v("windows系统默认大小写不敏感")]),a._v(" "),t("p",[a._v("linux系统默认大小写敏感")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" variables "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("like")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%lower_case_table_name%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" 大小写敏感  "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("大小写不敏感   "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" 只有查找是小写\n")])])]),t("ol",[t("li",[a._v("数据库名，表名，表的别名，变量名区分")]),a._v(" "),t("li",[a._v("关键字和函数不区分")]),a._v(" "),t("li",[a._v("列和列的别名不区分")])]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[a._v("lower_case_table_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n")])])]),t("p",[a._v("mysql 8 要先删除数据/var/lib/mysql")]),a._v(" "),t("h3",{attrs:{id:"建议"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#建议"}},[a._v("#")]),a._v(" 建议")]),a._v(" "),t("ol",[t("li",[a._v("关键字，函数名大写")]),a._v(" "),t("li",[a._v("数据库名，表名，表别名，字段名，字段别名小写")]),a._v(" "),t("li",[a._v("SQL语句分号结束")])]),a._v(" "),t("h2",{attrs:{id:"sql-mode-合理设置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sql-mode-合理设置"}},[a._v("#")]),a._v(" sql_mode 合理设置")]),a._v(" "),t("p",[a._v("sql语法，数据验证检查")]),a._v(" "),t("p",[a._v("5.7 宽松模式")]),a._v(" "),t("p",[a._v("8.0 严格模式 不允许零日期 0000-00-00 00:00:00")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),a._v(" @"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@session.sql_mode")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SESSION")]),a._v(" sql_mode "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("''")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 清空")]),a._v("\n\n")])])]),t("p",[a._v("临时设置和永久设置   在my.ini")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[a._v("sql_mode"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("ONLY_FULL_GROUP_BY"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("STRICT_TRANS_TABLES"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("NO_ZERO_IN_DATE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("NO_ZERO_DATE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("ERROR_FOR_DIVISION_BY_ZERO"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("NO_ENGINE_SUBSTITUTION\n")])])]),t("h2",{attrs:{id:"mysql数据目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql数据目录"}},[a._v("#")]),a._v(" MYSQL数据目录")]),a._v(" "),t("p",[a._v("表ibd 格式")]),a._v(" "),t("p",[a._v("bin目录 可执行文件")]),a._v(" "),t("p",[a._v("linux 下不一样")]),a._v(" "),t("ol",[t("li",[a._v("数据目录  /var/lib/mysql")])]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" variables "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("like")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'datadir'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[a._v("相关命令 /usr/bin 或者 /usr/sbin  客户端程序和服务端程序的命令")]),a._v(" "),t("li",[a._v("配置文件 /usr/share/mysql-8.0 或 /etc/my.cnf")]),a._v(" "),t("li",[a._v("存储引擎 把表存在磁盘上")])]),a._v(" "),t("h3",{attrs:{id:"默认数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#默认数据库"}},[a._v("#")]),a._v(" 默认数据库")]),a._v(" "),t("ol",[t("li",[a._v("mysql 用户账户和权限信息")]),a._v(" "),t("li",[a._v("information_schema  维护其他数据库的信息  表，视图，触发器，列，索引")]),a._v(" "),t("li",[a._v("performance_schema 服务的各类性能指标")]),a._v(" "),t("li",[a._v("sys 监控mysql性能，视图描述")])]),a._v(" "),t("h3",{attrs:{id:"_5-5-7-5-6-8-表数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-5-7-5-6-8-表数据"}},[a._v("#")]),a._v(" 5.5.7~5.6.8 表数据")]),a._v(" "),t("ol",[t("li",[a._v("ibdata1 系统表空间  或者 ibd 独立表空间")]),a._v(" "),t("li",[a._v("db.opt 是字符集或者关联关系   frm 表结构信息")])]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\ninnodb_file_per_table"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("系统表空间  "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" 独立表空间\n")])])]),t("h3",{attrs:{id:"_8-0-表数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-0-表数据"}},[a._v("#")]),a._v(" 8.0 表数据")]),a._v(" "),t("ol",[t("li",[a._v("表结构和表数据合一  只有ibd 方便关联")])]),a._v(" "),t("p",[a._v("证明：ibd2sdi 工具")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[a._v("ibd2sdi "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("--dump-file=文件.txt 文件.ibd")]),a._v("\n")])])]),t("p",[a._v("视图只有frm")]),a._v(" "),t("h3",{attrs:{id:"_5-7-myisam"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-7-myisam"}},[a._v("#")]),a._v(" 5.7 MyISAM")]),a._v(" "),t("ol",[t("li",[a._v("frm  MYD MYI  数据和索引分开存储")])]),a._v(" "),t("h3",{attrs:{id:"_8-0-myisam"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-0-myisam"}},[a._v("#")]),a._v(" 8.0 MyISAM")]),a._v(" "),t("ol",[t("li",[a._v("sdi MYD MYI  数据和索引分开存储")])]),a._v(" "),t("h2",{attrs:{id:"用户与权限关联"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用户与权限关联"}},[a._v("#")]),a._v(" 用户与权限关联")]),a._v(" "),t("p",[a._v("root用户创建普通用户，保证安全性。")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[a._v("mysql "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("h 主机地址 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("P "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("p 密码 数据库 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("e "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"sql语句"')]),a._v("\n")])])]),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("create")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("user")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'用户名'")]),a._v(" identified "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("by")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'密码'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("user")]),a._v(" 和 host 作为联合主键\n权限有限\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("update")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("user")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("user")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'用户名'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("where")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("user")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'用户名'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nflush "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("privileges")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("drop")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("user")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'用户名'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 不需要flush")]),a._v("\n@ 用于指定host的用户\n不推荐使用"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("delete")]),a._v("，容易有残留\n")])])]),t("h2",{attrs:{id:"密码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#密码"}},[a._v("#")]),a._v(" 密码")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" PASSWORD "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" PASSWORD"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'123456'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 8.0 不支持")]),a._v("\n")])])]),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("alter")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("user")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("user")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" identified "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("by")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'新密码'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" PASSWORD "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'新密码'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("alter")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("user")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'用户名'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@'host'")]),a._v(" identified "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("by")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'新密码'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# DDL操作")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" PASSWORD "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FOR")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'用户名'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@'host'")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'新密码'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("8.0")]),a._v(" "),t("ol",[t("li",[a._v("密码过期")])]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ALTER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("USER")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("user")]),a._v(" PASSWORD EXPIRE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 过期能登录，不能查询")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 配置文件")]),a._v("\ndefault_password_lifetime "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("  不过期  N单位天\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712477060525-9ae30b68-2a65-4ed6-9078-f71f24e3b4ac.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[a._v("密码重用设置")])]),a._v(" "),t("p",[a._v("数量和时间指定")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" PERSIST password_history "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 6次")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" PERSIST password_reuse_interval "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("365")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("  一年\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[a._v("密码强度评估")])]),a._v(" "),t("h2",{attrs:{id:"权限管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#权限管理"}},[a._v("#")]),a._v(" 权限管理")]),a._v(" "),t("p",[a._v("分内的事  创建的用户没有给别人赋予权限的能力 如需要 添加WITH GRANT OPTION")]),a._v(" "),t("p",[a._v("权限：表，列，过程")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712477453001-b1ecb9a5-1541-4de8-b019-dafa9891bb56.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712477472382-b489f173-bc93-48b9-bdb2-bc7330c0d55d.png",alt:""}})]),a._v(" "),t("p",[a._v("授予权限2种")]),a._v(" "),t("ol",[t("li",[a._v("授予角色权限，再授予角色")]),a._v(" "),t("li",[a._v("直接授予用户")])]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("grant")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("update")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("on")]),a._v(" 数据库名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("to")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'用户名'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@'host'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("grant")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("delete")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("on")]),a._v(" 数据库名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("to")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'用户名'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@'host'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" 权限叠加\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("grant")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("all")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("privileges")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("on")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("to")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'用户名'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@'host'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 所有权限")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" grants"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" grants "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'用户名'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@'host'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REVOKE")]),a._v(" 权限 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ON")]),a._v(" 数据库名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'用户名'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@'host'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("横向 能看见哪个表")]),a._v(" "),t("p",[a._v("纵向  能操作哪个表")]),a._v(" "),t("h3",{attrs:{id:"权限表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#权限表"}},[a._v("#")]),a._v(" 权限表")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712541703043-aff9074c-6686-47c9-91d4-4f6555e6ec0c.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712541824684-a2a4f6c4-1eca-4f7c-90cc-073101d6ed14.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"角色管理-mysql8-0"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#角色管理-mysql8-0"}},[a._v("#")]),a._v(" 角色管理（mysql8.0）")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("create")]),a._v(" ROLE "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'角色名'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@'%'")]),a._v(" 默认为"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("GRANT")]),a._v(" 权限 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ON")]),a._v(" 数据库名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("to")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'角色名'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("GRANT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("all")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("privileges")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ON")]),a._v(" 数据库名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("to")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'角色名'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SHOW")]),a._v(" GRANTS "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'角色名'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REVOKE")]),a._v(" 权限 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ON")]),a._v(" 数据库名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'角色名'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DROP")]),a._v(" ROLE "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'角色名'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("GRANT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'角色名'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TO")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'用户名'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 需要激活")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" CURRENT_ROLE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("default")]),a._v(" role "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'角色名'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TO")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'用户名'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 激活 需要退出")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("GLOBAL")]),a._v(" activate_all_roles_on_login"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ON")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 设置所有角色登陆自动激活")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REVOKE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'角色名'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'用户名'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 回收角色，需要退出")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 强制角色 不能回收或者删除")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("mysqld"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\nmandatory_roles "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'角色名'")]),a._v("\n")])])]),t("h2",{attrs:{id:"配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置文件"}},[a._v("#")]),a._v(" 配置文件")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712559273296-f1f675aa-7239-40d5-a600-9beee2ef806a.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712559283785-8cc95848-f476-48f8-a2c8-89c9ec26d582.png",alt:""}})]),a._v(" "),t("p",[a._v("最后声明生效，如果配置一样，命令行大于启动命令")]),a._v(" "),t("h2",{attrs:{id:"逻辑架构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#逻辑架构"}},[a._v("#")]),a._v(" 逻辑架构")]),a._v(" "),t("ol",[t("li",[a._v("服务端程序使用mysqld")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712559667881-77d21c87-3e7f-4bab-a7a9-9a647decc2cb.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712560575732-de53e24b-9f31-4c97-8ce4-3ca5ff2011f6.png",alt:""}})]),a._v(" "),t("p",[a._v("连接池分TCP连接池和线程连接池，TCP连接池控制连接数，线程连接池用来做认证和授权，长连接模式复用TCP连接")]),a._v(" "),t("p",[a._v("解析器，生成语法树")]),a._v(" "),t("p",[a._v("优化器，生成执行计划，计算成本，选取，投影，连接")]),a._v(" "),t("p",[a._v("查询缓存，8.0去掉了")]),a._v(" "),t("p",[a._v("引擎，负责了mysql中的数据进行提取和存储，对物理服务器的底层进行操作。show engines；")]),a._v(" "),t("h2",{attrs:{id:"sql执行流程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sql执行流程"}},[a._v("#")]),a._v(" SQL执行流程")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712561444535-4eac1f70-61d9-4ebb-9519-b822e2c83bdc.png",alt:""}})]),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("查询缓存 ")]),a._v(" key-value 形式存于内存  鸡肋  命中率低  必须完全相同操作才能命中缓存。")],1),a._v(" "),t("ol",[t("li",[a._v("now函数不缓存")]),a._v(" "),t("li",[a._v("更新压力大，最好在静态表中，极少更新  query_cache_type=2  按需使用")]),a._v(" "),t("li",[a._v("SQL_NO_CACHE 不查询缓存")])]),a._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[a._v("show status like '"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Qcache")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")]),a._v("'"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712590057771-d576e789-a43a-413a-8fbe-6230ebde495c.png",alt:""}})]),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("解析器 ")]),a._v("  词法分析，语法分析")],1),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712590222921-ab0b394a-48d2-4d9a-b0b3-2d5839c08b75.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712590374023-458ad564-f58e-43f8-a933-a5721b9689e3.png",alt:""}})]),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("优化器  ")]),a._v(" 确定SQL语句的执行路径  全表检索   索引检索    选择最好的执行计划")],1),a._v(" "),t("p",[a._v("逻辑优化  等价变换")]),a._v(" "),t("p",[a._v("物理优化  索引 表连接方式")]),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("执行器 ")]),a._v("判断是否有权限   调用存储引擎API")],1),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712590792660-fbf594c4-05b4-455f-a090-a4f655b29511.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"执行原理-区别就是有没有查询缓存"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#执行原理-区别就是有没有查询缓存"}},[a._v("#")]),a._v(" 执行原理（区别就是有没有查询缓存）")]),a._v(" "),t("p",[a._v("开启profiling 默认不执行")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),a._v(" @"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@profiling")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" @"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@SESSION.profiling")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" profiling "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" profiles"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 全部的")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" profile profilefile"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 最近的")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" profile "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" query "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 指定某次")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" profile cpu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("block io "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" query "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 指定某次 cpu和iO的开销")]),a._v("\n")])])]),t("h2",{attrs:{id:"oracle-sql执行流程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#oracle-sql执行流程"}},[a._v("#")]),a._v(" oracle SQL执行流程")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712591981146-4b012563-392b-453a-9c86-09a237aa397d.png",alt:""}})]),a._v(" "),t("p",[a._v("缓存了执行计划，和mysql不一样，数据字典缓冲区，绑定变量来提高命中率，sql优化比较困难")]),a._v(" "),t("p",[a._v("Innodb存储引擎是以页为单位管理存储空间，占用内存来作为数据缓冲池，减少硬盘IO")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712592476661-1da7c885-4810-43e0-8b80-926f26f47ddf.png",alt:""}})]),a._v(" "),t("p",[a._v("会对频次高的热数据进行加载，每次都是完整的页加载，预定去多加载前后页")]),a._v(" "),t("h3",{attrs:{id:"缓冲池读取数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#缓冲池读取数据"}},[a._v("#")]),a._v(" 缓冲池读取数据")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712592618377-776cfdeb-e35a-4a57-acd6-3b83c7ac2f2c.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712592736695-bd29adfd-18e2-479e-9b50-283ecc319122.png",alt:""}})]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" variables "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("like")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'innodb_buffer_pool_size'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 8.0 查看缓存池大小")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("global")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("innodb")]),a._v(" innodb_buffer_pool_size "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("268435456")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 设置缓存池大小")]),a._v("\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712592962178-f4c71e86-b644-4460-b88a-9d7b0217912a.png",alt:""}})]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" variables "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("like")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'innodb_buffer_pool_instances'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 数据缓存池实例  多个人就会分区降低了性能")]),a._v("\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712593069291-3c779967-baa1-469b-98f3-5d3fa3872677.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712593130306-2d621faa-d594-4427-87d7-f4efb3308ddb.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712593308858-18fd318a-3db4-4d40-845f-2a45b1535971.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712593386248-add15b4f-8bbf-4e46-9404-5872753b25cf.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"存储引擎"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#存储引擎"}},[a._v("#")]),a._v(" 存储引擎")]),a._v(" "),t("p",[a._v("存储引擎就是指"),t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("表的类型")]),a._v("，表处理器，不同存储引擎，文件的结构不一样")],1),a._v(" "),t("p",[a._v("接收指令，对表的数据进行提取和写入")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" engines"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 支持的引擎   8.0 默认innodb  XA 分布式事务  Savepoints 保存点 部分事务回滚")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" @"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@default_storage_engine")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看默认的存储引擎  5.5 之后改成innodb  ")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" default_storage_engine"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("MyISAM"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 临时修改")]),a._v("\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712629420929-ce76c904-cf17-4592-9c03-691f5bafcf68.png",alt:""}}),a._v(" 修改配置文件")]),a._v(" "),t("p",[a._v("innodb 支持外键，支持事务，行级锁，崩溃恢复功能，适用于更新和删除 ，适用于巨大数据量，效率差一些，内存要求高，索引即数据，8.0都在ibd中")]),a._v(" "),t("p",[a._v("MyISAM 5.5 不支持外键，不支持事务，适用于新增和查询，适用于小数据量，表锁，数据统计有额外的常数存储，查询效率很高。")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712630880588-d48fd291-9f21-4dc2-984d-ef3b33f92ee9.png",alt:""}})]),a._v(" "),t("p",[a._v("阿里巴巴，淘宝 Xtradb   性能更好 替代了innodb")]),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("Archive")]),a._v(" 数据存档  插入之后不能修改，只能插入和查询，支持索引，行级锁。AUTO_INCREMENT,ZLib压缩库")],1),a._v(" "),t("p",[a._v(".ARZ文件"),t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("  历史记录的存储")])],1),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712641872539-601ef4d4-b477-45be-9d18-123acbc5945c.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712641881869-010a27e7-a133-46cb-8899-e7d68c391acc.png",alt:""}})]),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("BlackHole")]),a._v(" 引擎  丢弃写操作，读操作返回空，记录一个BlackHole表日志")],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("CSV")]),a._v(" 引擎  以逗号分割各个数据项  数据交换机制   .csv文件，excel和文本编辑器读取")],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("Memory ")]),a._v("引擎， 数据存储到内存里面，响应快，数据会丢失，长度要不可变，hash索引和B+树索引")],1),a._v(" "),t("p",[a._v("hash索引等值比较快，范围比较慢，表的大小受到限制，目标数据小，频繁访问。丢了也无所的数据。")]),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("Federated")]),a._v("引擎，访问远程表，默认是禁用的")],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("Merge")]),a._v("集合，管理多个MyISAM的表集合")],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("NDB")]),a._v("引擎，MySQL集群专用引擎，MySQL CLuster 分布式集群")],1),a._v(" "),t("h2",{attrs:{id:"索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#索引"}},[a._v("#")]),a._v(" 索引")]),a._v(" "),t("p",[a._v("目录，页码，快速定位，二叉树 log2为底n的对数，减少IO次数")]),a._v(" "),t("p",[a._v("数据结构  排好序的数据结构  跟存储引擎有关 innodb是b+树，索引最多16个，长度256字节")]),a._v(" "),t("ol",[t("li",[a._v("降低IO")]),a._v(" "),t("li",[a._v("数据的唯一性")]),a._v(" "),t("li",[a._v("加速表与表之间的连接")]),a._v(" "),t("li",[a._v("减少查询中分组和排序的时间")]),a._v(" "),t("li",[a._v("创建索引和维护索引耗费时间  数据量太大")]),a._v(" "),t("li",[a._v("占磁盘空间 存储在磁盘上")]),a._v(" "),t("li",[a._v("降低更新表的速度")])]),a._v(" "),t("p",[a._v("先删除索引，再更新，再创建索引  小技巧")]),a._v(" "),t("p",[a._v("数据存储的底层是"),t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("数据页")]),a._v("，默认大小16KB")],1),a._v(" "),t("ol",[t("li",[a._v("主键有序，二分法")]),a._v(" "),t("li",[a._v("其他列，最小记录开始依次遍历的单链表")]),a._v(" "),t("li",[a._v("多个页，从第一页双向链表   索引应运而生")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712678093510-9e5089fb-def5-41ac-bf64-dcefb5106b65.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712677997227-9cd183f4-f537-4571-b753-9f22800dd341.png",alt:""}})]),a._v(" "),t("p",[a._v("数据页之间是双向链表，伴随着记录移动，页分类，主键值递增")]),a._v(" "),t("p",[a._v("出现目录项  key是最小的主键值")]),a._v(" "),t("p",[a._v("目录页出现了 数据页  页目录出现了  数据页也有页目录 目的是使用二分法")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712678913064-a362643c-0f51-489a-9759-b0e48c0d7fb0.png",alt:""}})]),a._v(" "),t("p",[a._v("目录页也可以是多个  再生成上层目录页")]),a._v(" "),t("p",[a._v("B+树  叶子节点  根节点  非叶子节点  树的层次越低IO次数越少"),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712679627034-7f89d27c-63c4-42fa-93a1-2912ded9537a.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712679874496-9e4bb979-3c36-4f94-9bf8-04b7a8916b74.png",alt:""}})]),a._v(" "),t("p",[a._v("compact行格式")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712677678918-bc8011f8-7e19-4661-802b-d53e9ff39c89.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"聚簇索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#聚簇索引"}},[a._v("#")]),a._v(" 聚簇索引")]),a._v(" "),t("p",[a._v("针对于主键构建的b+树")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712763576475-232e0030-1f42-4c47-a27f-f8847bfa7d46.png",alt:""}})]),a._v(" "),t("p",[a._v("数据存储方式 叶子节点（完整的用户记录）  索引即数据，数据即索引  数据和索引是一个整体")]),a._v(" "),t("p",[a._v("页内 单项链表")]),a._v(" "),t("p",[a._v("页和页 之间双向链表")]),a._v(" "),t("p",[a._v("目录项记录的页 双向链表")]),a._v(" "),t("p",[a._v("不需要create index")]),a._v(" "),t("p",[a._v("数据访问快  排序查找和范围查找快省IO操作")]),a._v(" "),t("p",[a._v("主键是自增的 插入速度跟插入顺序有关  主键不可更新  二级索引需要访问两次索引查找")]),a._v(" "),t("p",[a._v("只能有一个聚簇索引     非空的唯一索引替代主键 隐藏列  选用有序的顺序id")]),a._v(" "),t("h2",{attrs:{id:"非聚簇索引-二级索引-辅助索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#非聚簇索引-二级索引-辅助索引"}},[a._v("#")]),a._v(" 非聚簇索引（二级索引/辅助索引）")]),a._v(" "),t("p",[a._v("针对于非主键构建的b+树   c2 加主键")]),a._v(" "),t("p",[a._v("可以有多个")]),a._v(" "),t("p",[a._v("找c3 回 聚簇索引 查找要进行回表")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712764129344-c80cb5df-0ee3-45b8-8f92-a4afca388f3c.png",alt:""}})]),a._v(" "),t("p",[a._v("非聚簇索引  更新/删除/新增 效率高  聚簇索引还需要维护"),t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("数据行的物理顺序")]),a._v("，而非聚簇索引只需要更改索引")],1),a._v(" "),t("p",[a._v("联合索引   两个字段进行索引 先c2再c3")]),a._v(" "),t("p",[a._v("注意事项")]),a._v(" "),t("ol",[t("li",[a._v("根页面的位置万年不变 从上往下   下沉")]),a._v(" "),t("li",[a._v("内节点中目录项记录是唯一的  二级索引内节点也保存了主键")]),a._v(" "),t("li",[a._v("一个数据页最少要存两个")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712765191761-1976817e-14be-477b-b460-53cbc76eef84.png",alt:""}})]),a._v(" "),t("p",[a._v("MyISAM 索引和数据分开存储  不排序   全是非聚簇索引   主键加数据记录地址")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712765455307-5a18672e-5f65-4a09-ae0b-8b79b5d8c565.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712765580981-e71c2880-defe-444c-a6d4-eeb586c2b8c5.png",alt:""}})]),a._v(" "),t("p",[a._v("主键不建议过长，会导致树过长   自增主键最好")]),a._v(" "),t("p",[a._v("缺点")]),a._v(" "),t("ol",[t("li",[a._v("空间上   16kb的数据页  存储空间大")]),a._v(" "),t("li",[a._v("时间上  增/删/改  记录移位，页分裂，页面回收  索引从小到大的顺序")])]),a._v(" "),t("p",[t("font",{staticStyle:{color:"rgb(51, 51, 51)"}},[a._v("InnoDB使用了多种策略来决定淘汰哪些页：")])],1),a._v(" "),t("ol",[t("li",[t("font",{staticStyle:{color:"rgb(51, 51, 51)"}},[a._v("LRU（最近最少使用）列表：InnoDB维护一个LRU列表，其中包含所有当前缓冲的页。最近使用的页在LRU列表的前端，而最少使用的页在列表的尾端。当空间不足时，将尾端页淘汰。")])],1),a._v(" "),t("li",[t("font",{staticStyle:{color:"rgb(51, 51, 51)"}},[a._v("页面脏页检查：在可用空间不足时，InnoDB还会检查LRU列表中的页面是否是脏页（已修改但未写入磁盘的页）。如果是脏页，则会优先进行检查点操作，将脏页写入磁盘，然后再进行页面淘汰。")])],1),a._v(" "),t("li",[t("font",{staticStyle:{color:"rgb(51, 51, 51)"}},[a._v("合并插入缓冲（Change Buffer）：对于非唯一索引页，如果插入或更新不会造成页的直写（直接将改动写入磁盘），可以使用合并插入缓冲区来减少I/O操作。")])],1),a._v(" "),t("li",[t("font",{staticStyle:{color:"rgb(51, 51, 51)"}},[a._v("自适应哈希索引：InnoDB还会利用自适应哈希索引来更快地访问频繁使用的页。")])],1)]),a._v(" "),t("p",[t("font",{staticStyle:{color:"rgb(51, 51, 51)"}},[a._v("如果遇到页面淘汰频繁或发生错误，可能需要调整InnoDB的缓冲池大小，优化工作负载，或考虑增加服务器的物理内存。")])],1),a._v(" "),t("h2",{attrs:{id:"数据结构的合理性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据结构的合理性"}},[a._v("#")]),a._v(" 数据结构的合理性")]),a._v(" "),t("p",[a._v("磁盘IO的操作次数")]),a._v(" "),t("h3",{attrs:{id:"全表遍历"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#全表遍历"}},[a._v("#")]),a._v(" 全表遍历")]),a._v(" "),t("p",[a._v("最差")]),a._v(" "),t("h3",{attrs:{id:"hash结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hash结构"}},[a._v("#")]),a._v(" Hash结构")]),a._v(" "),t("p",[a._v("相同的输入可以得到相同的输出")]),a._v(" "),t("p",[a._v("hashmap  操作是O1级别  key进行hash")]),a._v(" "),t("p",[a._v("从效率上是hash快")]),a._v(" "),t("p",[a._v("hash碰撞 产生链表")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712766730962-355d23e4-8fed-469d-8a01-78c99480a075.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712766865581-c0c8e500-3b4e-4c71-9bec-c3376ba045cc.png",alt:""}})]),a._v(" "),t("p",[a._v("Redis核心就是hash表")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712766966231-911fad13-b443-41d8-87c2-4fde7d301774.png",alt:""}})]),a._v(" "),t("p",[a._v("memory 等值查询用")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712767013646-9a5c1121-b8b7-4e58-8393-50e1cdc4d444.png",alt:""}})]),a._v(" "),t("p",[a._v("8.0 默认开启")]),a._v(" "),t("h3",{attrs:{id:"二叉搜索树"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二叉搜索树"}},[a._v("#")]),a._v(" 二叉搜索树")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712798154016-e74868bb-b695-4e7c-a979-820bc19cc099.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712798172021-4e425f39-52e7-42ca-ab99-10e189c6cdf5.png",alt:""}}),a._v("  不太理想")]),a._v(" "),t("h3",{attrs:{id:"avl树"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#avl树"}},[a._v("#")]),a._v(" AVL树")]),a._v(" "),t("p",[a._v("二叉平衡搜索树，它的左右两个树的高度差不会超过1，高度较高")]),a._v(" "),t("p",[a._v("M叉树  高度变小")]),a._v(" "),t("h3",{attrs:{id:"b-树"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#b-树"}},[a._v("#")]),a._v(" B-树")]),a._v(" "),t("p",[a._v("多路平衡查找树")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712798994558-f1ba5e76-23b9-46c8-9e13-682d313f388a.png",alt:""}})]),a._v(" "),t("p",[a._v("关键字和叶子节点的信息都放在磁盘块2")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712799877863-a54a5dba-0e06-4565-85b2-f8f2715bd52b.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712799923169-4d757ee4-dafe-427f-a264-6fb4bcd580af.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"b-树-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#b-树-2"}},[a._v("#")]),a._v(" B+树")]),a._v(" "),t("p",[a._v("多路搜索树   适合索引系统 mysql官网看见b树就是b+树")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712800320088-9d01021e-3f55-4938-b77b-2117ff4585e2.png",alt:""}})]),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("B+树的查询效率更稳定   b树不稳定")])],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("B+树的查询效率更高 B+树目录项的不存数据，更加矮胖，叉多")])],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("范围查找  B+树链表遍历 B树要树进行遍历")])],1),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712800626898-c43c442a-d0bc-4f06-8d94-fa45b018c645.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712800661664-6e908789-a2b8-4998-800c-47ddb43b3f6a.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712800892121-53546124-392d-4127-9cb2-203287d3926b.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712800958496-2227a46e-320e-4c4b-ad2e-9938d3e20690.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712801101414-4eed210d-4d87-4250-9403-80f25d3a95e9.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712801126960-e9ed7ec9-d04c-42a0-8a43-3f4346b4143e.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"r树"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#r树"}},[a._v("#")]),a._v(" R树")]),a._v(" "),t("p",[a._v("geometry 数据类型   空间  解决高维空间的搜索问题")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712801209890-3a685e39-08a0-4c57-ab30-0a826a287c07.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712801224995-9d076f8f-b3dd-4b0a-b697-ba4e46b6b679.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"innodb数据存储结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#innodb数据存储结构"}},[a._v("#")]),a._v(" InnoDB数据存储结构")]),a._v(" "),t("p",[a._v("索引是在存储引擎中的，存放格式不同  Memory 内存级别的 不用磁盘")]),a._v(" "),t("h3",{attrs:{id:"页"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#页"}},[a._v("#")]),a._v(" 页")]),a._v(" "),t("p",[a._v("默认大小16KB")]),a._v(" "),t("p",[a._v("在数据库，不论读一行，还是多行，都是将这些行所在的页进行加载，也就是说，数据库管理存储空间的基本单位是页(Page)，数据库IO操作的最小单位是页")]),a._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[a._v("show variables like '"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")]),a._v("innodb_page_size"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")]),a._v("'"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("不在物理结构上相连，页之间双向链表，数据页内容单向链表，每个数据页都会生成一个页目录，为了用二分法")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712891496424-150873fa-3246-4d15-aec9-7ce1fe77ebc3.png",alt:""}})]),a._v(" "),t("p",[a._v("一个区会分配64个连续的页,区是1M空间")]),a._v(" "),t("p",[a._v("段是数据库中的分配单位，不同类型的数据库对象以不同的段形式存在。")]),a._v(" "),t("p",[a._v("表空间是逻辑容器，系统表空间和独立表空间")]),a._v(" "),t("h4",{attrs:{id:"页的内部结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#页的内部结构"}},[a._v("#")]),a._v(" 页的内部结构")]),a._v(" "),t("p",[a._v("数据页，系统页，Undo页，事务数据页  16KB")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712892288159-215e2cbc-7b1d-4a80-b5e6-0ed01675be7b.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712892300123-3d0c9264-60ba-49b2-980e-3227a9f730fd.png",alt:""}})]),a._v(" "),t("h4",{attrs:{id:"file-header"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#file-header"}},[a._v("#")]),a._v(" File Header")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712892596286-08edcb38-5db4-4f46-b6fa-415c9d425329.png",alt:""}})]),a._v(" "),t("p",[a._v("FIL_PAGE_TYPE")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712892686820-13f2c56a-c39b-4ab1-9095-940fa83c6fca.png",alt:""}})]),a._v(" "),t("p",[a._v("校验和")]),a._v(" "),t("p",[a._v("比较两个页相等，根据算法算出来一个较短的值，节省比较的时间")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712898063431-6331d545-3dad-46df-82f0-ebac5812d71b.png",alt:""}})]),a._v(" "),t("p",[a._v("头部和尾部不相等，回滚或继续写入")]),a._v(" "),t("p",[a._v("FIL_PAGE_LSN")]),a._v(" "),t("p",[a._v("页面被最后修改时的日志位置")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712898538263-f9453c33-9909-48e3-a1eb-7d96e91b0ee4.png",alt:""}})]),a._v(" "),t("h4",{attrs:{id:"空闲空间"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#空闲空间"}},[a._v("#")]),a._v(" 空闲空间")]),a._v(" "),t("p",[a._v("剩下空间，越来越小")]),a._v(" "),t("h4",{attrs:{id:"用户记录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用户记录"}},[a._v("#")]),a._v(" 用户记录")]),a._v(" "),t("p",[a._v("指定行格式，形成单链表   数据如何记录   记录头信息")]),a._v(" "),t("p",[a._v("记录头信息")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712901002238-3a598ac2-078a-4861-a3a2-dd5c92fa93c8.png",alt:""}})]),a._v(" "),t("p",[a._v("delete_mask   0 没删除   1 删除   重新排序消耗性能   垃圾链表 可重用空间  删除新增时会重用")]),a._v(" "),t("p",[a._v("min_rec_mask 非叶子节点最小记录  标记为1   自己插入的都是0")]),a._v(" "),t("p",[a._v("record_type 记录类型")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712901982762-d1515ace-36ac-4889-a6c4-460fa5e6ef60.png",alt:""}})]),a._v(" "),t("p",[a._v("heap_no  当前记录在本页中的位置")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712902045479-7ba8ee73-b171-4dd5-adf9-d01e15abd4e1.png",alt:""}})]),a._v(" "),t("p",[a._v("n_owned   页目录每个组，存储了多少记录")]),a._v(" "),t("p",[a._v("next_record 地址偏移量  最小记录指向了第一条记录   最大记录是 0")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712902777355-846a7b1d-cfb8-4d93-a045-f4430a3ce4e9.png",alt:""}})]),a._v(" "),t("h4",{attrs:{id:"最小和最大记录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#最小和最大记录"}},[a._v("#")]),a._v(" 最小和最大记录")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1712902291793-7a49d8c2-74a4-450a-b482-fd55e274e521.png",alt:""}})]),a._v(" "),t("h4",{attrs:{id:"page-directory-页目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#page-directory-页目录"}},[a._v("#")]),a._v(" Page Directory 页目录")]),a._v(" "),t("p",[a._v("分成几个组，包括最小和最大，不包括已删除")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713021946676-dc45089f-0424-4ee7-8725-7ce7e85e3be2.png",alt:""}})]),a._v(" "),t("p",[a._v("页目录用来存储每组最后一条记录的地址偏移量")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713022140857-ca765e1f-28b7-481d-b498-91c02fe2a4ca.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713022381161-ed0ee310-cf89-4f1b-8a78-2cf5c2571721.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713022521477-281a320c-58f7-42f5-8638-946eb02b9cb0.png",alt:""}})]),a._v(" "),t("h4",{attrs:{id:"页面头部"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#页面头部"}},[a._v("#")]),a._v(" 页面头部")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713022578170-f329922a-134d-4694-a6ed-46c0b856e8fa.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713022857753-0ae083ac-1463-46d4-846f-5e8e0b170e89.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713022919680-d9c6ddf1-ff3b-4f33-82e1-7734b16b3964.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713023095282-4e073abe-235a-4bda-94ef-3a42aba97a58.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"innodb行格式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#innodb行格式"}},[a._v("#")]),a._v(" Innodb行格式")]),a._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("SELECT")]),a._v(" @"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@innodb_default_row_format")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" # dynatic\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713023310866-a9c321ea-db31-4262-ada3-63ad8830e812.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713023395198-d0e318b4-eddd-44e9-adc1-dae7df89c08b.png",alt:""}})]),a._v(" "),t("h4",{attrs:{id:"变长字段长度列表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#变长字段长度列表"}},[a._v("#")]),a._v(" 变长字段长度列表")]),a._v(" "),t("p",[a._v("存储到底存了多大的数据，顺序反过来")]),a._v(" "),t("h4",{attrs:{id:"null值列表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#null值列表"}},[a._v("#")]),a._v(" NULL值列表")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713023698184-650a2c8a-475b-439f-8398-cdfe1360a884.png",alt:""}})]),a._v(" "),t("p",[a._v("不考虑非空和主键")]),a._v(" "),t("h4",{attrs:{id:"记录的真实数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#记录的真实数据"}},[a._v("#")]),a._v(" 记录的真实数据")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713023784535-8b3b4ecb-0192-451a-9d43-8ebe2c432fea.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713023863143-3104348c-dd48-46a9-ae8a-7e32c8268811.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713024432152-a893a360-df14-4f29-808b-5d52b5812446.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713024648344-96c97ce7-51a9-40c9-a394-c0437ae969ef.png",alt:""}})]),a._v(" "),t("h4",{attrs:{id:"dynamic和compressed行格式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dynamic和compressed行格式"}},[a._v("#")]),a._v(" Dynamic和Compressed行格式")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713024956466-9128bfa1-073a-4626-8a76-5bf1e8bf6172.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713024985883-36c1c626-914e-4771-be28-99e0dd4e8dff.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713025012366-ce282c23-f860-4fbe-8483-e5ab9bb7fb28.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713025104814-4cdf8d47-0834-4cc1-9423-e20f270394e6.png",alt:""}})]),a._v(" "),t("h4",{attrs:{id:"redundant行格式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#redundant行格式"}},[a._v("#")]),a._v(" Redundant行格式")]),a._v(" "),t("p",[a._v("字段长度偏移列表")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713025324067-06987f2f-c602-4106-a7e5-ee69fcdebaff.png",alt:""}})]),a._v(" "),t("p",[a._v("记录头信息")]),a._v(" "),t("p",[a._v("不一样")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713025415676-a98be097-e696-4b59-b8ff-6b13e37cfb9f.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"区-段-碎片区"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#区-段-碎片区"}},[a._v("#")]),a._v(" 区,段,碎片区")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713025642304-1c211333-75ee-49df-ab28-cd0b67880f25.png",alt:""}})]),a._v(" "),t("p",[a._v("保证一段是顺序存储，不是所有")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713025961211-23513ac3-0eba-4a5d-a8d9-d96586976a02.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713026045616-2594b2c8-9297-4fb5-93eb-7b02d12133a7.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713026465587-d0435af8-49c0-48a3-8878-ca74f6c9b73a.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713026964272-87b4f39c-2dc6-4d31-9d8b-7509dbc98655.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713027136928-8832ea5a-2e30-432f-8f60-a3385244376a.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713027193358-cf812c7c-51e9-4640-aab6-0361f5aa7153.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713027246938-46629c60-bec9-4730-998c-6903cfac7129.png",alt:""}})]),a._v(" "),t("p",[a._v("5.7 默认6个页 idb  96k")]),a._v(" "),t("p",[a._v("8.0 不是 有表结构 多了一个页")]),a._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[a._v("show variables like 'innodb_file_oer_table'"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713027522539-f1a2f31f-3e83-4f1a-8604-67e91f538059.png",alt:""}})]),a._v(" "),t("p",[a._v("内部系统表  数据字段")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713027592858-1497aa82-62fa-4f1d-aea4-54ee191064e6.png",alt:""}})]),a._v(" "),t("p",[a._v("不能访问，information_schema 提供查看接口")]),a._v(" "),t("h2",{attrs:{id:"索引-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#索引-2"}},[a._v("#")]),a._v(" 索引")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713080337844-7393ef20-31e2-47d2-b8f4-3b74ac661be2.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713080764809-fa9836f5-85e8-4822-9a07-b5fe1a1816d6.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713080831178-54c7f585-45d1-4963-b615-115670975313.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713080912419-eedf87ab-6807-4573-a634-5fcf14925cba.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713080987776-70b419b6-3afc-4b90-94a2-c64f258e7e6a.png",alt:""}})]),a._v(" "),t("p",[t("font",{staticStyle:{color:"rgb(25, 27, 31)"}},[a._v("nnoDB 中的哈希索引其实也就是")]),t("font",{staticStyle:{color:"rgb(25, 27, 31)"}}),t("font",{staticStyle:{color:"rgb(25, 27, 31)","background-color":"rgb(248, 248, 250)"}},[a._v("自适应哈希索引（Adaptive Hash Index）")])],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"rgb(25, 27, 31)"}},[a._v("InnoDB 会自动检测某些索引值是否使用的非常频繁")])],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"rgb(25, 27, 31)"}},[a._v("通过自动创建 ")]),t("font",{staticStyle:{color:"rgb(25, 27, 31)","background-color":"rgb(248, 248, 250)"}},[a._v("自适应哈希索引")]),t("font",{staticStyle:{color:"rgb(25, 27, 31)"}},[a._v(" 来提高查对热点数据的访问速度，特别是在频繁执行等值查询的情况下")])],1),a._v(" "),t("h3",{attrs:{id:"创建索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建索引"}},[a._v("#")]),a._v(" "),t("font",{staticStyle:{color:"rgb(25, 27, 31)"}},[a._v("创建索引")])],1),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713081608652-50c1bc4e-f5fd-4961-bbd4-62cf25c9c835.png",alt:""}})]),a._v(" "),t("p",[a._v("普通索引")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713081648378-c1da40e3-3656-4685-8c31-356961e61faf.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713082269670-08f22513-039a-4e64-841c-399f2dca3fe1.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713082914950-4941904c-1586-4a62-92c8-eca3a78eab8e.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713083289400-3e1ab981-c257-41bb-96d6-85865195e749.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713083564313-a9847421-f0c2-411b-99a9-f70e4fe4c2dc.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713083652814-8e34cefc-da6e-4b06-9204-cf300f9fb30e.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713083706008-3637c1d4-2f57-4dbc-8abd-da5664ae72c0.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713083927915-dad70ea6-8120-4cb3-a57b-7754bec82c21.png",alt:""}})]),a._v(" "),t("p",[a._v("最左前缀原则")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713084152490-85e3f919-729a-490d-a9f0-681aa287a039.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713084230339-f424d9bb-ba79-4102-a2cf-7d8d0478574f.png",alt:""}})]),a._v(" "),t("p",[a._v("不精准，速度快")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713084299618-cca88484-8719-4b84-99f5-576345fd5f4c.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713084510360-b7050fad-fc9f-4d3b-808c-b6e9a1ced002.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713084573167-64af4fd1-b97f-4dec-8e3c-3d5f660482fa.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"删除索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除索引"}},[a._v("#")]),a._v(" 删除索引")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713084688999-7f100189-229d-4f9f-8261-7c055302b6d4.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713084741702-90d8a053-5088-4183-9e16-3612ec8fd17e.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713084800212-f997e738-7545-4894-8b49-15574cd3030e.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713084916424-166fa54b-71fd-45cb-9a08-483cce4717f2.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"降序索引-8-0"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#降序索引-8-0"}},[a._v("#")]),a._v(" 降序索引（8.0）")]),a._v(" "),t("p",[a._v("支持降序排列")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713085118600-114c1fd2-9c88-4927-90eb-35b7292f85be.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713085275681-232d08d1-f2b3-4000-9fb2-f1057f773bd2.png",alt:""}}),a._v("  这样就不推荐了 799了 正常就是5")]),a._v(" "),t("h3",{attrs:{id:"隐藏索引-8-0"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#隐藏索引-8-0"}},[a._v("#")]),a._v(" 隐藏索引（8.0）")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713085377460-3a62a941-b467-4183-a6b9-3f4e3d560929.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713085570551-0d37bb4d-0579-40e9-84ad-fb3078ac5b8d.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713085659870-29836f2e-c2a5-4144-9ad8-7068cf0b7126.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713085686185-d167da1c-3206-4f16-a60a-9caed95b1cc7.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713085786891-380f2326-1852-4fa6-b1ec-faf7a2f46094.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713085986309-edbb4124-0812-4a41-bd89-3d6ef8e0e1d9.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713085973724-227c9d08-7886-4032-9387-b9e9d830db75.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"索引的设计原则"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#索引的设计原则"}},[a._v("#")]),a._v(" 索引的设计原则")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713086473328-7b7a5d09-d7b2-4d06-9ad6-8fb2ffadcc87.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713086772969-6f48e497-defd-4ebd-95eb-a273ed633746.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713086781085-395d0b5f-0f6d-4b32-af5b-515423d2e066.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"适合创建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#适合创建"}},[a._v("#")]),a._v(" 适合创建")]),a._v(" "),t("ol",[t("li",[a._v("字段的数值有唯一性限制")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713087010874-6d822fcd-0d53-4c3e-8836-284e15def377.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[a._v("频繁作为WHERE 查询条件的字段")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713087150749-f59603e4-5113-4c96-b094-bf3e7ac3f348.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[a._v("经常group by 和 order by 的字段")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713087323239-3b0b44ae-de10-4945-a2b8-69c0811fa2d7.png",alt:""}})]),a._v(" "),t("p",[t("font",{staticStyle:{color:"rgba(0, 0, 0, 0.75)"}},[a._v("group by或者order by后面的字段添加索引，由于索引是排好序的，所以建立索引就等同于在查询之前已经是排好序了")])],1),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713088096425-97c8ae6a-3e19-4e02-879e-458d14791a48.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[a._v("UPDATE、DELETE的WHERE 条件列")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713088510082-c93bb764-8610-4ddb-83dc-fcc0d08057d2.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713090005969-e8682cb2-0dd3-4553-8b9a-25d2f7c94d6d.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"5"}},[t("li",[a._v("DISTINCT字段需要创建索引")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713111145188-ff44c3d1-c1d6-4468-b62c-8bbd62eb9797.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"6"}},[t("li",[a._v("连接表的数量尽量不要超过三张，对where 条件创建索引，对用于连接的字段创建索引，类型必须一致")]),a._v(" "),t("li",[a._v("使用列的类型小的，创建索引")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713111892610-bc1231fb-119f-4c1e-8de2-c39c078516fc.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"8"}},[t("li",[a._v("使用字符串前缀创建索引")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713112154533-03e90ada-26ad-493a-8781-9ffc2f372e32.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713112258569-4211f0e8-e49a-47f7-8afb-3e29677219ba.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713112437587-567a1c41-7463-46f1-9077-90d9061cc3d4.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"9"}},[t("li",[a._v("区分度高(散列性高)的列适合作为索引")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713112511442-2dbe5db4-f155-4728-b807-a597ec6fcf4c.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"10"}},[t("li",[a._v("使用最频繁的列放到联合索引的左侧")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713112925637-24b13e2d-6913-4c16-b7ef-b2501ace7115.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"11"}},[t("li",[a._v("在多个字段都要创建索引的情况下，联合索引优于单值索引")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713113006687-f34c247e-aa26-44d2-b73a-fb726ea358b2.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"不适合创建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#不适合创建"}},[a._v("#")]),a._v(" 不适合创建")]),a._v(" "),t("ol",[t("li",[a._v("where中使用不到的字段，不要设置索引")]),a._v(" "),t("li",[a._v("数据量小的表最好不要使用索引")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713113260041-03db4e3f-9113-4782-afc7-51d473b084ad.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[a._v("有大量重复数据的列上不要建立索引")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713113308238-c9c277b7-7489-4cd6-b704-a10b8bad3f32.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713113391223-8662e08d-e933-4d3a-97aa-6a163d96fe7f.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[a._v("避免对经常更新的表创建过多的索引")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713113494115-eb561d24-bd60-464b-a3d0-13449b4e01f4.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"5"}},[t("li",[a._v("不建议无序的值作为索引")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713113636515-81194c2b-e369-4411-b2f7-938a578da751.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"6"}},[t("li",[a._v("删除不再使用或者很少使用的索引")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713113704008-c85ac976-a347-4c5f-aee2-c11b8bf1ab28.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"7"}},[t("li",[a._v("不要定义冗余或者重复的索引")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713113824027-d9e620db-1262-4650-aab4-07b026ff90c3.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"性能分析工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#性能分析工具"}},[a._v("#")]),a._v(" 性能分析工具")]),a._v(" "),t("p",[a._v("响应时间更快，吞吐量更大 explain 和 show profiling")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713150547631-ff4af028-a347-43c5-9034-876be552c25a.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713150644143-789b5590-60c4-4796-b6c0-30708d62e430.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713150676714-0bfe1b53-89b8-4af9-b362-ee061409c8e9.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713150754163-34a632bf-a049-4475-9b92-f55b35a03d5b.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"查看系统参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看系统参数"}},[a._v("#")]),a._v(" 查看系统参数")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713150835505-d74bd258-9167-482c-9b03-9f175aefb24b.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"统计sql查询的成本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#统计sql查询的成本"}},[a._v("#")]),a._v(" 统计sql查询的成本")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713151209091-b8bb1d71-c066-4e37-8371-4e94405cb67e.png",alt:""}})]),a._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[a._v("show status like 'last_query_cost'"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("1 就是一个数据页")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713151530002-666a1305-ad10-4a66-a765-734a669b4762.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"定位执行慢的sql-慢查询日志"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#定位执行慢的sql-慢查询日志"}},[a._v("#")]),a._v(" 定位执行慢的SQL：慢查询日志")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713171796928-b28fac34-046c-4fe8-bde2-7e3c547402e2.png",alt:""}})]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("show variables like "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%slow_query_log%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("// 查看是否开启慢查询\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" global slow_query_log "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" ON"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nshow variables like "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%long_query_time%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("// 查看慢查询的时间阈值\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" global "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("long_query_time")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("// 新建会话生效\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" session "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("long_query_time")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("// 当前会话生效\nshow global status like "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%slow_queries%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("// 查看有多少\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713172299762-450c9f76-a251-47e4-add1-27c0d7b8d670.png",alt:""}}),a._v("文件配置写法")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713198538732-c4e8c105-efb9-4231-ba5c-a8b6c52d2df7.png",alt:""}})]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("mysqldumpslow "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-help")]),a._v("\nmysqldumpslow "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" t "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v(" 文件位置/文件\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" 不模糊参数\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" t 根据时间排序\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v(" top5\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713198805624-9ff73047-e786-4ec8-b6b6-3fce11e109e9.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713199125720-ec8dea9e-f798-448f-9c63-9a1dad6a973a.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"show-profile-查看sql执行成本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#show-profile-查看sql执行成本"}},[a._v("#")]),a._v(" SHOW PROFILE  查看SQL执行成本")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("profiling")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" ON"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nshow variables like "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'profiling'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nshow profiles"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nshow profile cpu,block io "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" query "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713199570778-419ff37b-c7c2-439f-b6a7-9da35542aa8a.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"explain-分析查询语句"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#explain-分析查询语句"}},[a._v("#")]),a._v(" EXPLAIN 分析查询语句")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713200007325-112522ec-b1ef-4965-a4fb-7b4ad821786f.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713276012212-7ee36b09-dfd0-40f7-9bfb-d0385d365914.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713276034116-82c0c035-d1c1-4502-9ef1-0ea2f4f48fc3.png",alt:""}})]),a._v(" "),t("p",[a._v("查询优化器可能对涉及的子查询的语句进行重新，转变为多表查询的操作")]),a._v(" "),t("p",[a._v("union 有临时表     union all 没有")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713277138641-2c3dec0b-6cbd-4bb3-901b-30cb813d6355.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713277837377-a03cb934-16e4-46ec-8b8b-de4d3e507401.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713278130200-7f28f042-042a-4f6a-9998-e1329dd64c05.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713365973115-2c38ff36-687f-4ee4-b1c6-331c97874111.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713366689388-964cacee-9d6a-4e9b-8819-b4d27a8b532c.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713367231177-0083e406-1469-4c5c-9947-85464eb7ad7c.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713428592387-1c5acf69-23b1-4428-be34-5d404ad78831.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713428639917-c5e501b8-f973-4db4-871e-08ed334e850e.png",alt:""}})]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("show warnings // 优化器优化后的结果\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713452069975-60947ed1-aa4b-4b91-9f96-6c67056e30b4.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713452153373-fca8cd22-5a94-42ae-a31c-315b49922a38.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713452320637-18422d9c-3b9b-455f-a734-610f0205b01c.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713452401045-ff643ea2-5411-442b-84e1-96844e108712.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713452437370-66f27b65-37f8-48db-93f4-510a921604d0.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713452490133-d3bdd585-0e07-4497-bc08-bee8a44a4f9d.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713452525512-3940b428-6d05-40e6-9e0b-c26360fe4d28.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713452566578-f9b791d2-bc6f-460e-b329-625b2dbe9dc6.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713452591908-12bcc743-eb75-41da-b135-7b04b0747aca.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"索引优化与查询优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#索引优化与查询优化"}},[a._v("#")]),a._v(" 索引优化与查询优化")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713452675381-e8939b92-9970-43f4-9f5a-8ec6af31392d.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713453900949-7f8ba726-4a34-43e8-9a71-40b652a29ff7.png",alt:""}})]),a._v(" "),t("ol",[t("li",[a._v("全值匹配我最爱")]),a._v(" "),t("li",[a._v("最佳左前缀法则")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713454924378-e3780ce1-1515-4ed4-95e2-0a02760eefca.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[a._v("主键插入顺序")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713454981176-ca3e8068-ebfc-4070-885f-0d197d8e0894.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[a._v("计算、函数、类型转换导致索引失效")]),a._v(" "),t("li",[a._v("类型转换导致索引失效")]),a._v(" "),t("li",[a._v("范围条件右边的列导致索引失效")]),a._v(" "),t("li",[a._v("不等于索引失效")]),a._v(" "),t("li",[a._v("is null 可以使用索引，in not null 不可以")]),a._v(" "),t("li",[a._v("like 以 %开头失效")]),a._v(" "),t("li",[a._v("or前后出现非索引列")]),a._v(" "),t("li",[a._v("数据库的字符要统一使用utf8mb4")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713797924349-36c9aabe-5a58-4e3c-bbc3-844eb1f400dc.png",alt:""}})]),a._v(" "),t("p",[a._v("内连接是可以决定谁作为驱动表，谁作为被驱动表出现的")]),a._v(" "),t("p",[a._v("被驱动表有索引，成本低")]),a._v(" "),t("p",[a._v("小表驱动大表")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713889997076-5549b7c2-1a93-47d4-8081-34011bc18e50.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713890108492-26976bdc-114e-45e1-a60f-0d492a607c85.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713890418242-92f84360-48c4-440d-a4ba-c76040f3d8a9.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1713890741306-b50b13c4-cdcf-4103-8b94-ef7c720b6f77.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1714009823064-a928a5b3-2f24-42f6-afc9-9b37eb210182.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1714015286398-dad56407-1929-4ed5-8242-98ba5085ac43.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1714015963206-1d27015b-87bd-4ba5-a77a-930c9298fb89.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1714024109740-7f53ff44-6bde-4082-b105-10ecefc01a78.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1714024164207-9fcd3403-9601-497b-984c-857de246f67f.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1714024213782-112a09b4-ee02-4b45-98bf-ee2639c67144.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1714024347762-7e6ca12d-9064-4f09-9ef0-a84d78700b1d.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1714035301144-72e9c3a4-c34a-4eaf-ad32-8bf43b90d0cc.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1714035479684-ca2d6360-c38a-4274-8db9-2c5c8458a9df.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"覆盖索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#覆盖索引"}},[a._v("#")]),a._v(" 覆盖索引")]),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("一个索引包含了满足查询结果的数据")]),a._v("就叫做覆盖索引。")],1),a._v(" "),t("p",[a._v("索引列+主键  =  SELECT 到 FROM 的查询列")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1715070730550-fdffdebb-41e3-4388-9ea8-216278167206.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1715070752479-a9e2951b-c716-4269-9b73-242b7550e982.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"索引下推"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#索引下推"}},[a._v("#")]),a._v(" 索引下推")]),a._v(" "),t("p",[a._v("减少了回表的次数，针对于联合索引，过滤完再回表，有字段 ICP")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1715072847346-f22a36a8-a321-43cf-ac3a-904ee1b7fad9.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1715073018862-5cd8a246-695f-4e7e-8334-9d5047486259.png",alt:""}}),a._v("    不使用索引下推")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1715073146156-88c9b428-bab3-48c4-9a26-41a0cb9c947a.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"补充优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#补充优化"}},[a._v("#")]),a._v(" 补充优化")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1715073376718-4bd11760-2b1c-4fbf-b7b2-214c0c063678.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1715073703535-f05a0649-9ce0-4f97-bb56-7e6827d0a575.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1715073753228-78c013d1-7265-4eb7-8739-d1c0168e087c.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1715073856250-83b98d17-db83-4a1b-81e2-644c200f695f.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1715073874358-eb838bc4-56b4-4156-b4ff-f98ca40d507a.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"数据库设计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据库设计"}},[a._v("#")]),a._v(" 数据库设计")]),a._v(" "),t("h2",{attrs:{id:"主键设计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#主键设计"}},[a._v("#")]),a._v(" 主键设计")]),a._v(" "),t("ol",[t("li",[a._v("自增id")])]),a._v(" "),t("ul",[t("li",[a._v("可靠性不高  自增回溯问题")]),a._v(" "),t("li",[a._v("安全性不高   可以猜测用户数量")]),a._v(" "),t("li",[a._v("性能差 服务器端生成")]),a._v(" "),t("li",[a._v("交互多    last_insert_id()   多一次交互")]),a._v(" "),t("li",[a._v("局部唯一")])]),a._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[a._v("业务主键")])]),a._v(" "),t("p",[a._v("推荐 全局唯一，单调递增。")]),a._v(" "),t("p",[a._v("UUID  在8.0 推荐  因为可以时间的高低换位")]),a._v(" "),t("p",[a._v("淘宝订单号    时间+ 去重字段 + 用户id 后几位")]),a._v(" "),t("h2",{attrs:{id:"数据库设计-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据库设计-2"}},[a._v("#")]),a._v(" 数据库设计")]),a._v(" "),t("ol",[t("li",[a._v("节省数据的存储空间")]),a._v(" "),t("li",[a._v("能够保证数据的完整性")]),a._v(" "),t("li",[a._v("方便进行数据库应用系统的开发")])]),a._v(" "),t("p",[a._v("冗余度较小、结构合理")]),a._v(" "),t("h2",{attrs:{id:"范式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#范式"}},[a._v("#")]),a._v(" 范式")]),a._v(" "),t("p",[a._v("数据库设计的基本原则")]),a._v(" "),t("p",[a._v("阶数越高冗余度")]),a._v(" "),t("p",[a._v("一般也就巴斯-科德范式")]),a._v(" "),t("h3",{attrs:{id:"第一范式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第一范式"}},[a._v("#")]),a._v(" 第一范式")]),a._v(" "),t("p",[a._v("原子性，字段值不可再次拆分，主观性的")]),a._v(" "),t("h3",{attrs:{id:"第二范式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第二范式"}},[a._v("#")]),a._v(" 第二范式")]),a._v(" "),t("p",[a._v("满足数据表里面得有主键，非主键字段完全依赖于主键，不能只依赖于主键的一部分，一张表只表达一个意思。")]),a._v(" "),t("h3",{attrs:{id:"第三范式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第三范式"}},[a._v("#")]),a._v(" 第三范式")]),a._v(" "),t("p",[a._v("非主键字段不能依赖于其他非主键字段。  他们之间必须相互独立。直接相关，消除冗余。")]),a._v(" "),t("p",[a._v("范式  表关联多了，降低了查询效率。冗余可以反范式化。")]),a._v(" "),t("h3",{attrs:{id:"反范式化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#反范式化"}},[a._v("#")]),a._v(" 反范式化")]),a._v(" "),t("p",[a._v("业务优先，增加冗余字段。")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1716370554380-f3e18ebf-4063-4ae8-aab0-afbd7f977949.png",alt:""}})]),a._v(" "),t("p",[a._v("浪费空间，修改部门，全部的冗余字段也要修改。要不然会数据不一致。而且存储过程去更新会消耗，系统资源。并且数据量小，会使得数据库设计变复杂。")]),a._v(" "),t("ol",[t("li",[a._v("不需要经常更改的字段")]),a._v(" "),t("li",[a._v("查询的时候不可或缺")])]),a._v(" "),t("p",[a._v("历史快照，订单收货信息。")]),a._v(" "),t("p",[a._v("数据库设计的目的是捕获数据，数据仓库是分析数据。 数据仓库因为是历史数据，可以考虑反范式化。")]),a._v(" "),t("h3",{attrs:{id:"巴斯-科德范式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#巴斯-科德范式"}},[a._v("#")]),a._v(" 巴斯-科德范式")]),a._v(" "),t("p",[a._v("只有一个候选键，或者每个候选键都是单属性。不存在部分依赖")]),a._v(" "),t("p",[a._v("仓库名，管理员，物品名，数量  这个就不是BCNF")]),a._v(" "),t("p",[a._v("主键和候选建有依赖关系不行")]),a._v(" "),t("p",[a._v("学生、导师、学科、CPA")]),a._v(" "),t("h3",{attrs:{id:"第四范式-很少了"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第四范式-很少了"}},[a._v("#")]),a._v(" 第四范式（很少了）")]),a._v(" "),t("p",[a._v("平凡的多值依赖   整个表就是一组一对多的关系。")]),a._v(" "),t("h3",{attrs:{id:"第五范式-完美范式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第五范式-完美范式"}},[a._v("#")]),a._v(" 第五范式（完美范式）")]),a._v(" "),t("p",[a._v("消除不是由候选键所蕴含的连接依赖。理论中")]),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("技术服务于业务")])],1),a._v(" "),t("h3",{attrs:{id:"er模型三要素"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#er模型三要素"}},[a._v("#")]),a._v(" "),t("font",{staticStyle:{color:"#000000"}},[a._v("ER模型三要素")])],1),a._v(" "),t("p",[a._v("实体，属性，关系")]),a._v(" "),t("p",[a._v("可以独立存在的叫实体，不可再分的是属性。")]),a._v(" "),t("h3",{attrs:{id:"数据表的设计原则"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据表的设计原则"}},[a._v("#")]),a._v(" 数据表的设计原则")]),a._v(" "),t("ol",[t("li",[a._v("数据表的个数越少越好")]),a._v(" "),t("li",[a._v("数据表的字段个数越少越好")]),a._v(" "),t("li",[a._v("数据表中联合主键的字段个数越少越好")]),a._v(" "),t("li",[a._v("主键和外键越多越好")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1716448751979-7cab9df4-d307-4d2b-acd3-d4036bac34c6.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1716448847016-65bd766c-57da-4d3a-94a6-e8ee278ec7dc.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1716452501868-0247e487-5670-4837-837a-fb93c3b3fcc3.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1716453170806-d98f9213-fc6d-4d81-a187-ede24628fdf7.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1716453184529-bc87fe3f-2938-4bed-80ee-321151b01b35.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"结构设计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#结构设计"}},[a._v("#")]),a._v(" 结构设计")]),a._v(" "),t("ol",[t("li",[a._v("冷热数据分离，减少磁盘IO，增加热数据内存缓存的命中率，更有效的利用缓存，避免读入无用的冷数据。")]),a._v(" "),t("li",[a._v("增加中间表，经常联合表查询，增加查询效率。不是频繁更新。")]),a._v(" "),t("li",[a._v("增加冗余字段")]),a._v(" "),t("li",[a._v("优化数据类型，最小的数据类型。字段大，空间大，每一页索引存储的数量就少，IO次数也就越多。")]),a._v(" "),t("li",[a._v("LOAD DATA INFILE 比insert 导入快。")])]),a._v(" "),t("p",[a._v("分析表/检查表/优化表")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("ANALYZE TABLE 表名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" -- 更新表的分享，比如show index from 表名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("里面的区分度。\nCHECK TABLE 表名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" -- 查看表有没有问题，损毁。\nOPTIMIZE TABLE 表名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" -- 优化表 varchar blob text 优化\n")])])]),t("p",[a._v("mysqlcheck -o 数据库 表名 -uroot -p")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1716778824595-98433eff-b8fe-43cf-a7b5-0f41096252cb.png",alt:""}})]),a._v(" "),t("p",[a._v("服务器语句超时处理")]),a._v(" "),t("p",[a._v("创建全局通用表空间")]),a._v(" "),t("p",[a._v("8.0 隐藏索引进行调优  看查询参数。")]),a._v(" "),t("h2",{attrs:{id:"事务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#事务"}},[a._v("#")]),a._v(" 事务")]),a._v(" "),t("p",[a._v("InnoDB 支持事务")]),a._v(" "),t("p",[a._v("要么都成功，要么都失败")]),a._v(" "),t("p",[a._v("原子性 无中间状态")]),a._v(" "),t("p",[a._v("一致性 合法性 符合现实")]),a._v(" "),t("p",[a._v("隔离性 不能被其他事务干扰")]),a._v(" "),t("p",[a._v("持久性 事务一旦提交数据就是永久性的")]),a._v(" "),t("h2",{attrs:{id:"状态"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#状态"}},[a._v("#")]),a._v(" 状态")]),a._v(" "),t("ol",[t("li",[a._v("活动的")]),a._v(" "),t("li",[a._v("部分提交的")]),a._v(" "),t("li",[a._v("失败的")]),a._v(" "),t("li",[a._v("中止的")]),a._v(" "),t("li",[a._v("提交的")])]),a._v(" "),t("h2",{attrs:{id:"事务基础知识"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#事务基础知识"}},[a._v("#")]),a._v(" 事务基础知识")]),a._v(" "),t("ol",[t("li",[a._v("开启事务")]),a._v(" "),t("li",[a._v("一系列DML操作")]),a._v(" "),t("li",[a._v("事务结束的状态  提交commit / 中止 rollback")])]),a._v(" "),t("h3",{attrs:{id:"显式事务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#显式事务"}},[a._v("#")]),a._v(" 显式事务")]),a._v(" "),t("ol",[t("li",[a._v("开启事务 start transaction;  begin;")]),a._v(" "),t("li",[a._v("start transaction 后面 read only，read write（默认），with consistent snapshot")]),a._v(" "),t("li",[a._v("保存点 savepoint")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1716797235525-8a298b8d-2acb-437e-88d6-236fdec5873b.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"隐式事务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#隐式事务"}},[a._v("#")]),a._v(" 隐式事务")]),a._v(" "),t("ol",[t("li",[a._v("autocommit 自动提交 默认是ON")]),a._v(" "),t("li",[a._v("SET autocommit = OFF; 关闭自动提交    DDL无效")])]),a._v(" "),t("h2",{attrs:{id:"事务分类"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#事务分类"}},[a._v("#")]),a._v(" 事务分类")]),a._v(" "),t("ol",[t("li",[a._v("扁平事务")]),a._v(" "),t("li",[a._v("带有保存点的扁平事务")]),a._v(" "),t("li",[a._v("链事务   set @@completion_type= 1；")]),a._v(" "),t("li",[a._v("嵌套事务")]),a._v(" "),t("li",[a._v("分布式事务")])]),a._v(" "),t("h2",{attrs:{id:"事务的隔离性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#事务的隔离性"}},[a._v("#")]),a._v(" 事务的隔离性")]),a._v(" "),t("p",[a._v("脏写   事务A 修改了 事务B未提交的数据")]),a._v(" "),t("p",[a._v("脏读   事务A 读取了 事务B未提交的数据")]),a._v(" "),t("p",[a._v("不可重复读  事务A 读取了2次 数据不一样    少了可以算这里面")]),a._v(" "),t("p",[a._v("幻读  事务A  读取了2次 行数多了                删除不算")]),a._v(" "),t("ol",[t("li",[a._v("读未提交  最差  不怎么选")]),a._v(" "),t("li",[a._v("读已提交  解决了脏读  oracle 默认")]),a._v(" "),t("li",[a._v("可重复读")]),a._v(" "),t("li",[a._v("串行化")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1716948135749-832addf1-7600-4db3-a561-f4e5f579765b.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1716948927761-88af3092-3cac-429d-ae42-5d89d1ded1b9.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"mysql支持的隔离级别"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql支持的隔离级别"}},[a._v("#")]),a._v(" MySQL支持的隔离级别")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("show variables like "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'tx_isolation'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nshow variables like "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'transaction_isolation'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),a._v(" @@transaction_isolation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1716951624841-13396cc7-3bd2-4d4c-a267-489465054e23.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"事务日志"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#事务日志"}},[a._v("#")]),a._v(" 事务日志")]),a._v(" "),t("p",[a._v("重做日志 redo日志  保证持久性")]),a._v(" "),t("p",[a._v("回滚日志 undo日志  保证一致性")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1716965260748-e313592a-9df9-4baf-ba1a-bc71350a9de0.png",alt:""}})]),a._v(" "),t("p",[a._v("redo 日志 降低了刷盘频率")]),a._v(" "),t("p",[a._v("redo 日志 占用空间小")]),a._v(" "),t("p",[a._v("redo 日志 是顺序写入磁盘的。")]),a._v(" "),t("p",[a._v("redo 日志 在事务执行过程中，不断的写入  和 binlog 并不相同 binlog只有在事务提交才记录。")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1716991328593-8c1db232-602e-439a-9af4-c671714c61a3.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1716992803264-29c3297f-62a3-4af9-bd91-d9849e7071d7.png",alt:""}})]),a._v(" "),t("p",[a._v("时间花费从小到大 0 < 2 < 1")]),a._v(" "),t("p",[a._v("Innodb的更新操作采用的是 Write Ahead Log 预先日志持久化 先写日志，再写入磁盘，中间经过redo log buffer")]),a._v(" "),t("h2",{attrs:{id:"undo日志"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#undo日志"}},[a._v("#")]),a._v(" Undo日志")]),a._v(" "),t("p",[a._v("更新数据的前置操作，写入undo log  撤销日志  回滚日志")]),a._v(" "),t("ol",[t("li",[a._v("回滚数据    只是逻辑层面的，物理层面的不会改变，不会删除创建的数据页")]),a._v(" "),t("li",[a._v("MVCC 多版本并发控制")])]),a._v(" "),t("p",[a._v("回滚段，一个回滚段1024个 undo log  segment")]),a._v(" "),t("p",[a._v("insert undo log 直接删除")]),a._v(" "),t("p",[a._v("update undo log 不能直接删除，undo log 链表中，等待清除线程删除")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1717123506533-8858157c-d878-46d9-8da3-4c5bfca771a2.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1717125623698-bacb57e4-e515-4b03-b77b-17ec3856fd9e.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"锁"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#锁"}},[a._v("#")]),a._v(" 锁")]),a._v(" "),t("p",[a._v("保证事务的隔离性，保证数据的一致性和完整性。")]),a._v(" "),t("p",[a._v("相同记录")]),a._v(" "),t("p",[a._v("锁结构 和事务相关   排队")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1717142227691-5dc08e87-22f3-4ae3-9464-bad0808606ea.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1717144552948-7ae4adec-b5e6-46fb-b103-aad5751d7c92.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1717506309180-1dd28844-8c14-4f5a-b21a-736ad5870a05.png",alt:""}})]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("lock tables 表名 "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("write")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" // 写锁\nlock tables 表名 "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("read")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" // 读锁\nunlock tables"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" // 解锁\nshow "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("open")]),a._v(" tables where in_use "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("// 查看锁\n")])])]),t("ul",[t("li",[a._v("意向锁 行级锁和表级锁 共存")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1717507157955-22c985db-da43-4308-8964-a006280f56b0.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1717507198894-4da8f6c3-5381-42e7-84a0-f3b29835e30a.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1717508223951-8fa7c411-39fb-46a8-9b2e-58a7b72833b5.png",alt:""}})]),a._v(" "),t("p",[a._v("意向锁 排外不排内  相当于表级阻塞  给整个表加了一个标识")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1717508483827-ee17bd11-6c6f-4d31-a9a7-e5a2d6a52722.png",alt:""}})]),a._v(" "),t("p",[a._v("自增锁  表级锁")]),a._v(" "),t("ol",[t("li",[a._v("单行添加")]),a._v(" "),t("li",[a._v("批量添加")]),a._v(" "),t("li",[a._v("混合添加")])]),a._v(" "),t("p",[a._v("对应三种模式  innodb_auto_lock_mode 0 1 2")]),a._v(" "),t("p",[a._v("元数据锁")]),a._v(" "),t("ol",[t("li",[a._v("表结构变更")]),a._v(" "),t("li",[a._v("crud MDL 读锁   变更操作 MDL 写锁")])]),a._v(" "),t("h2",{attrs:{id:"记录锁-行锁"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#记录锁-行锁"}},[a._v("#")]),a._v(" 记录锁（行锁）")]),a._v(" "),t("h2",{attrs:{id:"间隙锁-gap锁"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#间隙锁-gap锁"}},[a._v("#")]),a._v(" 间隙锁  gap锁")]),a._v(" "),t("ol",[t("li",[a._v("防止幻影记录，取区间加锁，在两个数值之间。  大于最大的值，到正无穷")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),a._v(" * from performance.schema.data_locks"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("聚簇索引 有个无穷小和无穷大 指向前面和最后的数据   有可能出现死锁。")]),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("临建锁")]),a._v(" 结合了记录锁和间隙锁   Innodb默认是临建锁")],1),a._v(" "),t("p",[t("font",{staticStyle:{color:"#DF2A3F"}},[a._v("插入意向锁 ")]),t("font",{staticStyle:{color:"#000000"}},[a._v("Innodb规定事务在等待的时候也需要在内存中生成一个锁结构。并不阻止别的事务继续获取该记录上任何类型的锁。")])],1),a._v(" "),t("h2",{attrs:{id:"页锁"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#页锁"}},[a._v("#")]),a._v(" 页锁")]),a._v(" "),t("p",[a._v("介于表锁和行锁之间，也会出现表锁和锁升级。")]),a._v(" "),t("h2",{attrs:{id:"悲观锁"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#悲观锁"}},[a._v("#")]),a._v(" 悲观锁")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1718035110010-0709fe9d-e512-4beb-9d92-4d822dd1a716.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"乐观锁"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#乐观锁"}},[a._v("#")]),a._v(" 乐观锁")]),a._v(" "),t("p",[a._v("版本号或者时间戳")]),a._v(" "),t("p",[a._v("读写分离 强制读取主机")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1718036269042-6b0afa56-7bff-4b81-a229-7608d92a5257.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1718036292871-abc06eff-b73b-46ef-945b-38f72c54955e.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"显式锁-隐式锁"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#显式锁-隐式锁"}},[a._v("#")]),a._v(" 显式锁/隐式锁")]),a._v(" "),t("p",[a._v("插入一条数据，保护这条数据叫隐式锁。")]),a._v(" "),t("p",[a._v("事务2看事务1是否是活跃状态，如果是的话，帮助事务1构建一个锁结构。自己阻塞一下。")]),a._v(" "),t("p",[a._v("非聚簇索引 page headers 里面有个最大事务id，这个id和事务二比较，小的话就全部都提交了")]),a._v(" "),t("p",[a._v("延迟加锁   隐式锁转成显式锁")]),a._v(" "),t("h2",{attrs:{id:"全局锁"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#全局锁"}},[a._v("#")]),a._v(" 全局锁")]),a._v(" "),t("p",[a._v("整个数据库实例加锁，当你需要让整个库处于只读，全库逻辑备份。")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("Flush tables with "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("read")]),a._v(" lock\n")])])]),t("h2",{attrs:{id:"死锁"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#死锁"}},[a._v("#")]),a._v(" 死锁")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1718124561030-7b788dd6-d18c-4f69-9fc6-bb61310f8c6e.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1718124869125-e7d7ad4d-51ca-4a84-a174-983778bde29c.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1718125095243-81e48d2f-49e9-4486-abbc-66b1689debb1.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1718125201838-85c36a3f-f7c6-43bc-ba46-574024d45652.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1718125276128-8c637e48-cd8a-401a-a920-b2a3d7881a73.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"锁的内存结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#锁的内存结构"}},[a._v("#")]),a._v(" 锁的内存结构")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1718125750686-bd2affb9-76b3-4b5b-b61f-75c72de0a88d.png",alt:""}})]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("show status like "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%innodb_row_lock%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1718126361752-8eb89fa4-ba4e-4cbf-8826-bc6de687cc0d.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1718126425921-14d789d6-9b7a-4979-91f9-381968d02a10.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"mvcc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mvcc"}},[a._v("#")]),a._v(" MVCC")]),a._v(" "),t("p",[a._v("多版本并发控制 依赖于隐藏字段、Undo log 和 Read View")]),a._v(" "),t("p",[a._v("一致性读 快照读  看见被事务更改之前的值")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1718172975149-5325701f-e270-4585-8e25-935c6bef36b3.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1719291385783-9924c1d1-0904-45fd-aec7-7a4b699bf6ed.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1719291467070-e335fff2-de0a-453d-bc31-eac8b4100733.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1719291707917-22b32b7c-9d38-4024-8f63-4219d3d45a74.png",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1719376350374-5666b669-078a-4195-8b96-61248debb492.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1719376368800-27ae4b61-b6fe-478d-8ee7-b7407104a44b.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1719376945525-e3b2f14b-3981-49f7-a21e-7286b5081348.png",alt:""}}),t("img",{attrs:{src:"",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1719377584525-ed6fc235-e174-40b9-a99f-17c00848e71d.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1719377632251-1b04e3b8-f2e0-4821-81b4-510975e910da.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"日志"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#日志"}},[a._v("#")]),a._v(" 日志")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/jpeg/33708367/1719817415009-cd50f7c9-2750-48c7-b16d-f4598f75b629.jpeg",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/jpeg/33708367/1719817422127-3dcf6131-5a35-4745-ad0c-502a687346ae.jpeg",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/jpeg/33708367/1719817437806-8563b8b6-679c-4d42-84d4-bdac1fc846d5.jpeg",alt:""}}),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1719898164013-f2e84656-4566-4387-853d-6a721f6d3db0.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1719898171373-1e8b66df-b3ec-4842-b0ef-94011cff8802.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1719898180173-b76f2b97-23fe-4a73-a649-6bfe4bb0745c.png",alt:""}})]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("flush logs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" // 重新生成binlog日志\n")])])]),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("mysqlbinlog "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/var/lib/mysql/binlog/atguigu-bin.000002"')]),a._v("\n")])])]),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("show variables like "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%log_bin%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1719930430344-387f321e-10f7-48ab-80e3-ffb320f73f1d.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1719930498781-d8c6b31a-672b-42e3-b6c4-df30bf447f91.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1719931369840-49f4b4ff-d141-4393-9608-af32c141a740.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/33708367/1719931442570-ea89df3c-5f3d-4fb4-a24a-cdb19690a840.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/jpeg/33708367/1721278612549-bdb2b680-5993-40f9-ac3f-51abdbf35072.jpeg",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/jpeg/33708367/1721278614424-f76b1b58-06bf-4340-8cd5-1c07dae1785a.jpeg",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/jpeg/33708367/1721278616045-2dc06414-908e-433b-b0c3-0a2a89425b87.jpeg",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/jpeg/33708367/1721278617717-117098e7-259b-499b-be14-cc370844f2a9.jpeg",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/jpeg/33708367/1721278619360-d1f61447-e2d8-4d39-b4b2-b48a1d833e0e.jpeg",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/jpeg/33708367/1721278621058-302402cd-57c7-45fc-ae0e-e8e019f6dc4e.jpeg",alt:""}})])])}),[],!1,null,null,null);t.default=e.exports}}]);